(()=>{var t,e,n,r,o,c={4785:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){return function t(e,n,r){var o,c,l=window,i="application/octet-stream",a=r||i,s=e,u=!n&&!r&&s,f=document.createElement("a"),d=function(t){return String(t)},h=l.Blob||l.MozBlob||l.WebKitBlob||d,p=n||"download";if(h=h.call?h.bind(l):Blob,"true"===String(this)&&(a=(s=[s,a])[0],s=s[1]),u&&u.length<2048&&(p=u.split("/").pop().split("?")[0],f.href=u,-1!==f.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(e){t(e.target.response,p,i)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(s)){if(!(s.length>2096103.424&&h!==d))return navigator.msSaveBlob?navigator.msSaveBlob(v(s),p):y(s);a=(s=v(s)).type||i}else if(/([\x80-\xff])/.test(s)){for(var g=0,$=new Uint8Array(s.length),b=$.length;g<b;++g)$[g]=s.charCodeAt(g);s=new h([$],{type:a})}function v(t){for(var e=t.split(/[:;,]/),n=e[1],r=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=r.length,c=0,l=new Uint8Array(o);c<o;++c)l[c]=r.charCodeAt(c);return new h([l],{type:n})}function y(t,e){if("download"in f)return f.href=t,f.setAttribute("download",p),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout((function(){f.click(),document.body.removeChild(f),!0===e&&setTimeout((function(){l.URL.revokeObjectURL(f.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,i)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,i)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=s instanceof h?s:new h([s],{type:a}),navigator.msSaveBlob)return navigator.msSaveBlob(o,p);if(l.URL)y(l.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===d)try{return y("data:"+a+";base64,"+l.btoa(o))}catch(t){return y("data:"+a+","+encodeURIComponent(o))}(c=new FileReader).onload=function(t){y(this.result)},c.readAsDataURL(o)}return!0}})?n.apply(e,[]):n)||(t.exports=r)}},l={};function i(t){var e=l[t];if(void 0!==e)return e.exports;var n=l[t]={id:t,loaded:!1,exports:{}};return c[t].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=c,t=[],i.O=(e,n,r,o)=>{if(!n){var c=1/0;for(u=0;u<t.length;u++){for(var[n,r,o]=t[u],l=!0,a=0;a<n.length;a++)(!1&o||c>=o)&&Object.keys(i.O).every((t=>i.O[t](n[a])))?n.splice(a--,1):(l=!1,o<c&&(c=o));if(l){t.splice(u--,1);var s=r();void 0!==s&&(e=s)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[n,r,o]},i.F={},i.E=t=>{Object.keys(i.F).map((e=>{i.F[e](t)}))},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var o=Object.create(null);i.r(o);var c={};e=e||[null,n({}),n([]),n(n)];for(var l=2&r&&t;"object"==typeof l&&!~e.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((e=>c[e]=()=>t[e]));return c.default=()=>t,i.d(o,c),o},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,n)=>(i.f[n](t,e),e)),[])),i.u=t=>t+"-"+{199:"2ad8899bfc2c1e1d3571",483:"b16e761eeea558a434ed"}[t]+".js",i.miniCssF=t=>"main-12b075fe02bc165c218a.css",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},o="hfy-epub:",i.l=(t,e,n,c)=>{if(r[t])r[t].push(e);else{var l,a;if(void 0!==n)for(var s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var f=s[u];if(f.getAttribute("src")==t||f.getAttribute("data-webpack")==o+n){l=f;break}}l||(a=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.setAttribute("data-webpack",o+n),l.src=t),r[t]=[e];var d=(e,n)=>{l.onerror=l.onload=null,clearTimeout(h);var o=r[t];if(delete r[t],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach((t=>t(n))),e)return e(n)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=d.bind(null,l.onerror),l.onload=d.bind(null,l.onload),a&&document.head.appendChild(l)}},i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t={179:0};i.f.j=(e,n)=>{var r=i.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=t[e]=[n,o]));n.push(r[2]=o);var c=i.p+i.u(e),l=new Error;i.l(c,(n=>{if(i.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),c=n&&n.target&&n.target.src;l.message="Loading chunk "+e+" failed.\n("+o+": "+c+")",l.name="ChunkLoadError",l.type=o,l.request=c,r[1](l)}}),"chunk-"+e,e)}},i.F.j=e=>{if(!i.o(t,e)||void 0===t[e]){t[e]=null;var n=document.createElement("link");i.nc&&n.setAttribute("nonce",i.nc),n.rel="prefetch",n.as="script",n.href=i.p+i.u(e),document.head.appendChild(n)}},i.O.j=e=>0===t[e];var e=(e,n)=>{var r,o,[c,l,a]=n,s=0;if(c.some((e=>0!==t[e]))){for(r in l)i.o(l,r)&&(i.m[r]=l[r]);if(a)var u=a(i)}for(e&&e(n);s<c.length;s++)o=c[s],i.o(t,o)&&t[o]&&t[o][0](),t[c[s]]=0;return i.O(u)},n=self.webpackChunkhfy_epub=self.webpackChunkhfy_epub||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),i.O(0,[179],(()=>{i.E(199),i.E(483)}),5);var a={};(()=>{"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t){return 0===Object.keys(t).length}function a(t,e,n,r){if(t){const o=s(t,e,n,r);return t[0](o)}}function s(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function u(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function f(t,e,n,r,o,c){if(o){const l=s(e,n,r,c);t.p(l,o)}}function d(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}new Set;let h,p=!1;function m(t,e){t.appendChild(e)}function g(t,e,n){t.insertBefore(e,n||null)}function $(t){t.parentNode.removeChild(t)}function b(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function v(t){return document.createElement(t)}function y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function w(t){return document.createTextNode(t)}function k(){return w(" ")}function x(){return w("")}function T(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function S(t){return function(e){return e.preventDefault(),t.call(this,e)}}function C(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function A(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function _(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function E(t,e){t.value=null==e?"":e}function N(t,e,n){t.classList[n?"add":"remove"](e)}function O(t){h=t}function j(){if(!h)throw new Error("Function called outside component initialization");return h}new Set;const D=[],H=[],P=[],L=[],F=Promise.resolve();let R=!1;function M(t){P.push(t)}function U(t){L.push(t)}let B=!1;const I=new Set;function q(){if(!B){B=!0;do{for(let t=0;t<D.length;t+=1){const e=D[t];O(e),z(e.$$)}for(O(null),D.length=0;H.length;)H.pop()();for(let t=0;t<P.length;t+=1){const e=P[t];I.has(e)||(I.add(e),e())}P.length=0}while(D.length);for(;L.length;)L.pop()();R=!1,B=!1,I.clear()}}function z(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const Y=new Set;let W,K;function G(){W={r:0,c:[],p:W}}function V(){W.r||r(W.c),W=W.p}function X(t,e){t&&t.i&&(Y.delete(t),t.i(e))}function J(t,e,n,r){if(t&&t.o){if(Y.has(t))return;Y.add(t),W.c.push((()=>{Y.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function Q(t,e){const n=e.token={};function r(t,r,o,c){if(e.token!==n)return;e.resolved=c;let l=e.ctx;void 0!==o&&(l=l.slice(),l[o]=c);const i=t&&(e.current=t)(l);let a=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(G(),J(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),V())})):e.block.d(1),i.c(),X(i,1),i.m(e.mount(),e.anchor),a=!0),e.block=i,e.blocks&&(e.blocks[r]=i),a&&q()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=j();if(t.then((t=>{O(n),r(e.then,1,e.value,t),O(null)}),(t=>{if(O(n),r(e.catch,2,e.error,t),O(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function Z(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}function tt(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function et(t){t&&t.c()}function nt(t,n,c,l){const{fragment:i,on_mount:a,on_destroy:s,after_update:u}=t.$$;i&&i.m(n,c),l||M((()=>{const n=a.map(e).filter(o);s?s.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(M)}function rt(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ot(e,o,c,l,i,a,s,u=[-1]){const f=h;O(e);const d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:o.context||[]),callbacks:n(),dirty:u,skip_bound:!1,root:o.target||f.$$.root};s&&s(d.root);let m=!1;if(d.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),m&&function(t,e){-1===t.$$.dirty[0]&&(D.push(t),R||(R=!0,F.then(q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],d.update(),m=!0,r(d.before_update),d.fragment=!!l&&l(d.ctx),o.target){if(o.hydrate){p=!0;const t=(g=o.target,Array.from(g.childNodes));d.fragment&&d.fragment.l(t),t.forEach($)}else d.fragment&&d.fragment.c();o.intro&&X(e.$$.fragment),nt(e,o.target,o.anchor,o.customElement),p=!1,q()}var g;O(f)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(K=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(o);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){r(this.$$.on_disconnect)}$destroy(){rt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class ct{$destroy(){rt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!l(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function lt(t){let e;return{c(){e=v("p"),e.innerHTML='This website (<a href="https://cpiber.github.io/hfy-epub" target="_blank" class="svelte-agc9w7">https://cpiber.github.io/hfy-epub</a>) does not, and will not, collect any data from its users.\n      Any actions taken on this page are purely in the user&#39;s browser; there is no server-side component.\n      No data is ever sent away.\n      For collecting the chapter data, this site contacts <code class="svelte-agc9w7">https://api.reddit.com</code> only. The book is generated in the browser.',A(e,"class","small svelte-agc9w7")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function it(e){let n,r,o,c,l,i,a,s,u,f,d,h,p,b,y=e[0]&&lt();return{c(){n=v("footer"),r=v("p"),o=w("Made by "),c=v("a"),c.textContent="@cpiber",l=w(".\n    Source Code: "),i=v("a"),i.textContent="cpiber/hfy-epub",a=w(".\n    \n    Version "),s=w("0.2.1"),u=w(".\n    "),f=v("a"),f.textContent="Privacy",d=w("."),h=k(),y&&y.c(),A(c,"href","https://github.com/cpiber"),A(c,"target","_blank"),A(c,"class","svelte-agc9w7"),A(i,"href","https://github.com/cpiber/hfy-epub"),A(i,"target","_blank"),A(i,"class","svelte-agc9w7"),A(f,"href","#?"),A(f,"class","svelte-agc9w7"),A(r,"class","small svelte-agc9w7"),A(n,"class","svelte-agc9w7")},m(t,$){g(t,n,$),m(n,r),m(r,o),m(r,c),m(r,l),m(r,i),m(r,a),m(r,s),m(r,u),m(r,f),m(r,d),m(n,h),y&&y.m(n,null),p||(b=T(f,"click",S(e[1])),p=!0)},p(t,[e]){t[0]?y||(y=lt(),y.c(),y.m(n,null)):y&&(y.d(1),y=null)},i:t,o:t,d(t){t&&$(n),y&&y.d(),p=!1,b()}}}function at(t,e,n){let r=!1;return[r,()=>n(0,r=!r)]}const st=class extends ct{constructor(t){super(),ot(this,t,at,it,c,{})}};function ut(e){let n;return{c(){n=v("header"),n.innerHTML='<h1 class="svelte-10isbm1">r/HFY epub generator</h1>',A(n,"class","svelte-10isbm1")},m(t,e){g(t,n,e)},p:t,i:t,o:t,d(t){t&&$(n)}}}const ft=class extends ct{constructor(t){super(),ot(this,t,null,ut,c,{})}};var dt,ht,pt=function(t,e,n,r){return new(n||(n=Promise))((function(o,c){function l(t){try{a(r.next(t))}catch(t){c(t)}}function i(t){try{a(r.throw(t))}catch(t){c(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,i)}a((r=r.apply(t,e||[])).next())}))},mt=function(t,e){var n,r,o,c,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return l.label++,{value:c[1],done:!1};case 5:l.label++,r=c[1],c=[0];continue;case 7:c=l.ops.pop(),l.trys.pop();continue;default:if(!((o=(o=l.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){l=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){l.label=c[1];break}if(6===c[0]&&l.label<o[1]){l.label=o[1],o=c;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(c);break}o[2]&&l.ops.pop(),l.trys.pop();continue}c=e.call(t,l)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}},gt=function(t,e){return pt(void 0,void 0,void 0,(function(){var n,r;return mt(this,(function(o){switch(o.label){case 0:n="undefined"!=typeof AbortController?new AbortController:{},r=setTimeout((function(){return n.abort&&n.abort()}),e),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,fetch(t,{signal:n.signal})];case 2:return[2,o.sent()];case 3:return clearTimeout(r),[7];case 4:return[2]}}))}))},$t=function(t,e,n){return void 0===e&&(e=1e4),void 0===n&&(n=3),pt(void 0,void 0,void 0,(function(){var r;return mt(this,(function(o){switch(o.label){case 0:r=0,o.label=1;case 1:if(!(r<n-1))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,gt(t,e)];case 3:return[2,o.sent()];case 4:return o.sent(),console.log("Failed to fetch `"+t+"` "+(r+1)+" "+(0===r?"time":"times")+". Retrying..."),[3,5];case 5:return r++,[3,1];case 6:return[2,gt(t,e)]}}))}))},bt=function(){return bt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},bt.apply(this,arguments)},vt=function(t){return t instanceof URL||(t=new URL(t)),t.hostname="api.reddit.com",t.pathname.endsWith("/")?t.pathname=t.pathname.slice(0,t.pathname.length-1)+".json":t.pathname.endsWith(".json")||(t.pathname+=".json"),t.protocol="https",t.search="",t.hash="",t.toString()},yt=function(t){return t.slice(0,-5).replace("https://api","https://www")},wt=(dt=new DOMParser,function(t){return dt.parseFromString(t,"text/html").documentElement.textContent}),kt=function(t){return bt(bt({},t),{chapters:t.chapters.map((function(t){return bt({},t)}))})},xt=/\[([^\]]+)\]\s*\(((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/[^)]+)\)/gim,Tt=/href="((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/[^"]+)"[^>]*>\s*([^<]+)/gim,St=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,c=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=c.next()).done;)l.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}return l},Ct=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,c=e.length;o<c;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},At=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/hfy\/wiki\/series\//i,_t=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/([^/]+)\/comments\//i,Et=function(t){return{title:t[0].data.children[0].data.title,content:wt(t[0].data.children[0].data.selftext_html),url:vt(t[0].data.children[0].data.url),needsFetching:!1}};!function(t){t[t.HFY_SERIES=0]="HFY_SERIES",t[t.POST=1]="POST",t[t.SEARCH=2]="SEARCH"}(ht||(ht={}));var Nt=function(t){var e=t.match(/href="([^"]+)"[^>]*>\s*Next/i);if(e)return e[1];var n=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,c=e.length;o<c;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,c=n.call(t),l=[];try{for(;(void 0===e||e-- >0)&&!(r=c.next()).done;)l.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}return l}(t.matchAll(Tt)),!1).reverse().find((function(t){var e=t[3].toLowerCase();return!e.startsWith("first")&&!e.startsWith("prev")&&!e.startsWith("index")}));return n?n[1]:void 0};function Ot(t){let e;return{c(){e=v("p"),e.textContent="Please enter a search string",A(e,"class","small error svelte-5ajakl")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function jt(e){let n,o,c,l,i,a,s,u,f,d,h,p,b,y,w,x=!e[0].trim().length,S=x&&Ot();return{c(){n=v("h2"),n.innerHTML='Please enter your search terms below: <a class="small" href="https://github.com/cpiber/hfy-epub/tree/master/docs/index.md" target="_blank">Help</a>',o=k(),c=v("form"),l=v("p"),i=v("input"),a=k(),s=v("input"),f=k(),S&&S.c(),d=k(),h=v("p"),h.textContent="You can:",p=k(),b=v("ul"),b.innerHTML='<li>Search for a series title on the <a href="https://reddit.com/r/HFY/wiki/series" target="_blank">r/HFY wiki</a></li> \n  <li>Enter a series link to the <a href="https://reddit.com/r/HFY" target="_blank">r/HFY</a> wiki</li> \n  <li>Enter a link to any reddit post</li>',A(n,"class","heading svelte-5ajakl"),A(i,"class","search svelte-5ajakl"),A(i,"placeholder","Search or URL..."),A(s,"type","submit"),s.value="Go",A(s,"class","submit svelte-5ajakl"),s.disabled=u=!e[0].trim().length,A(s,"name","search"),A(l,"class","svelte-5ajakl"),A(c,"class","form svelte-5ajakl"),A(h,"class","spaceabove svelte-5ajakl")},m(t,r){g(t,n,r),g(t,o,r),g(t,c,r),m(c,l),m(l,i),E(i,e[0]),m(l,a),m(l,s),g(t,f,r),S&&S.m(t,r),g(t,d,r),g(t,h,r),g(t,p,r),g(t,b,r),y||(w=[T(i,"input",e[2]),T(c,"submit",C(e[3]))],y=!0)},p(t,[e]){1&e&&i.value!==t[0]&&E(i,t[0]),1&e&&u!==(u=!t[0].trim().length)&&(s.disabled=u),1&e&&(x=!t[0].trim().length),x?S||(S=Ot(),S.c(),S.m(d.parentNode,d)):S&&(S.d(1),S=null)},i:t,o:t,d(t){t&&$(n),t&&$(o),t&&$(c),t&&$(f),S&&S.d(t),t&&$(d),t&&$(h),t&&$(p),t&&$(b),y=!1,r(w)}}}function Dt(t,e,n){let{search:r=""}=e,{goNext:o}=e;return t.$$set=t=>{"search"in t&&n(0,r=t.search),"goNext"in t&&n(1,o=t.goNext)},[r,o,function(){r=this.value,n(0,r)},()=>o(r)]}const Ht=class extends ct{constructor(t){super(),ot(this,t,Dt,jt,c,{search:0,goNext:1})}};function Pt(e){let n,r,c,l,i,a,s,u,f=e[0]?": ":"",d=(e[0].message||e[0])+"";return{c(){n=v("p"),r=w("Sorry, can't process that"),c=w(f),l=w(d),i=k(),a=v("button"),a.textContent="Retry",A(n,"class","error svelte-alvqhf")},m(t,f){g(t,n,f),m(n,r),m(n,c),m(n,l),g(t,i,f),g(t,a,f),s||(u=T(a,"click",(function(){o(e[1])&&e[1].apply(this,arguments)})),s=!0)},p(t,[n]){e=t,1&n&&f!==(f=e[0]?": ":"")&&_(c,f),1&n&&d!==(d=(e[0].message||e[0])+"")&&_(l,d)},i:t,o:t,d(t){t&&$(n),t&&$(i),t&&$(a),s=!1,u()}}}function Lt(t,e,n){let{error:r}=e,{retry:o}=e;return t.$$set=t=>{"error"in t&&n(0,r=t.error),"retry"in t&&n(1,o=t.retry)},[r,o]}const Ft=class extends ct{constructor(t){super(),ot(this,t,Lt,Pt,c,{error:0,retry:1})}};function Rt(t){let e,n,r,o,c;const l=t[1].default,i=a(l,t,t[0],null),s=i||function(t){let e;return{c(){e=w("Loading...")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}();return{c(){e=v("div"),n=v("div"),n.innerHTML='<span class="loading-slider svelte-p1cdob">•</span>',r=k(),o=v("p"),s&&s.c(),A(n,"class","loading-slider-container svelte-p1cdob"),A(o,"class","loading svelte-p1cdob"),A(e,"class","loading-container svelte-p1cdob")},m(t,l){g(t,e,l),m(e,n),m(e,r),m(e,o),s&&s.m(o,null),c=!0},p(t,[e]){i&&i.p&&(!c||1&e)&&f(i,l,t,t[0],c?u(l,t[0],e,null):d(t[0]),null)},i(t){c||(X(s,t),c=!0)},o(t){J(s,t),c=!1},d(t){t&&$(e),s&&s.d(t)}}}function Mt(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}const Ut=class extends ct{constructor(t){super(),ot(this,t,Mt,Rt,c,{})}};function Bt(t,e,n){const r=t.slice();return r[8]=e[n],r}function It(t){let e,n;return e=new Ft({props:{error:t[11],retry:t[5]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[11]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function qt(e){let n,r,o,c,l,i,a,s,u=e[7],f=[];for(let t=0;t<u.length;t+=1)f[t]=Yt(Bt(e,u,t));return{c(){n=v("p"),r=w("The search for '"),o=w(e[0]),c=w("' returned these results:"),l=k(),i=v("ul");for(let t=0;t<f.length;t+=1)f[t].c();a=k(),s=v("p"),s.textContent="Please select one.",A(s,"class","small")},m(t,e){g(t,n,e),m(n,r),m(n,o),m(n,c),g(t,l,e),g(t,i,e);for(let t=0;t<f.length;t+=1)f[t].m(i,null);g(t,a,e),g(t,s,e)},p(t,e){if(1&e&&_(o,t[0]),6&e){let n;for(u=t[7],n=0;n<u.length;n+=1){const r=Bt(t,u,n);f[n]?f[n].p(r,e):(f[n]=Yt(r),f[n].c(),f[n].m(i,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=u.length}},i:t,o:t,d(t){t&&$(n),t&&$(l),t&&$(i),b(f,t),t&&$(a),t&&$(s)}}}function zt(t){let e,n,r,o,c=t[8].author+"";return{c(){e=w("["),n=v("i"),r=w(c),o=w("]")},m(t,c){g(t,e,c),g(t,n,c),m(n,r),g(t,o,c)},p(t,e){4&e&&c!==(c=t[8].author+"")&&_(r,c)},d(t){t&&$(e),t&&$(n),t&&$(o)}}}function Yt(t){let e,n,r,o,c,l,i,a,s=t[8].title+"";function u(){return t[4](t[8])}let f=t[8].author&&zt(t);return{c(){e=v("li"),n=v("a"),r=w(s),c=k(),f&&f.c(),l=k(),A(n,"href",o=yt(t[8].url))},m(t,o){g(t,e,o),m(e,n),m(n,r),m(e,c),f&&f.m(e,null),m(e,l),i||(a=T(n,"click",S(u)),i=!0)},p(c,i){t=c,4&i&&s!==(s=t[8].title+"")&&_(r,s),4&i&&o!==(o=yt(t[8].url))&&A(n,"href",o),t[8].author?f?f.p(t,i):(f=zt(t),f.c(),f.m(e,l)):f&&(f.d(1),f=null)},d(t){t&&$(e),f&&f.d(),i=!1,a()}}}function Wt(t){let e,n;return e=new Ut({props:{$$slots:{default:[Kt]},$$scope:{ctx:t}}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Kt(t){let e;return{c(){e=w("Please wait, fetching results...")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function Gt(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Wt,then:qt,catch:It,value:7,error:11,blocks:[,,,]};return Q(n=t[2],o),{c(){e=x(),o.block.c()},m(t,n){g(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&Q(n,o)||Z(o,t,r)},i(t){r||(X(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)J(o.blocks[t]);r=!1},d(t){t&&$(e),o.block.d(t),o.token=null,o=null}}}function Vt(t,e,n){let{search:r}=e,{goNext:o}=e;const c=r.toLowerCase(),l=()=>$t("https://api.reddit.com/r/hfy/wiki/series.json").then((t=>t.json())).then((t=>t.data.content_md)).then((t=>[...t.matchAll(/\[([^\]]+)\]\s*\(((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/hfy\/wiki\/series\/[^)]+)\)\s*(?:\[\*([^\]]+)\*\])?/gim)].map((t=>({title:t[1],author:t[3],url:vt(t[2].startsWith("http")?t[2]:`https://api.reddit.com${t[2]}`)}))))).then((t=>t.filter((t=>-1!==t.title.toLowerCase().indexOf(c))))).then((t=>{if(!t.length)throw new Error(`No series matched input \`${r}\``);return t}));let i=l();return t.$$set=t=>{"search"in t&&n(0,r=t.search),"goNext"in t&&n(1,o=t.goNext)},[r,o,i,l,t=>o({url:t.url,type:ht.HFY_SERIES}),()=>n(2,i=l())]}const Xt=class extends ct{constructor(t){super(),ot(this,t,Vt,Gt,c,{search:0,goNext:1})}};function Jt(t){let e,n,r;return{c(){e=v("a"),e.textContent="Back to Search",A(e,"href","#?"),A(e,"class","small")},m(c,l){g(c,e,l),n||(r=T(e,"click",S((function(){o(t[0])&&t[0].apply(this,arguments)}))),n=!0)},p(e,n){t=e},d(t){t&&$(e),n=!1,r()}}}function Qt(e){let n,r=e[0]&&Jt(e);return{c(){r&&r.c(),n=x()},m(t,e){r&&r.m(t,e),g(t,n,e)},p(t,[e]){t[0]?r?r.p(t,e):(r=Jt(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&$(n)}}}function Zt(t,e,n){let{backToSearch:r}=e;return t.$$set=t=>{"backToSearch"in t&&n(0,r=t.backToSearch)},[r]}const te=class extends ct{constructor(t){super(),ot(this,t,Zt,Qt,c,{backToSearch:0})}};function ee(t){let e,n,r;return{c(){e=v("span"),A(e,"class","edit svelte-wwqdsx"),A(e,"contenteditable",""),void 0===t[0]&&M((()=>t[8].call(e)))},m(o,c){g(o,e,c),void 0!==t[0]&&(e.innerHTML=t[0]),n||(r=T(e,"input",t[8]),n=!0)},p(t,n){1&n&&t[0]!==e.innerHTML&&(e.innerHTML=t[0])},d(t){t&&$(e),n=!1,r()}}}function ne(t){let e,n,r,o=wt(t[0])+"";return{c(){e=v("a"),n=w(o),A(e,"href",r=yt(t[3])),A(e,"target","_blank")},m(t,r){g(t,e,r),m(e,n)},p(t,c){1&c&&o!==(o=wt(t[0])+"")&&_(n,o),8&c&&r!==(r=yt(t[3]))&&A(e,"href",r)},d(t){t&&$(e)}}}function re(t){let e,n,r;return{c(){e=v("span"),A(e,"class","edit svelte-wwqdsx"),A(e,"contenteditable",""),void 0===t[1]&&M((()=>t[9].call(e)))},m(o,c){g(o,e,c),void 0!==t[1]&&(e.innerHTML=t[1]),n||(r=T(e,"input",t[9]),n=!0)},p(t,n){2&n&&t[1]!==e.innerHTML&&(e.innerHTML=t[1])},d(t){t&&$(e),n=!1,r()}}}function oe(t){let e,n=wt(t[1])+"";return{c(){e=w(n)},m(t,n){g(t,e,n)},p(t,r){2&r&&n!==(n=wt(t[1])+"")&&_(e,n)},d(t){t&&$(e)}}}function ce(t){let e,n,r,o;const c=t[7].default,l=a(c,t,t[6],null);return{c(){e=v("h3"),e.textContent="Chapters",n=k(),r=v("div"),l&&l.c()},m(t,c){g(t,e,c),g(t,n,c),g(t,r,c),l&&l.m(r,null),o=!0},p(t,e){l&&l.p&&(!o||64&e)&&f(l,c,t,t[6],o?u(c,t[6],e,null):d(t[6]),null)},i(t){o||(X(l,t),o=!0)},o(t){J(l,t),o=!1},d(t){t&&$(e),t&&$(n),t&&$(r),l&&l.d(t)}}}function le(t){let e,n,r,c,l,i,a,s,u,f,d,h;function p(t,e){return t[2]?ee:ne}let b=p(t),y=b(t);function w(t,e){return t[2]?re:oe}let x=w(t),C=x(t),_=t[5].default&&ce(t);return{c(){e=v("form"),n=v("h3"),n.textContent="Title",r=k(),c=v("p"),y.c(),l=k(),i=v("h3"),i.textContent="Author",a=k(),s=v("p"),C.c(),u=k(),_&&_.c(),A(e,"class","series-card svelte-wwqdsx")},m(p,$){g(p,e,$),m(e,n),m(e,r),m(e,c),y.m(c,null),m(e,l),m(e,i),m(e,a),m(e,s),C.m(s,null),m(e,u),_&&_.m(e,null),f=!0,d||(h=T(e,"submit",S((function(){o(t[4])&&t[4].apply(this,arguments)}))),d=!0)},p(n,[r]){b===(b=p(t=n))&&y?y.p(t,r):(y.d(1),y=b(t),y&&(y.c(),y.m(c,null))),x===(x=w(t))&&C?C.p(t,r):(C.d(1),C=x(t),C&&(C.c(),C.m(s,null))),t[5].default?_?(_.p(t,r),32&r&&X(_,1)):(_=ce(t),_.c(),X(_,1),_.m(e,null)):_&&(G(),J(_,1,1,(()=>{_=null})),V())},i(t){f||(X(_),f=!0)},o(t){J(_),f=!1},d(t){t&&$(e),y.d(),C.d(),_&&_.d(),d=!1,h()}}}function ie(t,e,n){let{$$slots:r={},$$scope:o}=e;const c=function(t){const e={};for(const n in t)e[n]=!0;return e}(r);let{edit:l=!1}=e,{title:i}=e,{author:a}=e,{url:s=""}=e,{onSubmit:u}=e;return t.$$set=t=>{"edit"in t&&n(2,l=t.edit),"title"in t&&n(0,i=t.title),"author"in t&&n(1,a=t.author),"url"in t&&n(3,s=t.url),"onSubmit"in t&&n(4,u=t.onSubmit),"$$scope"in t&&n(6,o=t.$$scope)},[i,a,l,s,u,c,o,r,function(){i=this.innerHTML,n(0,i)},function(){a=this.innerHTML,n(1,a)}]}const ae=class extends ct{constructor(t){super(),ot(this,t,ie,le,c,{edit:2,title:0,author:1,url:3,onSubmit:4})}};function se(t,e,n){const r=t.slice();return r[18]=e[n],r}function ue(t){let e,n,r,o;return e=new Ft({props:{error:t[21],retry:t[16]}}),r=new te({props:{backToSearch:t[3]}}),{c(){et(e.$$.fragment),n=k(),et(r.$$.fragment)},m(t,c){nt(e,t,c),g(t,n,c),nt(r,t,c),o=!0},p(t,n){const o={};256&n&&(o.error=t[21]),256&n&&(o.retry=t[16]),e.$set(o);const c={};8&n&&(c.backToSearch=t[3]),r.$set(c)},i(t){o||(X(e.$$.fragment,t),X(r.$$.fragment,t),o=!0)},o(t){J(e.$$.fragment,t),J(r.$$.fragment,t),o=!1},d(t){rt(e,t),t&&$(n),rt(r,t)}}}function fe(t){let e,n,r,o,c,l,i,a,s,u,f,d;function h(t,e){return(null==c||256&e)&&(c=!!t[17].chapters.find(xe)),c?ve:be}r=new ae({props:{title:t[17].title,author:t[17].author,url:t[0].url,$$slots:{default:[$e]},$$scope:{ctx:t}}});let p=h(t,-1),m=p(t);function b(){return t[15](t[17])}return s=new te({props:{backToSearch:t[3]}}),{c(){e=w("Got the following series:\n\n  "),n=v("div"),et(r.$$.fragment),o=k(),m.c(),l=k(),i=v("button"),i.textContent="Edit book",a=k(),et(s.$$.fragment),A(n,"class","list svelte-r5r0jj")},m(t,c){g(t,e,c),g(t,n,c),nt(r,n,null),g(t,o,c),m.m(t,c),g(t,l,c),g(t,i,c),g(t,a,c),nt(s,t,c),u=!0,f||(d=T(i,"click",b),f=!0)},p(e,n){t=e;const o={};256&n&&(o.title=t[17].title),256&n&&(o.author=t[17].author),1&n&&(o.url=t[0].url),4194722&n&&(o.$$scope={dirty:n,ctx:t}),r.$set(o),p===(p=h(t,n))&&m?m.p(t,n):(m.d(1),m=p(t),m&&(m.c(),m.m(l.parentNode,l)));const c={};8&n&&(c.backToSearch=t[3]),s.$set(c)},i(t){u||(X(r.$$.fragment,t),X(s.$$.fragment,t),u=!0)},o(t){J(r.$$.fragment,t),J(s.$$.fragment,t),u=!1},d(t){t&&$(e),t&&$(n),rt(r),t&&$(o),m.d(t),t&&$(l),t&&$(i),t&&$(a),rt(s,t),f=!1,d()}}}function de(t){let e;return{c(){e=w("hide")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function he(t){let e;return{c(){e=w("show")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function pe(t){let e,n,r;return{c(){e=w("Found "),n=w(t[1]),r=w(" new")},m(t,o){g(t,e,o),g(t,n,o),g(t,r,o)},p(t,e){2&e&&_(n,t[1])},d(t){t&&$(e),t&&$(n),t&&$(r)}}}function me(t){let e,n=t[17].chapters,r=[];for(let e=0;e<n.length;e+=1)r[e]=ge(se(t,n,e));return{c(){e=v("div");for(let t=0;t<r.length;t+=1)r[t].c();A(e,"class","chapter-list svelte-r5r0jj")},m(t,n){g(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(256&o){let c;for(n=t[17].chapters,c=0;c<n.length;c+=1){const l=se(t,n,c);r[c]?r[c].p(l,o):(r[c]=ge(l),r[c].c(),r[c].m(e,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(t){t&&$(e),b(r,t)}}}function ge(t){let e,n,r,o=wt(t[18].title)+"";return{c(){e=v("a"),n=w(o),A(e,"href",r=yt(t[18].url)),A(e,"target","_blank"),A(e,"class","small")},m(t,r){g(t,e,r),m(e,n)},p(t,c){256&c&&o!==(o=wt(t[18].title)+"")&&_(n,o),256&c&&r!==(r=yt(t[18].url))&&A(e,"href",r)},d(t){t&&$(e)}}}function $e(t){let e,n,o,c,l,i,a,s,u,f,d,h,p,b,y=t[17].chapters.length+"";function C(t,e){return t[7]?de:he}let E=C(t),N=E(t);function O(){return t[12](t[17])}let j="number"==typeof t[1]&&pe(t),D=t[7]&&me(t);return{c(){e=v("p"),n=w("Found "),o=w(y),c=k(),l=v("a"),N.c(),i=k(),a=v("span"),s=k(),u=v("button"),u.textContent="Find more",f=k(),j&&j.c(),d=k(),D&&D.c(),h=x(),A(l,"href","#show"),A(l,"class","small"),A(a,"class","spacer svelte-r5r0jj"),A(e,"class","no-margin svelte-r5r0jj")},m(r,$){g(r,e,$),m(e,n),m(e,o),m(e,c),m(e,l),N.m(l,null),m(e,i),m(e,a),m(e,s),m(e,u),m(e,f),j&&j.m(e,null),g(r,d,$),D&&D.m(r,$),g(r,h,$),p||(b=[T(l,"click",S(t[11])),T(u,"click",O)],p=!0)},p(n,r){t=n,256&r&&y!==(y=t[17].chapters.length+"")&&_(o,y),E!==(E=C(t))&&(N.d(1),N=E(t),N&&(N.c(),N.m(l,null))),"number"==typeof t[1]?j?j.p(t,r):(j=pe(t),j.c(),j.m(e,null)):j&&(j.d(1),j=null),t[7]?D?D.p(t,r):(D=me(t),D.c(),D.m(h.parentNode,h)):D&&(D.d(1),D=null)},d(t){t&&$(e),N.d(),j&&j.d(),t&&$(d),D&&D.d(t),t&&$(h),p=!1,r(b)}}}function be(t){let e,n,r;function o(){return t[14](t[17])}return{c(){e=v("button"),e.textContent="Generate EPUB"},m(t,c){g(t,e,c),n||(r=T(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&$(e),n=!1,r()}}}function ve(t){let e,n,r;function o(){return t[13](t[17])}return{c(){e=v("button"),e.textContent="Fetch chapter contents"},m(t,c){g(t,e,c),n||(r=T(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&$(e),n=!1,r()}}}function ye(t){let e,n;return e=new Ut({props:{$$slots:{default:[we]},$$scope:{ctx:t}}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};4194304&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function we(t){let e;return{c(){e=w("Please wait, fetching data...")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function ke(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:ye,then:fe,catch:ue,value:17,error:21,blocks:[,,,]};return Q(n=t[8],o),{c(){e=x(),o.block.c()},m(t,n){g(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,256&r&&n!==(n=t[8])&&Q(n,o)||Z(o,t,r)},i(t){r||(X(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)J(o.blocks[t]);r=!1},d(t){t&&$(e),o.block.d(t),o.token=null,o=null}}}const xe=t=>!1!==t.needsFetching;function Te(t,e,n){let{series:r}=e,{bookData:o}=e,{newChapters:c}=e,{goNext:l}=e,{backToSearch:i}=e,{edit:a}=e,{findMore:s}=e,{downloadAll:u}=e,f=!1;const d=()=>o?Promise.resolve(kt(o)):function(t){return e=void 0,n=void 0,o=function(){var e,n,r;return function(t,e){var n,r,o,c,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function i(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return l.label++,{value:c[1],done:!1};case 5:l.label++,r=c[1],c=[0];continue;case 7:c=l.ops.pop(),l.trys.pop();continue;default:if(!((o=(o=l.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){l=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){l.label=c[1];break}if(6===c[0]&&l.label<o[1]){l.label=o[1],o=c;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(c);break}o[2]&&l.ops.pop(),l.trys.pop();continue}c=e.call(t,l)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}}(this,(function(o){switch(o.label){case 0:return[4,$t(t.url)];case 1:return[4,(e=o.sent()).json()];case 2:if(n=o.sent(),!e.ok)throw n.message;if(!(r=function(t,e){switch(t){case ht.HFY_SERIES:return{author:null===(n=(c=e.data.content_md).match(/\[\*\*(?:Author\s*[-:]\s*)?([^*\]]+)\*\*\]|A Story By \[(?:\*\*)?([^\]]+?)(?:\*\*)?\]/i).slice(1).find(Boolean))||void 0===n?void 0:n.trim(),title:null===(o=null===(r=c.match(/##?\s*\*\*(.+)\*\*/))||void 0===r?void 0:r[1])||void 0===o?void 0:o.trim(),chapters:Ct([],St(c.matchAll(xt)),!1).map((function(t){return{title:t[1].trim(),url:vt(t[2].startsWith("http")?t[2]:"https://api.reddit.com"+t[2])}}))};case ht.POST:return function(t){return{author:t[0].data.children[0].data.author,title:t[0].data.children[0].data.title,chapters:[Et(t)]}}(e)}var n,r,o,c;throw new Error("Getting data from source type `"+ht[t]+"` not supported, this should never happen")}(t.type,n))||!r.chapters||!r.chapters.length)throw new Error("No chapters found");return[2,r]}}))},new((r=void 0)||(r=Promise))((function(t,c){function l(t){try{a(o.next(t))}catch(t){c(t)}}function i(t){try{a(o.throw(t))}catch(t){c(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(l,i)}a((o=o.apply(e,n||[])).next())}));var e,n,r,o}(r);let h=d();return t.$$set=t=>{"series"in t&&n(0,r=t.series),"bookData"in t&&n(10,o=t.bookData),"newChapters"in t&&n(1,c=t.newChapters),"goNext"in t&&n(2,l=t.goNext),"backToSearch"in t&&n(3,i=t.backToSearch),"edit"in t&&n(4,a=t.edit),"findMore"in t&&n(5,s=t.findMore),"downloadAll"in t&&n(6,u=t.downloadAll)},[r,c,l,i,a,s,u,f,h,d,o,()=>n(7,f=!f),t=>s(t),t=>u(t),t=>l(t),t=>a(t),()=>n(8,h=d())]}const Se=class extends ct{constructor(t){super(),ot(this,t,Te,ke,c,{series:0,bookData:10,newChapters:1,goNext:2,backToSearch:3,edit:4,findMore:5,downloadAll:6})}};function Ce(e){let n,r;return{c(){n=y("svg"),r=y("polygon"),A(r,"points","0,332.668 245.004,82.631 490,332.668 413.507,407.369 245.004,235.402 76.493,407.369"),A(n,"version","1.1"),A(n,"xmlns","http://www.w3.org/2000/svg"),A(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),A(n,"x","0px"),A(n,"y","0px"),A(n,"viewBox","0 0 490 490"),A(n,"xml:space","preserve")},m(t,e){g(t,n,e),m(n,r)},p:t,i:t,o:t,d(t){t&&$(n)}}}const Ae=class extends ct{constructor(t){super(),ot(this,t,null,Ce,c,{})}};function _e(t){let e,n,o,c,l,i,a,s,u,f,d,h,p,b,y,x,S,O,j,D,H=wt(t[1]||"")+"";return u=new Ae({}),{c(){e=v("div"),n=v("div"),o=v("span"),c=k(),l=v("span"),i=w(H),a=k(),s=v("span"),et(u.$$.fragment),f=k(),d=v("div"),h=v("div"),p=v("textarea"),b=k(),y=v("label"),x=v("input"),S=w(" Fetch contents"),A(o,"class","title svelte-avqhsz"),A(o,"contenteditable",""),void 0===t[0]&&M((()=>t[9].call(o))),A(l,"class","content svelte-avqhsz"),A(s,"class","toggle svelte-avqhsz"),A(n,"class","preview svelte-avqhsz"),p.disabled=t[2],A(x,"type","checkbox"),A(h,"class","edit-inner"),A(d,"class","edit svelte-avqhsz"),A(e,"class","chapter svelte-avqhsz"),N(e,"open",t[4])},m(r,$){g(r,e,$),m(e,n),m(n,o),void 0!==t[0]&&(o.innerHTML=t[0]),t[10](o),m(n,c),m(n,l),m(l,i),m(n,a),m(n,s),nt(u,s,null),m(e,f),m(e,d),m(d,h),m(h,p),E(p,t[1]),m(h,b),m(h,y),m(y,x),x.checked=t[2],m(y,S),t[14](h),t[15](d),O=!0,j||(D=[T(o,"input",t[9]),T(o,"keydown",t[8]),T(s,"click",C(t[7])),T(n,"click",t[11]),T(p,"input",t[12]),T(x,"change",t[13])],j=!0)},p(t,[n]){1&n&&t[0]!==o.innerHTML&&(o.innerHTML=t[0]),(!O||2&n)&&H!==(H=wt(t[1]||"")+"")&&_(i,H),(!O||4&n)&&(p.disabled=t[2]),2&n&&E(p,t[1]),4&n&&(x.checked=t[2]),16&n&&N(e,"open",t[4])},i(t){O||(X(u.$$.fragment,t),O=!0)},o(t){J(u.$$.fragment,t),O=!1},d(n){n&&$(e),t[10](null),rt(u),t[14](null),t[15](null),j=!1,r(D)}}}function Ee(t,e,n){let r,{title:o}=e,{content:c}=e,{needsFetching:l}=e;l=null==l||l,c=null!=c?c:"";let i,a=!1,[s,u]=[];var f;return f=()=>{i=new ResizeObserver((()=>n(6,u.style.height=`${s.scrollHeight}px`,u))),i.observe(s)},j().$$.on_mount.push(f),j().$$.on_destroy.push((()=>{i.disconnect()})),t.$$set=t=>{"title"in t&&n(0,o=t.title),"content"in t&&n(1,c=t.content),"needsFetching"in t&&n(2,l=t.needsFetching)},t.$$.update=()=>{1&t.$$.dirty&&n(0,o=o.replace(/<[^>]*>/g,"")),24&t.$$.dirty&&(null==r||r.scrollTo({left:0}))},[o,c,l,r,a,s,u,()=>n(4,a=!a),t=>{"Enter"!==t.key&&13!==t.keyCode||t.preventDefault()},function(){o=this.innerHTML,n(0,o)},function(t){H[t?"unshift":"push"]((()=>{r=t,n(3,r)}))},()=>n(4,a=!0),function(){c=this.value,n(1,c)},function(){l=this.checked,n(2,l)},function(t){H[t?"unshift":"push"]((()=>{s=t,n(5,s)}))},function(t){H[t?"unshift":"push"]((()=>{u=t,n(6,u)}))}]}const Ne=class extends ct{constructor(t){super(),ot(this,t,Ee,_e,c,{title:0,content:1,needsFetching:2})}};function Oe(t,e,n){const r=t.slice();return r[12]=e[n],r[13]=e,r[14]=n,r}function je(t){let e,n,r,o,c;function l(e){t[4](e,t[12])}function i(e){t[5](e,t[12])}function a(e){t[6](e,t[12])}let s={};return void 0!==t[12].title&&(s.title=t[12].title),void 0!==t[12].content&&(s.content=t[12].content),void 0!==t[12].needsFetching&&(s.needsFetching=t[12].needsFetching),e=new Ne({props:s}),H.push((()=>tt(e,"title",l))),H.push((()=>tt(e,"content",i))),H.push((()=>tt(e,"needsFetching",a))),{c(){et(e.$$.fragment)},m(t,n){nt(e,t,n),c=!0},p(c,l){t=c;const i={};!n&&2&l&&(n=!0,i.title=t[12].title,U((()=>n=!1))),!r&&2&l&&(r=!0,i.content=t[12].content,U((()=>r=!1))),!o&&2&l&&(o=!0,i.needsFetching=t[12].needsFetching,U((()=>o=!1))),e.$set(i)},i(t){c||(X(e.$$.fragment,t),c=!0)},o(t){J(e.$$.fragment,t),c=!1},d(t){rt(e,t)}}}function De(t){let e,n,r=t[1].chapters,o=[];for(let e=0;e<r.length;e+=1)o[e]=je(Oe(t,r,e));const c=t=>J(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=x()},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);g(t,e,r),n=!0},p(t,n){if(2&n){let l;for(r=t[1].chapters,l=0;l<r.length;l+=1){const c=Oe(t,r,l);o[l]?(o[l].p(c,n),X(o[l],1)):(o[l]=je(c),o[l].c(),X(o[l],1),o[l].m(e.parentNode,e))}for(G(),l=r.length;l<o.length;l+=1)c(l);V()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)X(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)J(o[t]);n=!1},d(t){b(o,t),t&&$(e)}}}function He(t){let e,n,o,c,l,i,a,s,u,f,d,h;function p(e){t[8](e)}function m(e){t[9](e)}let b={edit:!0,onSubmit:t[7],$$slots:{default:[De]},$$scope:{ctx:t}};return void 0!==t[1].title&&(b.title=t[1].title),void 0!==t[1].author&&(b.author=t[1].author),o=new ae({props:b}),H.push((()=>tt(o,"title",p))),H.push((()=>tt(o,"author",m))),{c(){e=w("You are editing:\n\n"),n=v("div"),et(o.$$.fragment),i=k(),a=v("button"),a.textContent="Save",s=k(),u=v("a"),u.textContent="Cancel",A(n,"class","list svelte-1yu1fmh"),A(a,"type","submit"),A(u,"href","#?"),A(u,"class","small")},m(r,c){g(r,e,c),g(r,n,c),nt(o,n,null),g(r,i,c),g(r,a,c),g(r,s,c),g(r,u,c),f=!0,d||(h=[T(a,"click",t[10]),T(u,"click",S(t[11]))],d=!0)},p(t,[e]){const n={};3&e&&(n.onSubmit=t[7]),32770&e&&(n.$$scope={dirty:e,ctx:t}),!c&&2&e&&(c=!0,n.title=t[1].title,U((()=>c=!1))),!l&&2&e&&(l=!0,n.author=t[1].author,U((()=>l=!1))),o.$set(n)},i(t){f||(X(o.$$.fragment,t),f=!0)},o(t){J(o.$$.fragment,t),f=!1},d(t){t&&$(e),t&&$(n),rt(o),t&&$(i),t&&$(a),t&&$(s),t&&$(u),d=!1,r(h)}}}function Pe(t,e,n){let{bookData:r}=e,{goNext:o}=e;const c=kt(r),l=kt(r);return t.$$set=t=>{"bookData"in t&&n(3,r=t.bookData),"goNext"in t&&n(0,o=t.goNext)},[o,l,c,r,function(e,r){t.$$.not_equal(r.title,e)&&(r.title=e,n(1,l))},function(e,r){t.$$.not_equal(r.content,e)&&(r.content=e,n(1,l))},function(e,r){t.$$.not_equal(r.needsFetching,e)&&(r.needsFetching=e,n(1,l))},()=>o(l),function(e){t.$$.not_equal(l.title,e)&&(l.title=e,n(1,l))},function(e){t.$$.not_equal(l.author,e)&&(l.author=e,n(1,l))},()=>o(l),()=>o(c)]}const Le=class extends ct{constructor(t){super(),ot(this,t,Pe,He,c,{bookData:3,goNext:0})}};function Fe(t,e,n){const r=t.slice();return r[8]=e[n],r}function Re(t){let e,n;return e=new Ft({props:{error:t[12],retry:t[5]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[12]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Me(e){let n,r=e[0](e[11],e[1].length)+"";return{c(){n=w(r)},m(t,e){g(t,n,e)},p(t,e){7&e&&r!==(r=t[0](t[11],t[1].length)+"")&&_(n,r)},i:t,o:t,d(t){t&&$(n)}}}function Ue(t){let e,n,r,o;e=new Ut({props:{$$slots:{default:[Be]},$$scope:{ctx:t}}});let c=t[1],l=[];for(let e=0;e<c.length;e+=1)l[e]=Ie(Fe(t,c,e));return{c(){et(e.$$.fragment),n=k(),r=v("div");for(let t=0;t<l.length;t+=1)l[t].c();A(r,"class","chapters")},m(t,c){nt(e,t,c),g(t,n,c),g(t,r,c);for(let t=0;t<l.length;t+=1)l[t].m(r,null);o=!0},p(t,n){const o={};if(8192&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),2&n){let e;for(c=t[1],e=0;e<c.length;e+=1){const o=Fe(t,c,e);l[e]?l[e].p(o,n):(l[e]=Ie(o),l[e].c(),l[e].m(r,null))}for(;e<l.length;e+=1)l[e].d(1);l.length=c.length}},i(t){o||(X(e.$$.fragment,t),o=!0)},o(t){J(e.$$.fragment,t),o=!1},d(t){rt(e,t),t&&$(n),t&&$(r),b(l,t)}}}function Be(t){let e;return{c(){e=w("Please wait, fetching chapters...")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function Ie(t){let e,n,r,o,c,l,i=t[8].from+"",a=t[8].url+"";return{c(){e=v("p"),n=w(i),r=w(": Extracted "),o=v("a"),c=w(a),A(o,"href",l=t[8].url),A(e,"class","valid small svelte-188oh31")},m(t,l){g(t,e,l),m(e,n),m(e,r),m(e,o),m(o,c)},p(t,e){2&e&&i!==(i=t[8].from+"")&&_(n,i),2&e&&a!==(a=t[8].url+"")&&_(c,a),2&e&&l!==(l=t[8].url)&&A(o,"href",l)},d(t){t&&$(e)}}}function qe(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Ue,then:Me,catch:Re,value:11,error:12,blocks:[,,,]};return Q(n=t[2],o),{c(){e=x(),o.block.c()},m(t,n){g(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&Q(n,o)||Z(o,t,r)},i(t){r||(X(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)J(o.blocks[t]);r=!1},d(t){t&&$(e),o.block.d(t),o.token=null,o=null}}}function ze(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,c){function l(t){try{a(r.next(t))}catch(t){c(t)}}function i(t){try{a(r.throw(t))}catch(t){c(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,i)}a((r=r.apply(t,e||[])).next())}))};let o,{bookData:c}=e,{goNext:l}=e,i=[];const a=()=>r(void 0,void 0,void 0,(function*(){for(o=c.chapters.map((t=>Object.assign({},t)));;){let t=o[o.length-1];if(!1!==t.needsFetching){const e=yield $t(t.url),n=yield e.json();if(!e.ok)throw n.message;o.splice(-1,1,t=Et(n))}const e=Nt(t.content);if(!e)break;const r=vt(e);if(o.find((t=>t.url===r)))break;i.push({from:t.title,url:e}),n(1,i);const c=yield $t(r),l=yield c.json();if(!c.ok)throw l.message;o.push(Et(l))}return Object.assign(Object.assign({},c),{chapters:o})}));let s=a();return t.$$set=t=>{"bookData"in t&&n(4,c=t.bookData),"goNext"in t&&n(0,l=t.goNext)},[l,i,s,a,c,()=>n(2,s=a())]}const Ye=class extends ct{constructor(t){super(),ot(this,t,ze,qe,c,{bookData:4,goNext:0})}};function We(t,e,n){const r=t.slice();return r[7]=e[n],r}function Ke(t){let e,n;return e=new Ft({props:{error:t[11],retry:t[5]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[11]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Ge(e){let n,r=e[0](e[10])+"";return{c(){n=w(r)},m(t,e){g(t,n,e)},p(t,e){5&e&&r!==(r=t[0](t[10])+"")&&_(n,r)},i:t,o:t,d(t){t&&$(n)}}}function Ve(t){let e,n,r,o;e=new Ut({props:{$$slots:{default:[Xe]},$$scope:{ctx:t}}});let c=t[1],l=[];for(let e=0;e<c.length;e+=1)l[e]=Qe(We(t,c,e));return{c(){et(e.$$.fragment),n=k(),r=v("div");for(let t=0;t<l.length;t+=1)l[t].c();A(r,"class","chapters svelte-ljz7v6")},m(t,c){nt(e,t,c),g(t,n,c),g(t,r,c);for(let t=0;t<l.length;t+=1)l[t].m(r,null);o=!0},p(t,n){const o={};if(4096&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),2&n){let e;for(c=t[1],e=0;e<c.length;e+=1){const o=We(t,c,e);l[e]?l[e].p(o,n):(l[e]=Qe(o),l[e].c(),l[e].m(r,null))}for(;e<l.length;e+=1)l[e].d(1);l.length=c.length}},i(t){o||(X(e.$$.fragment,t),o=!0)},o(t){J(e.$$.fragment,t),o=!1},d(t){rt(e,t),t&&$(n),t&&$(r),b(l,t)}}}function Xe(t){let e;return{c(){e=w("Please wait, fetching chapters...")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function Je(t){let e,n,r=t[7].title+"";return{c(){e=v("p"),n=w(r),A(e,"class","valid small svelte-ljz7v6")},m(t,r){g(t,e,r),m(e,n)},p(t,e){2&e&&r!==(r=t[7].title+"")&&_(n,r)},d(t){t&&$(e)}}}function Qe(t){let e,n=t[7]&&Je(t);return{c(){n&&n.c(),e=x()},m(t,r){n&&n.m(t,r),g(t,e,r)},p(t,r){t[7]?n?n.p(t,r):(n=Je(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&$(e)}}}function Ze(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Ve,then:Ge,catch:Ke,value:10,error:11,blocks:[,,,]};return Q(n=t[2],o),{c(){e=x(),o.block.c()},m(t,n){g(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&Q(n,o)||Z(o,t,r)},i(t){r||(X(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)J(o.blocks[t]);r=!1},d(t){t&&$(e),o.block.d(t),o.token=null,o=null}}}function tn(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,c){function l(t){try{a(r.next(t))}catch(t){c(t)}}function i(t){try{a(r.throw(t))}catch(t){c(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,i)}a((r=r.apply(t,e||[])).next())}))};let o,{data:c}=e,{goNext:l}=e;const i=()=>r(void 0,void 0,void 0,(function*(){n(1,o=new Array(c.chapters.length));for(let t=0;t<c.chapters.length;t+=100)yield Promise.all(c.chapters.slice(t,t+100).map(((e,r)=>!1!==e.needsFetching?$t(e.url).then((t=>t.json())).then((e=>{n(1,o[r+t]=Et(e),o),n(1,o)})):void n(1,o[r+t]=Object.assign({},e),o))));return Object.assign(Object.assign({},c),{chapters:o})}));let a=i();return t.$$set=t=>{"data"in t&&n(4,c=t.data),"goNext"in t&&n(0,l=t.goNext)},[l,o,a,i,c,()=>n(2,a=i())]}const en=class extends ct{constructor(t){super(),ot(this,t,tn,Ze,c,{data:4,goNext:0})}};var nn=i(4785),rn=i.n(nn);function on(t,e,n){const r=t.slice();return r[9]=e[n][0],r[10]=e[n][1],r}function cn(t,e,n){const r=t.slice();return r[9]=e[n][0],r[10]=e[n][1],r}function ln(t){let e,n,r,o;return e=new Ft({props:{error:t[16],retry:t[6]}}),r=new te({props:{backToSearch:t[1]}}),{c(){et(e.$$.fragment),n=k(),et(r.$$.fragment)},m(t,c){nt(e,t,c),g(t,n,c),nt(r,t,c),o=!0},p(t,n){const o={};8&n&&(o.error=t[16]),8&n&&(o.retry=t[6]),e.$set(o);const c={};2&n&&(c.backToSearch=t[1]),r.$set(c)},i(t){o||(X(e.$$.fragment,t),X(r.$$.fragment,t),o=!0)},o(t){J(e.$$.fragment,t),J(r.$$.fragment,t),o=!1},d(t){rt(e,t),t&&$(n),rt(r,t)}}}function an(t){let e,n,r,o,c,l,i,a,s,u,f=t[2].find(gn);function d(){return t[5](t[13])}c=new te({props:{backToSearch:t[1]}});let h=f&&sn(t);return{c(){e=v("h3"),e.textContent="Your ebook is ready!",n=k(),r=v("button"),r.textContent="Download",o=k(),et(c.$$.fragment),l=k(),h&&h.c(),i=x(),A(e,"class","valid svelte-htfjwx")},m(t,f){g(t,e,f),g(t,n,f),g(t,r,f),g(t,o,f),nt(c,t,f),g(t,l,f),h&&h.m(t,f),g(t,i,f),a=!0,s||(u=T(r,"click",d),s=!0)},p(e,n){t=e;const r={};2&n&&(r.backToSearch=t[1]),c.$set(r),4&n&&(f=t[2].find(gn)),f?h?h.p(t,n):(h=sn(t),h.c(),h.m(i.parentNode,i)):h&&(h.d(1),h=null)},i(t){a||(X(c.$$.fragment,t),a=!0)},o(t){J(c.$$.fragment,t),a=!1},d(t){t&&$(e),t&&$(n),t&&$(r),t&&$(o),rt(c,t),t&&$(l),h&&h.d(t),t&&$(i),s=!1,u()}}}function sn(t){let e,n=t[2],r=[];for(let e=0;e<n.length;e+=1)r[e]=fn(on(t,n,e));return{c(){e=v("div");for(let t=0;t<r.length;t+=1)r[t].c();A(e,"class","logs svelte-htfjwx")},m(t,n){g(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(4&o){let c;for(n=t[2],c=0;c<n.length;c+=1){const l=on(t,n,c);r[c]?r[c].p(l,o):(r[c]=fn(l),r[c].c(),r[c].m(e,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(t){t&&$(e),b(r,t)}}}function un(t){let e,n,r=t[10]+"";return{c(){e=v("p"),n=w(r),A(e,"class","small warning svelte-htfjwx")},m(t,r){g(t,e,r),m(e,n)},p(t,e){4&e&&r!==(r=t[10]+"")&&_(n,r)},d(t){t&&$(e)}}}function fn(t){let e,n="warn"===t[9]&&un(t);return{c(){n&&n.c(),e=x()},m(t,r){n&&n.m(t,r),g(t,e,r)},p(t,r){"warn"===t[9]?n?n.p(t,r):(n=un(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&$(e)}}}function dn(t){let e,n,r,o;e=new Ut({props:{$$slots:{default:[hn]},$$scope:{ctx:t}}});let c=t[2],l=[];for(let e=0;e<c.length;e+=1)l[e]=pn(cn(t,c,e));return{c(){et(e.$$.fragment),n=k(),r=v("div");for(let t=0;t<l.length;t+=1)l[t].c();A(r,"class","logs svelte-htfjwx")},m(t,c){nt(e,t,c),g(t,n,c),g(t,r,c);for(let t=0;t<l.length;t+=1)l[t].m(r,null);o=!0},p(t,n){const o={};if(131072&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),4&n){let e;for(c=t[2],e=0;e<c.length;e+=1){const o=cn(t,c,e);l[e]?l[e].p(o,n):(l[e]=pn(o),l[e].c(),l[e].m(r,null))}for(;e<l.length;e+=1)l[e].d(1);l.length=c.length}},i(t){o||(X(e.$$.fragment,t),o=!0)},o(t){J(e.$$.fragment,t),o=!1},d(t){rt(e,t),t&&$(n),t&&$(r),b(l,t)}}}function hn(t){let e;return{c(){e=w("Please wait, generating ebook...")},m(t,n){g(t,e,n)},d(t){t&&$(e)}}}function pn(t){let e,n,r=t[10]+"";return{c(){e=v("p"),n=w(r),A(e,"class","small svelte-htfjwx"),N(e,"warning","warn"===t[9])},m(t,r){g(t,e,r),m(e,n)},p(t,o){4&o&&r!==(r=t[10]+"")&&_(n,r),4&o&&N(e,"warning","warn"===t[9])},d(t){t&&$(e)}}}function mn(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:dn,then:an,catch:ln,value:13,error:16,blocks:[,,,]};return Q(n=t[3],o),{c(){e=x(),o.block.c()},m(t,n){g(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,8&r&&n!==(n=t[3])&&Q(n,o)||Z(o,t,r)},i(t){r||(X(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)J(o.blocks[t]);r=!1},d(t){t&&$(e),o.block.d(t),o.token=null,o=null}}}const gn=([t])=>"warn"===t;function $n(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,c){function l(t){try{a(r.next(t))}catch(t){c(t)}}function i(t){try{a(r.throw(t))}catch(t){c(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,i)}a((r=r.apply(t,e||[])).next())}))};let{data:o}=e,{backToSearch:c}=e;const l=Promise.all([i.e(199),i.e(483)]).then(i.t.bind(i,3199,23));let a=[];const s=()=>r(void 0,void 0,void 0,(function*(){n(2,a=[]);const{default:t}=yield l;return yield t({title:wt(o.title),author:wt(o.author),ignoreFailedDownloads:!0,verbose:(t,e,...r)=>{a.push([t,e]),n(2,a)}},o.chapters.map((t=>({title:wt(t.title),content:t.content,url:yt(t.url)}))))}));let u=s();return t.$$set=t=>{"data"in t&&n(0,o=t.data),"backToSearch"in t&&n(1,c=t.backToSearch)},[o,c,a,u,s,t=>rn()(t,`${wt(o.author)} - ${wt(o.title)}.epub`,"application/epub+zip"),()=>n(3,u=s())]}const bn=class extends ct{constructor(t){super(),ot(this,t,$n,mn,c,{data:0,backToSearch:1})}};function vn(t){let e,n;return e=new bn({props:{data:t[4],backToSearch:t[6]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};16&n&&(r.data=t[4]),64&n&&(r.backToSearch=t[6]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function yn(t){let e,n;return e=new en({props:{goNext:t[16],data:t[4]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};51&n&&(r.goNext=t[16]),16&n&&(r.data=t[4]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function wn(t){let e,n;return e=new Ye({props:{goNext:t[15],bookData:t[4]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};51&n&&(r.goNext=t[15]),16&n&&(r.bookData=t[4]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function kn(t){let e,n;return e=new Le({props:{goNext:t[14],bookData:t[4]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};51&n&&(r.goNext=t[14]),16&n&&(r.bookData=t[4]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function xn(t){let e,n;return e=new Se({props:{goNext:t[10],series:t[3],bookData:t[4],newChapters:t[5],backToSearch:t[6],edit:t[11],findMore:t[12],downloadAll:t[13]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};19&n&&(r.goNext=t[10]),8&n&&(r.series=t[3]),16&n&&(r.bookData=t[4]),32&n&&(r.newChapters=t[5]),64&n&&(r.backToSearch=t[6]),19&n&&(r.edit=t[11]),19&n&&(r.findMore=t[12]),19&n&&(r.downloadAll=t[13]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Tn(t){let e,n;return e=new Xt({props:{goNext:t[9],search:t[2]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};11&n&&(r.goNext=t[9]),4&n&&(r.search=t[2]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Sn(t){let e,n;return e=new Ht({props:{goNext:t[7],search:t[2]}}),{c(){et(e.$$.fragment)},m(t,r){nt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.search=t[2]),e.$set(r)},i(t){n||(X(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){rt(e,t)}}}function Cn(e){let n,r,o,c,l;return{c(){n=v("div"),r=k(),o=v("a"),o.textContent="Go back home",A(o,"href","#?"),A(o,"class","homelink svelte-1kaj6z6")},m(t,i){g(t,n,i),g(t,r,i),g(t,o,i),c||(l=T(o,"click",S(e[17])),c=!0)},p:t,d(t){t&&$(n),t&&$(r),t&&$(o),c=!1,l()}}}function An(t){let e,n,r,o,c,l,i,a,s,u;n=new ft({});const f=[Sn,Tn,xn,kn,wn,yn,vn],d=[];function h(t,e){return t[1]===t[0].INPUT?0:t[1]===t[0].SEARCH?1:t[1]===t[0].BOOK_DATA?2:t[1]===t[0].EDIT_DATA?3:t[1]===t[0].FIND_CHAPTERS?4:t[1]===t[0].DOWNLOAD_CHAPTERS?5:t[1]===t[0].RESULT?6:-1}~(c=h(t))&&(l=d[c]=f[c](t));let p=t[1]!==t[0].INPUT&&Cn(t);return s=new st({}),{c(){e=v("div"),et(n.$$.fragment),r=k(),o=v("main"),l&&l.c(),i=k(),p&&p.c(),a=k(),et(s.$$.fragment),A(o,"class","App-main"),A(e,"class","App svelte-1kaj6z6")},m(t,l){g(t,e,l),nt(n,e,null),m(e,r),m(e,o),~c&&d[c].m(o,null),m(o,i),p&&p.m(o,null),m(e,a),nt(s,e,null),u=!0},p(t,[e]){let n=c;c=h(t),c===n?~c&&d[c].p(t,e):(l&&(G(),J(d[n],1,1,(()=>{d[n]=null})),V()),~c?(l=d[c],l?l.p(t,e):(l=d[c]=f[c](t),l.c()),X(l,1),l.m(o,i)):l=null),t[1]!==t[0].INPUT?p?p.p(t,e):(p=Cn(t),p.c(),p.m(o,null)):p&&(p.d(1),p=null)},i(t){u||(X(n.$$.fragment,t),X(l),X(s.$$.fragment,t),u=!0)},o(t){J(n.$$.fragment,t),J(l),J(s.$$.fragment,t),u=!1},d(t){t&&$(e),rt(n),~c&&d[c].d(),p&&p.d(),rt(s)}}}function _n(t,e,n){var r;!function(t){t[t.INPUT=0]="INPUT",t[t.SEARCH=1]="SEARCH",t[t.BOOK_DATA=2]="BOOK_DATA",t[t.EDIT_DATA=3]="EDIT_DATA",t[t.FIND_CHAPTERS=4]="FIND_CHAPTERS",t[t.DOWNLOAD_CHAPTERS=5]="DOWNLOAD_CHAPTERS",t[t.RESULT=6]="RESULT"}(r||(r={}));let o,c,l,i,a,s=r.INPUT,u=!1;return t.$$.update=()=>{257&t.$$.dirty&&n(6,a=u?()=>n(1,s=r.SEARCH):void 0),t.$$.dirty,3&t.$$.dirty&&(s!==r.INPUT&&s!==r.SEARCH||(n(4,l=void 0),n(5,i=void 0)))},[r,s,o,c,l,i,a,t=>{const e=function(t){try{if(new URL(t),function(t){return!!t.match(At)}(t))return ht.HFY_SERIES;if(function(t){return!!t.match(_t)}(t))return ht.POST}catch(t){}return ht.SEARCH}(t);return n(2,o=t),n(8,u=e===ht.SEARCH),e!==ht.SEARCH&&n(3,c={url:vt(t),type:e}),e===ht.SEARCH?n(1,s=r.SEARCH):n(1,s=r.BOOK_DATA)},u,t=>(n(3,c=t),n(1,s=r.BOOK_DATA)),t=>(n(4,l=t),n(1,s=r.RESULT)),t=>(n(4,l=t),n(1,s=r.EDIT_DATA)),t=>(n(4,l=t),n(1,s=r.FIND_CHAPTERS)),t=>(n(4,l=t),n(1,s=r.DOWNLOAD_CHAPTERS)),t=>(n(4,l=t),n(5,i=void 0),n(1,s=r.BOOK_DATA)),(t,e)=>(n(4,l=t),n(5,i=e),n(1,s=r.BOOK_DATA)),t=>(n(4,l=t),n(5,i=void 0),n(1,s=r.BOOK_DATA)),()=>n(1,s=r.INPUT)]}const En=class extends ct{constructor(t){super(),ot(this,t,_n,An,c,{})}};let Nn;try{Nn=new En({target:document.body})}catch(t){const e=document.createElement("div");e.className="fatal-error",e.ariaLabel="error",e.appendChild(document.createElement("h1")).textContent="Something went wrong:",e.appendChild(document.createElement("code")).textContent=t,document.body.appendChild(e)}})(),a=i.O(a)})();