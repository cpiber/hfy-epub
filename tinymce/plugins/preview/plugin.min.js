!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const r=e=>()=>e,t=r(!1);class n{constructor(e,r){this.tag=e,this.value=r}static some(e){return new n(!0,e)}static none(){return n.singletonNone}fold(e,r){return this.tag?r(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?n.some(e(this.value)):n.none()}bind(e){return this.tag?e(this.value):n.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:n.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return null==e?n.none():n.some(e)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}n.singletonNone=new n(!1);const s=(e,r)=>((e,r,t)=>{for(let s=0,i=e.length;s<i;s++){const i=e[s];if(r(i,s))return n.some(i);if(t(i,s))break}return n.none()})(e,r,t),i=(e,r,t=0,n)=>{const s=e.indexOf(r,t);return-1!==s&&(!!(e=>void 0===e)(n)||s+r.length<=n)},o=()=>a(0,0),a=(e,r)=>({major:e,minor:r}),c={nu:a,detect:(e,r)=>{const t=String(r).toLowerCase();return 0===e.length?o():((e,r)=>{const t=((e,r)=>{for(let t=0;t<e.length;t++){const n=e[t];if(n.test(r))return n}})(e,r);if(!t)return{major:0,minor:0};const n=e=>Number(r.replace(t,"$"+e));return a(n(1),n(2))})(e,t)},unknown:o},u=(e,r)=>{const t=String(r).toLowerCase();return s(e,e=>e.search(t))},l=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,d=e=>r=>i(r,e),h=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>i(e,"edge/")&&i(e,"chrome")&&i(e,"safari")&&i(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,l],search:e=>i(e,"chrome")&&!i(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>i(e,"msie")||i(e,"trident")},{name:"Opera",versionRegexes:[l,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:d("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:d("firefox")},{name:"Safari",versionRegexes:[l,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(i(e,"safari")||i(e,"mobile/"))&&i(e,"applewebkit")}],m=[{name:"Windows",search:d("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>i(e,"iphone")||i(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:d("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:d("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:d("linux"),versionRegexes:[]},{name:"Solaris",search:d("sunos"),versionRegexes:[]},{name:"FreeBSD",search:d("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:d("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],v={browsers:r(h),oses:r(m)},g="Edge",p="Chromium",f="Opera",w="Firefox",x="Safari",S=e=>{const r=e.current,t=e.version,n=e=>()=>r===e;return{current:r,version:t,isEdge:n(g),isChromium:n(p),isIE:n("IE"),isOpera:n(f),isFirefox:n(w),isSafari:n(x)}},y=()=>S({current:void 0,version:c.unknown()}),b=S,O=(r(g),r(p),r("IE"),r(f),r(w),r(x),"Windows"),R="Android",C="Linux",A="macOS",k="Solaris",D="FreeBSD",E="ChromeOS",I=e=>{const r=e.current,t=e.version,n=e=>()=>r===e;return{current:r,version:t,isWindows:n(O),isiOS:n("iOS"),isAndroid:n(R),isMacOS:n(A),isLinux:n(C),isSolaris:n(k),isFreeBSD:n(D),isChromeOS:n(E)}},P=()=>I({current:void 0,version:c.unknown()}),T=I,_=(r(O),r("iOS"),r(R),r(C),r(A),r(k),r(D),r(E),(e,t,i)=>{const o=v.browsers(),a=v.oses(),l=t.bind(e=>((e,r)=>((e,r)=>{for(let t=0;t<e.length;t++){const n=r(e[t]);if(n.isSome())return n}return n.none()})(r.brands,r=>{const t=r.brand.toLowerCase();return s(e,e=>{var r;return t===(null===(r=e.brand)||void 0===r?void 0:r.toLowerCase())}).map(e=>({current:e.name,version:c.nu(parseInt(r.version,10),0)}))}))(o,e)).orThunk(()=>((e,r)=>u(e,r).map(e=>{const t=c.detect(e.versionRegexes,r);return{current:e.name,version:t}}))(o,e)).fold(y,b),d=((e,r)=>u(e,r).map(e=>{const t=c.detect(e.versionRegexes,r);return{current:e.name,version:t}}))(a,e).fold(P,T),h=((e,t,n,s)=>{const i=e.isiOS()&&!0===/ipad/i.test(n),o=e.isiOS()&&!i,a=e.isiOS()||e.isAndroid(),c=a||s("(pointer:coarse)"),u=i||!o&&a&&s("(min-device-width:768px)"),l=o||a&&!u,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),h=!l&&!u&&!d;return{isiPad:r(i),isiPhone:r(o),isTablet:r(u),isPhone:r(l),isTouch:r(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(d),isDesktop:r(h)}})(d,l,e,i);return{browser:l,os:d,deviceType:h}}),B=e=>window.matchMedia(e).matches;let L=(e=>{let r,t=!1;return(...n)=>(t||(t=!0,r=e.apply(null,n)),r)})(()=>_(window.navigator.userAgent,n.from(window.navigator.userAgentData),B));const N=()=>L();var F=tinymce.util.Tools.resolve("tinymce.util.Tools");const M=e=>r=>r.options.get(e),$=M("content_style"),W=M("content_css_cors"),U=M("body_class"),K=M("body_id");e.add("preview",e=>{(e=>{e.addCommand("mcePreview",()=>{(e=>{const r=(e=>{var r;let t="";const n=e.dom.encode,s=null!==(r=$(e))&&void 0!==r?r:"";t+=`<base href="${n(e.documentBaseURI.getURI())}">`;const i=W(e)?' crossorigin="anonymous"':"";F.each(e.contentCSS,r=>{t+='<link type="text/css" rel="stylesheet" href="'+n(e.documentBaseURI.toAbsolute(r))+'"'+i+">"}),s&&(t+='<style type="text/css">'+s+"</style>");const o=K(e),a=U(e),c=e.getBody().dir,u=c?' dir="'+n(c)+'"':"";return"<!DOCTYPE html><html><head>"+t+'</head><body id="'+n(o)+'" class="mce-content-body '+n(a)+'"'+u+">"+e.getContent()+(()=>{const e=N().os.isMacOS()||N().os.isiOS();return`<script>(${(e=>{document.addEventListener("click",r=>{for(let t=r.target;t;t=t.parentNode)if("A"===t.nodeName){const n=t.getAttribute("href");if(n&&n.startsWith("#")){r.preventDefault();const e=document.getElementById(n.substring(1));return void(e&&e.scrollIntoView({behavior:"smooth"}))}(e?r.metaKey:r.ctrlKey&&!r.altKey)||r.preventDefault()}},!1)}).toString()})(${e})<\/script>`})()+"</body></html>"})(e);e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0,transparent:!1}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:r}}).focus("close")})(e)})})(e),(e=>{const r=()=>e.execCommand("mcePreview");e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:r,context:"any"}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:r,context:"any"})})(e)})}();