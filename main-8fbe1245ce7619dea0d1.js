(()=>{var t,e,n,r,o,i={4785:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){return function t(e,n,r){var o,i,s=window,l="application/octet-stream",c=r||l,a=e,u=!n&&!r&&a,d=document.createElement("a"),f=function(t){return String(t)},p=s.Blob||s.MozBlob||s.WebKitBlob||f,h=n||"download";if(p=p.call?p.bind(s):Blob,"true"===String(this)&&(c=(a=[a,c])[0],a=a[1]),u&&u.length<2048&&(h=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(e){t(e.target.response,h,l)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(a)){if(!(a.length>2096103.424&&p!==f))return navigator.msSaveBlob?navigator.msSaveBlob(v(a),h):$(a);c=(a=v(a)).type||l}else if(/([\x80-\xff])/.test(a)){for(var g=0,b=new Uint8Array(a.length),y=b.length;g<y;++g)b[g]=a.charCodeAt(g);a=new p([b],{type:c})}function v(t){for(var e=t.split(/[:;,]/),n=e[1],r=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=r.length,i=0,s=new Uint8Array(o);i<o;++i)s[i]=r.charCodeAt(i);return new p([s],{type:n})}function $(t,e){if("download"in d)return d.href=t,d.setAttribute("download",h),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){s.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=a instanceof p?a:new p([a],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,h);if(s.URL)$(s.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===f)try{return $("data:"+c+";base64,"+s.btoa(o))}catch(t){return $("data:"+c+","+encodeURIComponent(o))}(i=new FileReader).onload=function(t){$(this.result)},i.readAsDataURL(o)}return!0}})?n.apply(e,[]):n)||(t.exports=r)}},s={};function l(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={id:t,loaded:!1,exports:{}};return i[t].call(n.exports,n,n.exports,l),n.loaded=!0,n.exports}l.m=i,t=[],l.O=(e,n,r,o)=>{if(!n){var i=1/0;for(u=0;u<t.length;u++){for(var[n,r,o]=t[u],s=!0,c=0;c<n.length;c++)(!1&o||i>=o)&&Object.keys(l.O).every((t=>l.O[t](n[c])))?n.splice(c--,1):(s=!1,o<i&&(i=o));if(s){t.splice(u--,1);var a=r();void 0!==a&&(e=a)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[n,r,o]},l.F={},l.E=t=>{Object.keys(l.F).map((e=>{l.F[e](t)}))},l.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return l.d(e,{a:e}),e},n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,l.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var o=Object.create(null);l.r(o);var i={};e=e||[null,n({}),n([]),n(n)];for(var s=2&r&&t;"object"==typeof s&&!~e.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,l.d(o,i),o},l.d=(t,e)=>{for(var n in e)l.o(e,n)&&!l.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},l.f={},l.e=t=>Promise.all(Object.keys(l.f).reduce(((e,n)=>(l.f[n](t,e),e)),[])),l.u=t=>t+"-"+{483:"b16e761eeea558a434ed",845:"a056142dc4484a8dd051"}[t]+".js",l.miniCssF=t=>"main-8fbe1245ce7619dea0d1.css",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),l.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},o="hfy-epub:",l.l=(t,e,n,i)=>{if(r[t])r[t].push(e);else{var s,c;if(void 0!==n)for(var a=document.getElementsByTagName("script"),u=0;u<a.length;u++){var d=a[u];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==o+n){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,l.nc&&s.setAttribute("nonce",l.nc),s.setAttribute("data-webpack",o+n),s.src=t),r[t]=[e];var f=(e,n)=>{s.onerror=s.onload=null,clearTimeout(p);var o=r[t];if(delete r[t],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((t=>t(n))),e)return e(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}},l.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;l.g.importScripts&&(t=l.g.location+"");var e=l.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=t})(),(()=>{var t={179:0};l.f.j=(e,n)=>{var r=l.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=t[e]=[n,o]));n.push(r[2]=o);var i=l.p+l.u(e),s=new Error;l.l(i,(n=>{if(l.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,r[1](s)}}),"chunk-"+e,e)}},l.F.j=e=>{if(!l.o(t,e)||void 0===t[e]){t[e]=null;var n=document.createElement("link");l.nc&&n.setAttribute("nonce",l.nc),n.rel="prefetch",n.as="script",n.href=l.p+l.u(e),document.head.appendChild(n)}},l.O.j=e=>0===t[e];var e=(e,n)=>{var r,o,[i,s,c]=n,a=0;if(i.some((e=>0!==t[e]))){for(r in s)l.o(s,r)&&(l.m[r]=s[r]);if(c)var u=c(l)}for(e&&e(n);a<i.length;a++)o=i[a],l.o(t,o)&&t[o]&&t[o][0](),t[i[a]]=0;return l.O(u)},n=self.webpackChunkhfy_epub=self.webpackChunkhfy_epub||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),l.O(0,[179],(()=>{l.E(845),l.E(483)}),5);var c={};(()=>{"use strict";function t(){}const e=t=>t;function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t){return 0===Object.keys(t).length}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t,e,n,r){if(t){const o=d(t,e,n,r);return t[0](o)}}function d(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function f(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function p(t,e,n,r,o,i){if(o){const s=d(e,n,r,i);t.p(s,o)}}function h(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}const m="undefined"!=typeof window;let g=m?()=>window.performance.now():()=>Date.now(),b=m?t=>requestAnimationFrame(t):t;const y=new Set;function v(t){y.forEach((e=>{e.c(t)||(y.delete(e),e.f())})),0!==y.size&&b(v)}let $=!1;function w(t,e){t.appendChild(e)}function x(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function k(t,e,n){t.insertBefore(e,n||null)}function E(t){t.parentNode.removeChild(t)}function T(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function S(t){return document.createElement(t)}function C(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function D(t){return document.createTextNode(t)}function A(){return D(" ")}function O(){return D("")}function _(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function L(t){return function(e){return e.preventDefault(),t.call(this,e)}}function N(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function M(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function P(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function F(t,e){t.value=null==e?"":e}function j(t,e,n){t.classList[n?"add":"remove"](e)}const R=new Set;let U,H=0;function B(t,e,n,r,o,i,s,l=0){const c=16.666/r;let a="{\n";for(let t=0;t<=1;t+=c){const r=e+(n-e)*i(t);a+=100*t+`%{${s(r,1-r)}}\n`}const u=a+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,f=x(t);R.add(f);const p=f.__svelte_stylesheet||(f.__svelte_stylesheet=function(t){const e=S("style");return function(t,e){w(t.head||t,e)}(x(t),e),e}(t).sheet),h=f.__svelte_rules||(f.__svelte_rules={});h[d]||(h[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${d} ${r}ms linear ${o}ms 1 both`,H+=1,d}function I(t){U=t}function z(){if(!U)throw new Error("Function called outside component initialization");return U}function W(t){z().$$.on_destroy.push(t)}const q=[],Y=[],K=[],G=[],V=Promise.resolve();let X=!1;function Z(t){K.push(t)}function J(t){G.push(t)}let Q=!1;const tt=new Set;function et(){if(!Q){Q=!0;do{for(let t=0;t<q.length;t+=1){const e=q[t];I(e),nt(e.$$)}for(I(null),q.length=0;Y.length;)Y.pop()();for(let t=0;t<K.length;t+=1){const e=K[t];tt.has(e)||(tt.add(e),e())}K.length=0}while(q.length);for(;G.length;)G.pop()();X=!1,Q=!1,tt.clear()}}function nt(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Z)}}const rt=new Set;let ot,it;function st(){ot={r:0,c:[],p:ot}}function lt(){ot.r||o(ot.c),ot=ot.p}function ct(t,e){t&&t.i&&(rt.delete(t),t.i(e))}function at(t,e,n,r){if(t&&t.o){if(rt.has(t))return;rt.add(t),ot.c.push((()=>{rt.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function ut(t,e){const n=e.token={};function r(t,r,o,i){if(e.token!==n)return;e.resolved=i;let s=e.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const l=t&&(e.current=t)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(st(),at(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),lt())})):e.block.d(1),l.c(),ct(l,1),l.m(e.mount(),e.anchor),c=!0),e.block=l,e.blocks&&(e.blocks[r]=l),c&&et()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=z();if(t.then((t=>{I(n),r(e.then,1,e.value,t),I(null)}),(t=>{if(I(n),r(e.catch,2,e.error,t),I(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function dt(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}function ft(t,e){t.d(1),e.delete(t.key)}function pt(t,e){t.f(),function(t,e){at(t,1,1,(()=>{e.delete(t.key)}))}(t,e)}function ht(t,e,n,r,o,i,s,l,c,a,u,d){let f=t.length,p=i.length,h=f;const m={};for(;h--;)m[t[h].key]=h;const g=[],b=new Map,y=new Map;for(h=p;h--;){const t=d(o,i,h),l=n(t);let c=s.get(l);c?r&&c.p(t,e):(c=a(l,t),c.c()),b.set(l,g[h]=c),l in m&&y.set(l,Math.abs(h-m[l]))}const v=new Set,$=new Set;function w(t){ct(t,1),t.m(l,u),s.set(t.key,t),u=t.first,p--}for(;f&&p;){const e=g[p-1],n=t[f-1],r=e.key,o=n.key;e===n?(u=e.first,f--,p--):b.has(o)?!s.has(r)||v.has(r)?w(e):$.has(o)?f--:y.get(r)>y.get(o)?($.add(r),w(e)):(v.add(o),f--):(c(n,s),f--)}for(;f--;){const e=t[f];b.has(e.key)||c(e,s)}for(;p;)w(g[p-1]);return g}function mt(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function gt(t){t&&t.c()}function bt(t,e,r,s){const{fragment:l,on_mount:c,on_destroy:a,after_update:u}=t.$$;l&&l.m(e,r),s||Z((()=>{const e=c.map(n).filter(i);a?a.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(Z)}function yt(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function vt(e,n,i,s,l,c,a,u=[-1]){const d=U;I(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:n.context||[]),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(f.root);let p=!1;if(f.ctx=i?i(e,n.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&function(t,e){-1===t.$$.dirty[0]&&(q.push(t),X||(X=!0,V.then(et)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],f.update(),p=!0,o(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){$=!0;const t=(h=n.target,Array.from(h.childNodes));f.fragment&&f.fragment.l(t),t.forEach(E)}else f.fragment&&f.fragment.c();n.intro&&ct(e.$$.fragment),bt(e,n.target,n.anchor,n.customElement),$=!1,et()}var h;I(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(it=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(n).filter(i);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){yt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class $t{$destroy(){yt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var wt,xt=function(){return xt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},xt.apply(this,arguments)},kt=function(t){return t instanceof URL||(t=new URL(t)),t.hostname="api.reddit.com",t.pathname.endsWith("/")?t.pathname=t.pathname.slice(0,t.pathname.length-1)+".json":t.pathname.endsWith(".json")||(t.pathname+=".json"),t.protocol="https",t.search="",t.hash="",t.toString()},Et=function(t){return t.slice(0,-5).replace("https://api","https://www")},Tt=(wt=new DOMParser,function(t){return wt.parseFromString(t,"text/html").documentElement.textContent}),St=function(t){return xt(xt({},t),{chapters:t.chapters.map((function(t){return xt({},t)}))})},Ct=l(4785),Dt=l.n(Ct);function At(t){let e,n,r;return{c(){e=S("a"),e.textContent="Back to Search",M(e,"href","#search"),M(e,"class","small")},m(o,s){k(o,e,s),n||(r=_(e,"click",L((function(){i(t[0])&&t[0].apply(this,arguments)}))),n=!0)},p(e,n){t=e},d(t){t&&E(e),n=!1,r()}}}function Ot(e){let n,r=e[0]&&At(e);return{c(){r&&r.c(),n=O()},m(t,e){r&&r.m(t,e),k(t,n,e)},p(t,[e]){t[0]?r?r.p(t,e):(r=At(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&E(n)}}}function _t(t,e,n){let{backToSearch:r}=e;return t.$$set=t=>{"backToSearch"in t&&n(0,r=t.backToSearch)},[r]}const Lt=class extends $t{constructor(t){super(),vt(this,t,_t,Ot,s,{backToSearch:0})}};function Nt(e){let n,r,o,s,l,c,a,u,d=e[0]?": ":"",f=(e[0].message||e[0])+"";return{c(){n=S("p"),r=D("Sorry, can't process that"),o=D(d),s=D(f),l=A(),c=S("button"),c.textContent="Retry",M(n,"class","error svelte-alvqhf")},m(t,d){k(t,n,d),w(n,r),w(n,o),w(n,s),k(t,l,d),k(t,c,d),a||(u=_(c,"click",(function(){i(e[1])&&e[1].apply(this,arguments)})),a=!0)},p(t,[n]){e=t,1&n&&d!==(d=e[0]?": ":"")&&P(o,d),1&n&&f!==(f=(e[0].message||e[0])+"")&&P(s,f)},i:t,o:t,d(t){t&&E(n),t&&E(l),t&&E(c),a=!1,u()}}}function Mt(t,e,n){let{error:r}=e,{retry:o}=e;return t.$$set=t=>{"error"in t&&n(0,r=t.error),"retry"in t&&n(1,o=t.retry)},[r,o]}const Pt=class extends $t{constructor(t){super(),vt(this,t,Mt,Nt,s,{error:0,retry:1})}};function Ft(t){let e,n,r,o,i;const s=t[1].default,l=u(s,t,t[0],null),c=l||function(t){let e;return{c(){e=D("Loading...")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}();return{c(){e=S("div"),n=S("div"),n.innerHTML='<span class="loading-slider svelte-1pmb758">â€¢</span>',r=A(),o=S("p"),c&&c.c(),M(n,"class","loading-slider-container svelte-1pmb758"),M(o,"class","loading svelte-1pmb758"),M(e,"class","loading-container svelte-1pmb758")},m(t,s){k(t,e,s),w(e,n),w(e,r),w(e,o),c&&c.m(o,null),i=!0},p(t,[e]){l&&l.p&&(!i||1&e)&&p(l,s,t,t[0],i?f(s,t[0],e,null):h(t[0]),null)},i(t){i||(ct(c,t),i=!0)},o(t){at(c,t),i=!1},d(t){t&&E(e),c&&c.d(t)}}}function jt(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}const Rt=class extends $t{constructor(t){super(),vt(this,t,jt,Ft,s,{})}};function Ut(t,e,n){const r=t.slice();return r[10]=e[n][0],r[11]=e[n][1],r}function Ht(t,e,n){const r=t.slice();return r[10]=e[n][0],r[11]=e[n][1],r}function Bt(t){let e,n,r,o,s,l,c,a;return e=new Pt({props:{error:t[17],retry:t[7]}}),s=new Lt({props:{backToSearch:t[1]}}),{c(){gt(e.$$.fragment),n=A(),r=S("button"),r.textContent="Back to book",o=A(),gt(s.$$.fragment)},m(u,d){bt(e,u,d),k(u,n,d),k(u,r,d),k(u,o,d),bt(s,u,d),l=!0,c||(a=_(r,"click",(function(){i(t[2])&&t[2].apply(this,arguments)})),c=!0)},p(n,r){t=n;const o={};16&r&&(o.error=t[17]),16&r&&(o.retry=t[7]),e.$set(o);const i={};2&r&&(i.backToSearch=t[1]),s.$set(i)},i(t){l||(ct(e.$$.fragment,t),ct(s.$$.fragment,t),l=!0)},o(t){at(e.$$.fragment,t),at(s.$$.fragment,t),l=!1},d(t){yt(e,t),t&&E(n),t&&E(r),t&&E(o),yt(s,t),c=!1,a()}}}function It(t){let e,n,r,s,l,c,a,u,d,f,p,h,m=t[3].find(Xt);function g(){return t[6](t[14])}a=new Lt({props:{backToSearch:t[1]}});let b=m&&zt(t);return{c(){e=S("h3"),e.textContent="Your e-book is ready!",n=A(),r=S("button"),r.textContent="Download",s=A(),l=S("button"),l.textContent="Back to book",c=A(),gt(a.$$.fragment),u=A(),b&&b.c(),d=O(),M(e,"class","valid svelte-1o8hxnt")},m(o,m){k(o,e,m),k(o,n,m),k(o,r,m),k(o,s,m),k(o,l,m),k(o,c,m),bt(a,o,m),k(o,u,m),b&&b.m(o,m),k(o,d,m),f=!0,p||(h=[_(r,"click",g),_(l,"click",(function(){i(t[2])&&t[2].apply(this,arguments)}))],p=!0)},p(e,n){t=e;const r={};2&n&&(r.backToSearch=t[1]),a.$set(r),8&n&&(m=t[3].find(Xt)),m?b?b.p(t,n):(b=zt(t),b.c(),b.m(d.parentNode,d)):b&&(b.d(1),b=null)},i(t){f||(ct(a.$$.fragment,t),f=!0)},o(t){at(a.$$.fragment,t),f=!1},d(t){t&&E(e),t&&E(n),t&&E(r),t&&E(s),t&&E(l),t&&E(c),yt(a,t),t&&E(u),b&&b.d(t),t&&E(d),p=!1,o(h)}}}function zt(t){let e,n=t[3],r=[];for(let e=0;e<n.length;e+=1)r[e]=qt(Ut(t,n,e));return{c(){e=S("div");for(let t=0;t<r.length;t+=1)r[t].c();M(e,"class","logs svelte-1o8hxnt")},m(t,n){k(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(8&o){let i;for(n=t[3],i=0;i<n.length;i+=1){const s=Ut(t,n,i);r[i]?r[i].p(s,o):(r[i]=qt(s),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(t){t&&E(e),T(r,t)}}}function Wt(t){let e,n,r=t[11]+"";return{c(){e=S("p"),n=D(r),M(e,"class","small warning svelte-1o8hxnt")},m(t,r){k(t,e,r),w(e,n)},p(t,e){8&e&&r!==(r=t[11]+"")&&P(n,r)},d(t){t&&E(e)}}}function qt(t){let e,n="warn"===t[10]&&Wt(t);return{c(){n&&n.c(),e=O()},m(t,r){n&&n.m(t,r),k(t,e,r)},p(t,r){"warn"===t[10]?n?n.p(t,r):(n=Wt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&E(e)}}}function Yt(t){let e,n,r,o;e=new Rt({props:{$$slots:{default:[Kt]},$$scope:{ctx:t}}});let i=t[3],s=[];for(let e=0;e<i.length;e+=1)s[e]=Gt(Ht(t,i,e));return{c(){gt(e.$$.fragment),n=A(),r=S("div");for(let t=0;t<s.length;t+=1)s[t].c();M(r,"class","logs svelte-1o8hxnt")},m(t,i){bt(e,t,i),k(t,n,i),k(t,r,i);for(let t=0;t<s.length;t+=1)s[t].m(r,null);o=!0},p(t,n){const o={};if(262144&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),8&n){let e;for(i=t[3],e=0;e<i.length;e+=1){const o=Ht(t,i,e);s[e]?s[e].p(o,n):(s[e]=Gt(o),s[e].c(),s[e].m(r,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){o||(ct(e.$$.fragment,t),o=!0)},o(t){at(e.$$.fragment,t),o=!1},d(t){yt(e,t),t&&E(n),t&&E(r),T(s,t)}}}function Kt(t){let e;return{c(){e=D("Please wait, generating e-book...")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function Gt(t){let e,n,r=t[11]+"";return{c(){e=S("p"),n=D(r),M(e,"class","small svelte-1o8hxnt"),j(e,"warning","warn"===t[10])},m(t,r){k(t,e,r),w(e,n)},p(t,o){8&o&&r!==(r=t[11]+"")&&P(n,r),8&o&&j(e,"warning","warn"===t[10])},d(t){t&&E(e)}}}function Vt(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Yt,then:It,catch:Bt,value:14,error:17,blocks:[,,,]};return ut(n=t[4],o),{c(){e=O(),o.block.c()},m(t,n){k(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,16&r&&n!==(n=t[4])&&ut(n,o)||dt(o,t,r)},i(t){r||(ct(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)at(o.blocks[t]);r=!1},d(t){t&&E(e),o.block.d(t),o.token=null,o=null}}}const Xt=([t])=>"warn"===t;function Zt(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function l(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,l)}c((r=r.apply(t,e||[])).next())}))};let{data:o}=e,{backToSearch:i}=e,{backToBook:s}=e;const c=Promise.all([l.e(845),l.e(483)]).then(l.t.bind(l,9845,23));let a=[];const u=()=>r(void 0,void 0,void 0,(function*(){n(3,a=[]);const{default:t}=yield c;return yield t({title:Tt(o.title),author:Tt(o.author),ignoreFailedDownloads:!0,verbose:(t,e,...r)=>{a.push([t,e]),n(3,a)}},o.chapters.map((t=>({title:Tt(t.title),content:t.content,url:t.displayUrl}))))}));let d=u();return t.$$set=t=>{"data"in t&&n(0,o=t.data),"backToSearch"in t&&n(1,i=t.backToSearch),"backToBook"in t&&n(2,s=t.backToBook)},[o,i,s,a,d,u,t=>Dt()(t,`${Tt(o.author)} - ${Tt(o.title)}.epub`,"application/epub+zip"),()=>n(4,d=u())]}const Jt=class extends $t{constructor(t){super(),vt(this,t,Zt,Vt,s,{data:0,backToSearch:1,backToBook:2})}};var Qt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function l(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,l)}c((r=r.apply(t,e||[])).next())}))},te=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},ee=function(t,e){return Qt(void 0,void 0,void 0,(function(){var n,r;return te(this,(function(o){switch(o.label){case 0:n="undefined"!=typeof AbortController?new AbortController:{},r=setTimeout((function(){return n.abort&&n.abort()}),e),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,fetch(t,{signal:n.signal})];case 2:return[2,o.sent()];case 3:return clearTimeout(r),[7];case 4:return[2]}}))}))},ne=function(t,e,n){return void 0===e&&(e=1e4),void 0===n&&(n=3),Qt(void 0,void 0,void 0,(function(){var r;return te(this,(function(o){switch(o.label){case 0:r=0,o.label=1;case 1:if(!(r<n-1))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,ee(t,e)];case 3:return[2,o.sent()];case 4:return o.sent(),console.log("Failed to fetch `"+t+"` "+(r+1)+" "+(0===r?"time":"times")+". Retrying..."),[3,5];case 5:return r++,[3,1];case 6:return[2,ee(t,e)]}}))}))};let re=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let r=63&n[t];e+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return e};var oe,ie=/(?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/.+/i,se=/href="((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/[^"]+)"[^>]*>\s*([^<]+)/gim,le=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/hfy\/wiki\/series\//i,ce=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/([^/]+)\/comments\//i,ae=function(t){return{id:t[0].data.children[0].data.id,title:t[0].data.children[0].data.title,content:Tt(t[0].data.children[0].data.selftext_html),apiUrl:kt(t[0].data.children[0].data.url),displayUrl:t[0].data.children[0].data.url,needsFetching:!1}};!function(t){t[t.HFY_SERIES=0]="HFY_SERIES",t[t.POST=1]="POST",t[t.SEARCH=2]="SEARCH"}(oe||(oe={}));var ue=function(t){var e=t.match(/href="([^"]+)"[^>]*>\s*Next/i);if(e)return e[1];var n=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}(t.matchAll(se)),!1).reverse().find((function(t){var e=t[3].toLowerCase();return!e.startsWith("first")&&!e.startsWith("prev")&&!e.startsWith("index")}));return n?n[1]:void 0};function de(t,e,n){const r=t.slice();return r[7]=e[n],r}function fe(t){let e,n;return e=new Pt({props:{error:t[11],retry:t[5]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[11]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function pe(e){let n,r=e[0](e[10])+"";return{c(){n=D(r)},m(t,e){k(t,n,e)},p(t,e){5&e&&r!==(r=t[0](t[10])+"")&&P(n,r)},i:t,o:t,d(t){t&&E(n)}}}function he(t){let e,n,r,o;e=new Rt({props:{$$slots:{default:[me]},$$scope:{ctx:t}}});let i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=be(de(t,i,e));return{c(){gt(e.$$.fragment),n=A(),r=S("div");for(let t=0;t<s.length;t+=1)s[t].c();M(r,"class","chapters svelte-1ytkh6y")},m(t,i){bt(e,t,i),k(t,n,i),k(t,r,i);for(let t=0;t<s.length;t+=1)s[t].m(r,null);o=!0},p(t,n){const o={};if(4096&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),2&n){let e;for(i=t[1],e=0;e<i.length;e+=1){const o=de(t,i,e);s[e]?s[e].p(o,n):(s[e]=be(o),s[e].c(),s[e].m(r,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){o||(ct(e.$$.fragment,t),o=!0)},o(t){at(e.$$.fragment,t),o=!1},d(t){yt(e,t),t&&E(n),t&&E(r),T(s,t)}}}function me(t){let e;return{c(){e=D("Please wait, fetching chapters...")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function ge(t){let e,n,r=t[7].title+"";return{c(){e=S("p"),n=D(r),M(e,"class","valid small svelte-1ytkh6y")},m(t,r){k(t,e,r),w(e,n)},p(t,e){2&e&&r!==(r=t[7].title+"")&&P(n,r)},d(t){t&&E(e)}}}function be(t){let e,n=t[7]&&ge(t);return{c(){n&&n.c(),e=O()},m(t,r){n&&n.m(t,r),k(t,e,r)},p(t,r){t[7]?n?n.p(t,r):(n=ge(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&E(e)}}}function ye(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:he,then:pe,catch:fe,value:10,error:11,blocks:[,,,]};return ut(n=t[2],o),{c(){e=O(),o.block.c()},m(t,n){k(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&ut(n,o)||dt(o,t,r)},i(t){r||(ct(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)at(o.blocks[t]);r=!1},d(t){t&&E(e),o.block.d(t),o.token=null,o=null}}}function ve(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function l(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,l)}c((r=r.apply(t,e||[])).next())}))};let o,{data:i}=e,{goNext:s}=e;const l=()=>r(void 0,void 0,void 0,(function*(){n(1,o=new Array(i.chapters.length));for(let t=0;t<i.chapters.length;t+=100)yield Promise.all(i.chapters.slice(t,t+100).map(((e,r)=>!1!==e.needsFetching?ne(e.apiUrl).then((t=>t.json())).then((e=>{n(1,o[r+t]=ae(e),o),n(1,o)})):void n(1,o[r+t]=Object.assign({},e),o))));return Object.assign(Object.assign({},i),{chapters:o})}));let c=l();return t.$$set=t=>{"data"in t&&n(4,i=t.data),"goNext"in t&&n(0,s=t.goNext)},[s,o,c,l,i,()=>n(2,c=l())]}const $e=class extends $t{constructor(t){super(),vt(this,t,ve,ye,s,{data:4,goNext:0})}};function we(t,e,n){const r=t.slice();return r[8]=e[n],r}function xe(t){let e,n;return e=new Pt({props:{error:t[12],retry:t[5]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[12]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ke(e){let n,r=e[0](e[11],e[1].length)+"";return{c(){n=D(r)},m(t,e){k(t,n,e)},p(t,e){7&e&&r!==(r=t[0](t[11],t[1].length)+"")&&P(n,r)},i:t,o:t,d(t){t&&E(n)}}}function Ee(t){let e,n,r,o;e=new Rt({props:{$$slots:{default:[Te]},$$scope:{ctx:t}}});let i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=Se(we(t,i,e));return{c(){gt(e.$$.fragment),n=A(),r=S("div");for(let t=0;t<s.length;t+=1)s[t].c();M(r,"class","chapters")},m(t,i){bt(e,t,i),k(t,n,i),k(t,r,i);for(let t=0;t<s.length;t+=1)s[t].m(r,null);o=!0},p(t,n){const o={};if(8192&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),2&n){let e;for(i=t[1],e=0;e<i.length;e+=1){const o=we(t,i,e);s[e]?s[e].p(o,n):(s[e]=Se(o),s[e].c(),s[e].m(r,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){o||(ct(e.$$.fragment,t),o=!0)},o(t){at(e.$$.fragment,t),o=!1},d(t){yt(e,t),t&&E(n),t&&E(r),T(s,t)}}}function Te(t){let e;return{c(){e=D("Please wait, fetching chapters...")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function Se(t){let e,n,r,o,i,s,l=t[8].from+"",c=t[8].url+"";return{c(){e=S("p"),n=D(l),r=D(": Extracted "),o=S("a"),i=D(c),M(o,"href",s=t[8].url),M(e,"class","valid small svelte-188oh31")},m(t,s){k(t,e,s),w(e,n),w(e,r),w(e,o),w(o,i)},p(t,e){2&e&&l!==(l=t[8].from+"")&&P(n,l),2&e&&c!==(c=t[8].url+"")&&P(i,c),2&e&&s!==(s=t[8].url)&&M(o,"href",s)},d(t){t&&E(e)}}}function Ce(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Ee,then:ke,catch:xe,value:11,error:12,blocks:[,,,]};return ut(n=t[2],o),{c(){e=O(),o.block.c()},m(t,n){k(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&ut(n,o)||dt(o,t,r)},i(t){r||(ct(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)at(o.blocks[t]);r=!1},d(t){t&&E(e),o.block.d(t),o.token=null,o=null}}}function De(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function l(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,l)}c((r=r.apply(t,e||[])).next())}))};let o,{bookData:i}=e,{goNext:s}=e,l=[];const c=()=>r(void 0,void 0,void 0,(function*(){for(o=i.chapters.map((t=>Object.assign({},t)));;){let t=o[o.length-1];if(!1!==t.needsFetching){const e=yield ne(t.apiUrl),n=yield e.json();if(!e.ok)throw n.message;o.splice(-1,1,t=ae(n))}const e=ue(t.content);if(!e)break;const r=kt(e);if(o.find((t=>t.apiUrl===r)))break;l.push({from:t.title,url:e}),n(1,l);const i=yield ne(r),s=yield i.json();if(!i.ok)throw s.message;o.push(ae(s))}return Object.assign(Object.assign({},i),{chapters:o})}));let a=c();return t.$$set=t=>{"bookData"in t&&n(4,i=t.bookData),"goNext"in t&&n(0,s=t.goNext)},[s,l,a,c,i,()=>n(2,a=c())]}const Ae=class extends $t{constructor(t){super(),vt(this,t,De,Ce,s,{bookData:4,goNext:0})}};function Oe(t,e,n){t.dispatchEvent(new CustomEvent("finalize",{detail:{items:e,info:n}}))}function _e(t,e,n){t.dispatchEvent(new CustomEvent("consider",{detail:{items:e,info:n}}))}const Le="draggedEntered",Ne="draggedLeft",Me="draggedOverIndex",Pe="draggedLeftDocument",Fe="leftForAnother",je="outsideOfAny";function Re(t,e,n){t.dispatchEvent(new CustomEvent(Le,{detail:{indexObj:e,draggedEl:n}}))}function Ue(t,e,n){t.dispatchEvent(new CustomEvent(Ne,{detail:{draggedEl:e,type:Fe,theOtherDz:n}}))}function He(t,e,n){t.dispatchEvent(new CustomEvent(Me,{detail:{indexObj:e,draggedEl:n}}))}const Be="dragStarted",Ie="droppedIntoZone",ze="droppedIntoAnother",We="dragStopped",qe="pointer",Ye="keyboard",Ke="data-is-dnd-shadow-item",Ge="id:dnd-shadow-placeholder-0000";let Ve="id",Xe=0;function Ze(){Xe++}function Je(){if(0===Xe)throw new Error("Bug! trying to decrement when there are no dropzones");Xe--}const Qe="undefined"==typeof window;let tn;function en(t){let e;const n=t.getBoundingClientRect(),r=getComputedStyle(t),o=r.transform;if(o){let i,s,l,c;if(o.startsWith("matrix3d("))e=o.slice(9,-1).split(/, /),i=+e[0],s=+e[5],l=+e[12],c=+e[13];else{if(!o.startsWith("matrix("))return n;e=o.slice(7,-1).split(/, /),i=+e[0],s=+e[3],l=+e[4],c=+e[5]}const a=r.transformOrigin,u=n.x-l-(1-i)*parseFloat(a),d=n.y-c-(1-s)*parseFloat(a.slice(a.indexOf(" ")+1)),f=i?n.width/i:t.offsetWidth,p=s?n.height/s:t.offsetHeight;return{x:u,y:d,width:f,height:p,top:d,right:u+f,bottom:d+p,left:u}}return n}function nn(t){const e=en(t);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function rn(t){const e=t.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function on(t){return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}function sn(t,e){return t.y<=e.bottom&&t.y>=e.top&&t.x>=e.left&&t.x<=e.right}function ln(t){return on(rn(t))}function cn(t,e){return sn(ln(t),nn(e))}function an(){tn=new Map}function un(t,e){if(!cn(t,e))return null;const n=e.children;if(0===n.length)return{index:0,isProximityBased:!0};const r=function(t){const e=Array.from(t.children).findIndex((t=>t.getAttribute(Ke)));if(e>=0)return tn.has(t)||tn.set(t,new Map),tn.get(t).set(e,nn(t.children[e])),e}(e);for(let o=0;o<n.length;o++)if(cn(t,n[o])){const n=tn.has(e)&&tn.get(e).get(o);return n&&!sn(ln(t),n)?{index:r,isProximityBased:!1}:{index:o,isProximityBased:!1}}let o,i=Number.MAX_VALUE;for(let e=0;e<n.length;e++){const r=(s=t,l=n[e],c=void 0,a=void 0,c=ln(s),a=ln(l),Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)));r<i&&(i=r,o=e)}var s,l,c,a;return{index:o,isProximityBased:!0}}function dn(){let t;function e(){t={directionObj:void 0,stepPx:0}}function n(e){const{directionObj:r,stepPx:o}=t;r&&(e.scrollBy(r.x*o,r.y*o),window.requestAnimationFrame((()=>n(e))))}function r(t){return 25-t}return e(),{scrollIfNeeded:function(o,i){if(!i)return!1;const s=function(t,e){const n=rn(e);return sn(t,n)?{top:t.y-n.top,bottom:n.bottom-t.y,left:t.x-n.left,right:Math.min(n.right,document.documentElement.clientWidth)-t.x}:null}(o,i);if(null===s)return e(),!1;const l=!!t.directionObj;let[c,a]=[!1,!1];return i.scrollHeight>i.clientHeight&&(s.bottom<25?(c=!0,t.directionObj={x:0,y:1},t.stepPx=r(s.bottom)):s.top<25&&(c=!0,t.directionObj={x:0,y:-1},t.stepPx=r(s.top)),!l&&c)||i.scrollWidth>i.clientWidth&&(s.right<25?(a=!0,t.directionObj={x:1,y:0},t.stepPx=r(s.right)):s.left<25&&(a=!0,t.directionObj={x:-1,y:0},t.stepPx=r(s.left)),!l&&a)?(n(i),!0):(e(),!1)},resetScrolling:e}}function fn(t){return JSON.stringify(t,null,2)}function pn(t){if(!t)throw new Error("cannot get depth of a falsy node");return hn(t,0)}function hn(t,e=0){return t.parentElement?hn(t.parentElement,e+1):e-1}an();const{scrollIfNeeded:mn,resetScrolling:gn}=dn();let bn,yn;function vn(t){const e=t.touches?t.touches[0]:t;yn={x:e.clientX,y:e.clientY}}const{scrollIfNeeded:$n,resetScrolling:wn}=dn();let xn;function kn(){yn&&$n(yn,document.documentElement),xn=window.setTimeout(kn,300)}function En(t){return`${t} 0.2s ease`}function Tn(t,e,n,r,o){const i=e.getBoundingClientRect(),s=t.getBoundingClientRect(),l=i.width-s.width,c=i.height-s.height;if(l||c){const e={left:(n-s.left)/s.width,top:(r-s.top)/s.height};t.style.height=`${i.height}px`,t.style.width=`${i.width}px`,t.style.left=parseFloat(t.style.left)-e.left*l+"px",t.style.top=parseFloat(t.style.top)-e.top*c+"px"}Sn(e,t),o()}function Sn(t,e){const n=window.getComputedStyle(t);Array.from(n).filter((t=>t.startsWith("background")||t.startsWith("padding")||t.startsWith("font")||t.startsWith("text")||t.startsWith("align")||t.startsWith("justify")||t.startsWith("display")||t.startsWith("flex")||t.startsWith("border")||"opacity"===t||"color"===t||"list-style-type"===t)).forEach((t=>e.style.setProperty(t,n.getPropertyValue(t),n.getPropertyPriority(t))))}function Cn(t,e){t.draggable=!1,t.ondragstart=()=>!1,e?(t.style.userSelect="",t.style.WebkitUserSelect="",t.style.cursor=""):(t.style.userSelect="none",t.style.WebkitUserSelect="none",t.style.cursor="grab")}function Dn(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const r=e(t);Object.keys(r).forEach((e=>{t.style[e]=r[e]})),n(t).forEach((e=>t.classList.add(e)))}))}function An(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const r=e(t);Object.keys(r).forEach((e=>{t.style[e]=""})),n(t).forEach((e=>t.classList.contains(e)&&t.classList.remove(e)))}))}const On={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let _n,Ln,Nn,Mn,Pn,Fn,jn,Rn,Un,Hn,Bn,In=!1,zn=!1,Wn=!1;const qn=new Map,Yn=new Map,Kn=new WeakMap;function Gn(t,e){qn.get(e).delete(t),Je(),0===qn.get(e).size&&qn.delete(e)}function Vn(){window.addEventListener("mousemove",vn),window.addEventListener("touchmove",vn),kn();const t=qn.get(Mn);for(const e of t)e.addEventListener(Le,Zn),e.addEventListener(Ne,Jn),e.addEventListener(Me,Qn);window.addEventListener(Pe,er);const e=Math.max(100,...Array.from(t.keys()).map((t=>Yn.get(t).dropAnimationDurationMs)));!function(t,e,n=200){let r,o,i,s=!1;const l=Array.from(e).sort(((t,e)=>pn(e)-pn(t)));!function e(){const c=ln(t);if(!mn(c,r)&&i&&Math.abs(i.x-c.x)<10&&Math.abs(i.y-c.y)<10)return void(bn=window.setTimeout(e,n));if(function(t){const e=rn(t);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}(t))return void function(t){window.dispatchEvent(new CustomEvent(Pe,{detail:{draggedEl:t}}))}(t);i=c;let a=!1;for(const e of l){const n=un(t,e);if(null===n)continue;const{index:i}=n;a=!0,e!==r?(r&&Ue(r,t,e),Re(e,n,t),r=e):i!==o&&(He(e,n,t),o=i);break}!a&&s&&r?(function(t,e){t.dispatchEvent(new CustomEvent(Ne,{detail:{draggedEl:e,type:je}}))}(r,t),r=void 0,o=void 0,s=!1):s=!0,bn=window.setTimeout(e,n)}()}(Ln,t,1.07*e)}function Xn(t){return t.findIndex((t=>!!t.isDndShadowItem&&t.id!==Ge))}function Zn(t){let{items:e,dropFromOthersDisabled:n}=Yn.get(t.currentTarget);if(n&&t.currentTarget!==Pn)return;if(Wn=!1,e=e.filter((t=>t.id!==jn.id)),Pn!==t.currentTarget){const t=Yn.get(Pn).items.filter((t=>!t.isDndShadowItem));_e(Pn,t,{trigger:"dragEnteredAnother",id:Nn.id,source:qe})}else{const t=function(t){return t.findIndex((t=>t.id===Ge))}(e);-1!==t&&e.splice(t,1)}const{index:r,isProximityBased:o}=t.detail.indexObj,i=o&&r===t.currentTarget.children.length-1?r+1:r;Rn=t.currentTarget,e.splice(i,0,jn),_e(t.currentTarget,e,{trigger:"draggedEntered",id:Nn.id,source:qe})}function Jn(t){if(!In)return;const{items:e,dropFromOthersDisabled:n}=Yn.get(t.currentTarget);if(n&&t.currentTarget!==Pn&&t.currentTarget!==Rn)return;const r=Xn(e),o=e.splice(r,1)[0];Rn=void 0;const{type:i,theOtherDz:s}=t.detail;if(i===je||i===Fe&&s!==Pn&&Yn.get(s).dropFromOthersDisabled){Wn=!0,Rn=Pn;const t=Yn.get(Pn).items;t.splice(Fn,0,o),_e(Pn,t,{trigger:"draggedLeftAll",id:Nn.id,source:qe})}_e(t.currentTarget,e,{trigger:"draggedLeft",id:Nn.id,source:qe})}function Qn(t){const{items:e,dropFromOthersDisabled:n}=Yn.get(t.currentTarget);if(n&&t.currentTarget!==Pn)return;Wn=!1;const{index:r}=t.detail.indexObj,o=Xn(e);e.splice(o,1),e.splice(r,0,jn),_e(t.currentTarget,e,{trigger:"draggedOverIndex",id:Nn.id,source:qe})}function tr(t){t.preventDefault();const e=t.touches?t.touches[0]:t;Hn={x:e.clientX,y:e.clientY},Ln.style.transform=`translate3d(${Hn.x-Un.x}px, ${Hn.y-Un.y}px, 0)`}function er(){zn=!0,window.removeEventListener("mousemove",tr),window.removeEventListener("touchmove",tr),window.removeEventListener("mouseup",er),window.removeEventListener("touchend",er),function(){window.removeEventListener("mousemove",vn),window.removeEventListener("touchmove",vn),yn=void 0,window.clearTimeout(xn),wn();const t=qn.get(Mn);for(const e of t)e.removeEventListener(Le,Zn),e.removeEventListener(Ne,Jn),e.removeEventListener(Me,Qn);window.removeEventListener(Pe,er),clearTimeout(bn),gn(),an()}(),function(t){t.style.cursor="grab"}(Ln),Rn||(Rn=Pn);let{items:t,type:e}=Yn.get(Rn);An(qn.get(e),(t=>Yn.get(t).dropTargetStyle),(t=>Yn.get(t).dropTargetClasses));let n=Xn(t);-1===n&&(n=Fn),t=t.map((t=>t.isDndShadowItem?Nn:t)),function(t,e){const n=en(Rn.children[t]),r=n.left-parseFloat(Ln.style.left),o=n.top-parseFloat(Ln.style.top),{dropAnimationDurationMs:i}=Yn.get(Rn),s=`transform ${i}ms ease`;Ln.style.transition=Ln.style.transition?Ln.style.transition+","+s:s,Ln.style.transform=`translate3d(${r}px, ${o}px, 0)`,window.setTimeout(e,i)}(n,(function(){var e;Bn(),Oe(Rn,t,{trigger:Wn?"droppedOutsideOfAny":Ie,id:Nn.id,source:qe}),Rn!==Pn&&Oe(Pn,Yn.get(Pn).items,{trigger:ze,id:Nn.id,source:qe}),(e=Rn.children[n]).style.visibility="",e.removeAttribute(Ke),Ln.remove(),_n.remove(),Ln=void 0,_n=void 0,Nn=void 0,Mn=void 0,Pn=void 0,Fn=void 0,jn=void 0,Rn=void 0,Un=void 0,Hn=void 0,In=!1,zn=!1,Bn=void 0,Wn=!1}))}const nr={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},rr={[nr.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[nr.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"};let or;function ir(){or=document.createElement("div"),or.id="dnd-action-aria-alert",or.style.position="fixed",or.style.bottom="0",or.style.left="0",or.style.zIndex="-5",or.style.opacity="0",or.style.height="0",or.style.width="0",or.setAttribute("role","alert"),document.body.prepend(or),Object.entries(rr).forEach((([t,e])=>document.body.prepend(function(t,e){const n=document.createElement("div");return n.id=t,n.innerHTML=`<p>${e}</p>`,n.style.display="none",n.style.position="fixed",n.style.zIndex="-5",n}(t,e))))}function sr(t){or.innerHTML="";const e=document.createTextNode(t);or.appendChild(e),or.style.display="none",or.style.display="inline"}const lr={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let cr,ar,ur,dr,fr=!1,pr="",hr="";const mr=new WeakSet,gr=new WeakMap,br=new WeakMap,yr=new Map,vr=new Map,$r=new Map,wr=Qe?null:("complete"===document.readyState?ir():window.addEventListener("DOMContentLoaded",ir),{...nr});function xr(t,e){ar===t&&Cr(),$r.get(e).delete(t),Je(),0===$r.get(e).size&&$r.delete(e),0===$r.size&&(window.removeEventListener("keydown",kr),window.removeEventListener("click",Er))}function kr(t){fr&&"Escape"===t.key&&Cr()}function Er(){fr&&(mr.has(document.activeElement)||Cr())}function Tr(t){if(!fr)return;const e=t.currentTarget;if(e===ar)return;pr=e.getAttribute("aria-label")||"";const{items:n}=vr.get(ar),r=n.find((t=>t.id===dr)),o=n.indexOf(r),i=n.splice(o,1)[0],{items:s,autoAriaDisabled:l}=vr.get(e);e.getBoundingClientRect().top<ar.getBoundingClientRect().top||e.getBoundingClientRect().left<ar.getBoundingClientRect().left?(s.push(i),l||sr(`Moved item ${hr} to the end of the list ${pr}`)):(s.unshift(i),l||sr(`Moved item ${hr} to the beginning of the list ${pr}`)),Oe(ar,n,{trigger:ze,id:dr,source:Ye}),Oe(e,s,{trigger:Ie,id:dr,source:Ye}),ar=e}function Sr(){yr.forEach((({update:t},e)=>t(vr.get(e))))}function Cr(t=!0){vr.get(ar).autoAriaDisabled||sr(`Stopped dragging item ${hr}`),mr.has(document.activeElement)&&document.activeElement.blur(),t&&_e(ar,vr.get(ar).items,{trigger:We,id:dr,source:Ye}),An($r.get(cr),(t=>vr.get(t).dropTargetStyle),(t=>vr.get(t).dropTargetClasses)),ur=null,dr=null,hr="",cr=null,ar=null,pr="",fr=!1,Sr()}function Dr(t,e){Ar(e);const n=function(t,e){const n={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:On,dropTargetClasses:[],transformDraggedElement:()=>{},centreDraggedOnCursor:!1};let r=new Map;function o(){window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",s),window.removeEventListener("mouseup",i),window.removeEventListener("touchend",i)}function i(){o(),_n=void 0,Un=void 0,Hn=void 0}function s(t){t.preventDefault();const e=t.touches?t.touches[0]:t;Hn={x:e.clientX,y:e.clientY},(Math.abs(Hn.x-Un.x)>=3||Math.abs(Hn.y-Un.y)>=3)&&(o(),function(){In=!0;const t=r.get(_n);Fn=t,Pn=_n.parentElement;const e=Pn.getRootNode(),o=e.body||e,{items:i,type:s,centreDraggedOnCursor:l}=n;Nn={...i[t]},Mn=s,jn={...Nn,isDndShadowItem:!0};const c={...jn,[Ve]:Ge};Ln=function(t,e){const n=t.getBoundingClientRect(),r=t.cloneNode(!0);Sn(t,r),r.id="dnd-action-dragged-el",r.style.position="fixed";let o=n.top,i=n.left;if(r.style.top=`${o}px`,r.style.left=`${i}px`,e){const t=on(n);o-=t.y-e.y,i-=t.x-e.x,window.setTimeout((()=>{r.style.top=`${o}px`,r.style.left=`${i}px`}),0)}return r.style.margin="0",r.style.boxSizing="border-box",r.style.height=`${n.height}px`,r.style.width=`${n.width}px`,r.style.transition=`${En("top")}, ${En("left")}, ${En("background-color")}, ${En("opacity")}, ${En("color")} `,window.setTimeout((()=>r.style.transition+=`, ${En("width")}, ${En("height")}`),0),r.style.zIndex="9999",r.style.cursor="grabbing",r}(_n,l&&Hn),window.requestAnimationFrame((function t(){var e;Ln.parentElement?window.requestAnimationFrame(t):(o.appendChild(Ln),Ln.focus(),Vn(),(e=_n).style.display="none",e.style.position="fixed",e.style.zIndex="-5",o.appendChild(_n))})),Dn(Array.from(qn.get(n.type)).filter((t=>t===Pn||!Yn.get(t).dropFromOthersDisabled)),(t=>Yn.get(t).dropTargetStyle),(t=>Yn.get(t).dropTargetClasses)),i.splice(t,1,c),Bn=function(t){const e=t.style.minHeight;t.style.minHeight=window.getComputedStyle(t).getPropertyValue("height");const n=t.style.minWidth;return t.style.minWidth=window.getComputedStyle(t).getPropertyValue("width"),function(){t.style.minHeight=e,t.style.minWidth=n}}(Pn),_e(Pn,i,{trigger:Be,id:Nn.id,source:qe}),window.addEventListener("mousemove",tr,{passive:!1}),window.addEventListener("touchmove",tr,{passive:!1,capture:!1}),window.addEventListener("mouseup",er,{passive:!1}),window.addEventListener("touchend",er,{passive:!1})}())}function l(t){if(t.target!==t.currentTarget&&(void 0!==t.target.value||t.target.isContentEditable))return;if(t.button)return;if(In)return;t.stopPropagation();const e=t.touches?t.touches[0]:t;Un={x:e.clientX,y:e.clientY},Hn={...Un},_n=t.currentTarget,window.addEventListener("mousemove",s,{passive:!1}),window.addEventListener("touchmove",s,{passive:!1,capture:!1}),window.addEventListener("mouseup",i,{passive:!1}),window.addEventListener("touchend",i,{passive:!1})}function c({items:e,flipDurationMs:o=0,type:i="--any--",dragDisabled:s=!1,morphDisabled:c=!1,dropFromOthersDisabled:a=!1,dropTargetStyle:u=On,dropTargetClasses:d=[],transformDraggedElement:f=(()=>{}),centreDraggedOnCursor:p=!1}){var h,m;function g(t,e){return Yn.get(t)?Yn.get(t)[e]:n[e]}n.dropAnimationDurationMs=o,n.type&&i!==n.type&&Gn(t,n.type),n.type=i,h=t,m=i,qn.has(m)||qn.set(m,new Set),qn.get(m).has(h)||(qn.get(m).add(h),Ze()),n.items=[...e],n.dragDisabled=s,n.morphDisabled=c,n.transformDraggedElement=f,n.centreDraggedOnCursor=p,!In||zn||function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!{}.hasOwnProperty.call(e,n)||e[n]!==t[n])return!1;return!0}(u,n.dropTargetStyle)&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(d,n.dropTargetClasses)||(An([t],(()=>n.dropTargetStyle),(()=>d)),Dn([t],(()=>u),(()=>d))),n.dropTargetStyle=u,n.dropTargetClasses=[...d],In&&n.dropFromOthersDisabled!==a&&(a?An([t],(t=>g(t,"dropTargetStyle")),(t=>g(t,"dropTargetClasses"))):Dn([t],(t=>g(t,"dropTargetStyle")),(t=>g(t,"dropTargetClasses")))),n.dropFromOthersDisabled=a,Yn.set(t,n);const b=Xn(n.items);for(let e=0;e<t.children.length;e++){const o=t.children[e];Cn(o,s),e!==b?(o.removeEventListener("mousedown",Kn.get(o)),o.removeEventListener("touchstart",Kn.get(o)),s||(o.addEventListener("mousedown",l),o.addEventListener("touchstart",l),Kn.set(o,l)),r.set(o,e)):(c||Tn(Ln,o,Hn.x,Hn.y,(()=>n.transformDraggedElement(Ln,Nn,e))),(y=o).style.visibility="hidden",y.setAttribute(Ke,"true"))}var y}return c(e),{update:t=>{c(t)},destroy:()=>{Gn(t,n.type),Yn.delete(t)}}}(t,e),r=function(t,e){const n={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:lr,dropTargetClasses:[],autoAriaDisabled:!1};function r(t,e,n){t.length<=1||t.splice(n,1,t.splice(e,1,t[n])[0])}function o(e){switch(e.key){case"Enter":case" ":if((void 0!==e.target.disabled||e.target.href||e.target.isContentEditable)&&!mr.has(e.target))return;e.preventDefault(),e.stopPropagation(),fr?Cr():i(e);break;case"ArrowDown":case"ArrowRight":{if(!fr)return;e.preventDefault(),e.stopPropagation();const{items:o}=vr.get(t),i=Array.from(t.children),s=i.indexOf(e.currentTarget);s<i.length-1&&(n.autoAriaDisabled||sr(`Moved item ${hr} to position ${s+2} in the list ${pr}`),r(o,s,s+1),Oe(t,o,{trigger:Ie,id:dr,source:Ye}));break}case"ArrowUp":case"ArrowLeft":{if(!fr)return;e.preventDefault(),e.stopPropagation();const{items:o}=vr.get(t),i=Array.from(t.children).indexOf(e.currentTarget);i>0&&(n.autoAriaDisabled||sr(`Moved item ${hr} to position ${i} in the list ${pr}`),r(o,i,i-1),Oe(t,o,{trigger:Ie,id:dr,source:Ye}));break}}}function i(e){(function(e){const{items:n}=vr.get(t),r=Array.from(t.children),o=r.indexOf(e);ur=e,ur.tabIndex=0,dr=n[o].id,hr=r[o].getAttribute("aria-label")||""})(e.currentTarget),ar=t,cr=n.type,fr=!0;const r=Array.from($r.get(n.type)).filter((t=>t===ar||!vr.get(t).dropFromOthersDisabled));if(Dn(r,(t=>vr.get(t).dropTargetStyle),(t=>vr.get(t).dropTargetClasses)),!n.autoAriaDisabled){let t=`Started dragging item ${hr}. Use the arrow keys to move it within its list ${pr}`;r.length>1&&(t+=", or tab to another list in order to move the item into it"),sr(t)}_e(t,vr.get(t).items,{trigger:Be,id:dr,source:Ye}),Sr()}function s(t){fr&&t.currentTarget!==ur&&(t.stopPropagation(),Cr(!1),i(t))}function l({items:e=[],type:r="--any--",dragDisabled:i=!1,zoneTabIndex:l=0,dropFromOthersDisabled:c=!1,dropTargetStyle:a=lr,dropTargetClasses:u=[],autoAriaDisabled:d=!1}){var f,p;n.items=[...e],n.dragDisabled=i,n.dropFromOthersDisabled=c,n.zoneTabIndex=l,n.dropTargetStyle=a,n.dropTargetClasses=u,n.autoAriaDisabled=d,d||(t.setAttribute("aria-disabled",i),t.setAttribute("role","list"),t.setAttribute("aria-describedby",i?wr.DND_ZONE_DRAG_DISABLED:wr.DND_ZONE_ACTIVE)),n.type&&r!==n.type&&xr(t,n.type),n.type=r,f=t,p=r,0===$r.size&&(window.addEventListener("keydown",kr),window.addEventListener("click",Er)),$r.has(p)||$r.set(p,new Set),$r.get(p).has(f)||($r.get(p).add(f),Ze()),vr.set(t,n),t.tabIndex=fr?t===ar||ur.contains(t)||n.dropFromOthersDisabled||ar&&n.type!==vr.get(ar).type?-1:0:n.zoneTabIndex,t.addEventListener("focus",Tr);for(let e=0;e<t.children.length;e++){const r=t.children[e];mr.add(r),r.tabIndex=fr?-1:0,d||r.setAttribute("role","listitem"),r.removeEventListener("keydown",gr.get(r)),r.removeEventListener("click",br.get(r)),i||(r.addEventListener("keydown",o),gr.set(r,o),r.addEventListener("click",s),br.set(r,s)),fr&&n.items[e].id===dr&&(ur=r,ur.tabIndex=0,r.focus())}}l(e);const c={update:t=>{l(t)},destroy:()=>{xr(t,n.type),vr.delete(t),yr.delete(t)}};return yr.set(t,c),c}(t,e);return{update:t=>{Ar(t),n.update(t),r.update(t)},destroy:()=>{n.destroy(),r.destroy()}}}function Ar(t){const{items:e,flipDurationMs:n,type:r,dragDisabled:o,morphDisabled:i,dropFromOthersDisabled:s,zoneTabIndex:l,dropTargetStyle:c,dropTargetClasses:a,transformDraggedElement:u,autoAriaDisabled:d,centreDraggedOnCursor:f,...p}=t;if(Object.keys(p).length>0&&console.warn("dndzone will ignore unknown options",p),!e)throw new Error("no 'items' key provided to dndzone");const h=e.find((t=>!{}.hasOwnProperty.call(t,Ve)));if(h)throw new Error(`missing 'id' property for item ${fn(h)}`);if(a&&!Array.isArray(a))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof a}, ${fn(a)}`);if(l&&(m=l,isNaN(m)||(0|(g=parseFloat(m)))!==g))throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof l}, ${fn(l)}`);var m,g}function Or(t){const e=t-1;return e*e*e+1}function _r(t,{from:e,to:n},r={}){const o=getComputedStyle(t),s="none"===o.transform?"":o.transform,[l,c]=o.transformOrigin.split(" ").map(parseFloat),a=e.left+e.width*l/n.width-(n.left+l),u=e.top+e.height*c/n.height-(n.top+c),{delay:d=0,duration:f=(t=>120*Math.sqrt(t)),easing:p=Or}=r;return{delay:d,duration:i(f)?f(Math.sqrt(a*a+u*u)):f,easing:p,css:(t,r)=>{const o=r*a,i=r*u,l=t+r*e.width/n.width,c=t+r*e.height/n.height;return`transform: ${s} translate(${o}px, ${i}px) scale(${l}, ${c});`}}}const Lr=["Activate","AddUndo","BeforeAddUndo","BeforeExecCommand","BeforeGetContent","BeforeRenderUI","BeforeSetContent","BeforePaste","Blur","Change","ClearUndos","Click","ContextMenu","Copy","Cut","Dblclick","Deactivate","Dirty","Drag","DragDrop","DragEnd","DragGesture","DragOver","Drop","ExecCommand","Focus","FocusIn","FocusOut","GetContent","Hide","Init","KeyDown","KeyPress","KeyUp","LoadContent","MouseDown","MouseEnter","MouseLeave","MouseMove","MouseOut","MouseOver","MouseUp","NodeChange","ObjectResizeStart","ObjectResized","ObjectSelected","Paste","PostProcess","PostRender","PreProcess","ProgressState","Redo","Remove","Reset","ResizeEditor","SaveContent","SelectionChange","SetAttrib","SetContent","Show","Submit","Undo","VisualAid"];function Nr(t){let e;return{c(){e=S("textarea"),M(e,"id",t[0]),e.style.setProperty("visibility","hidden","")},m(n,r){k(n,e,r),t[16](e)},p(t,n){1&n&&M(e,"id",t[0])},d(n){n&&E(e),t[16](null)}}}function Mr(t){let e;return{c(){e=S("div"),M(e,"id",t[0])},m(n,r){k(n,e,r),t[15](e)},p(t,n){1&n&&M(e,"id",t[0])},d(n){n&&E(e),t[15](null)}}}function Pr(e){let n;function r(t,e){return t[1]?Mr:Nr}let o=r(e),i=o(e);return{c(){n=S("div"),i.c()},m(t,r){k(t,n,r),i.m(n,null),e[17](n)},p(t,[e]){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n,null)))},i:t,o:t,d(t){t&&E(n),i.d(),e[17](null)}}}const Fr=t=>t+"_"+Math.floor(1e9*Math.random())+String(Date.now());let jr=(()=>{let t={listeners:[],scriptId:Fr("tiny-script"),scriptLoaded:!1,injected:!1};return{load:(e,n,r)=>{t.scriptLoaded?r():(t.listeners.push(r),t.injected||((e,n,r,o)=>{t.injected=!0;const i=n.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.src=r,i.onload=()=>{t.listeners.forEach((t=>t())),t.scriptLoaded=!0},n.head&&n.head.appendChild(i)})(t.scriptId,e,n))}}})();function Rr(t,e,n){let r,o,i,{id:s=Fr("tinymce-svelte")}=e,{inline:c}=e,{disabled:a=!1}=e,{apiKey:u="no-api-key"}=e,{channel:d="5"}=e,{scriptSrc:f}=e,{conf:p={}}=e,{modelEvents:h="change input undo redo"}=e,{value:m=""}=e,{text:g=""}=e,b="",y=a;const v=function(){const t=z();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const o=function(t,e,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,!1,e),r}(e,n);r.slice().forEach((e=>{e.call(t,o)}))}}}(),$=()=>{const t="undefined"!=typeof window?window:l.g;return t&&t.tinymce?t.tinymce:null},w=()=>{const t=Object.assign(Object.assign({},p),{target:o,inline:void 0!==c?c:void 0!==p.inline&&p.inline,readonly:a,setup:t=>{n(12,i=t),t.on("init",(()=>{t.setContent(m),t.on(h,(()=>{n(13,b=t.getContent()),b!==m&&(n(4,m=b),n(5,g=t.getContent({format:"text"})))}))})),((t,e)=>{Lr.forEach((n=>{t.on(n,(r=>{e(n.toLowerCase(),{eventName:n,event:r,editor:t})}))}))})(t,v),"function"==typeof p.setup&&p.setup(t)}});n(3,o.style.visibility="",o),$().init(t)};var x;return x=()=>{if(null!==$())setTimeout(w,0);else{const t=f||`https://cdn.tiny.cloud/1/${u}/tinymce/${d}/tinymce.min.js`;jr.load(r.ownerDocument,t,(()=>{w()}))}},z().$$.on_mount.push(x),W((()=>{var t;i&&(null===(t=$())||void 0===t||t.remove(i))})),t.$$set=t=>{"id"in t&&n(0,s=t.id),"inline"in t&&n(1,c=t.inline),"disabled"in t&&n(6,a=t.disabled),"apiKey"in t&&n(7,u=t.apiKey),"channel"in t&&n(8,d=t.channel),"scriptSrc"in t&&n(9,f=t.scriptSrc),"conf"in t&&n(10,p=t.conf),"modelEvents"in t&&n(11,h=t.modelEvents),"value"in t&&n(4,m=t.value),"text"in t&&n(5,g=t.text)},t.$$.update=()=>{28752&t.$$.dirty&&(i&&b!==m&&(i.setContent(m),n(5,g=i.getContent({format:"text"}))),i&&a!==y&&(n(14,y=a),i.setMode(a?"readonly":"design")))},[s,c,r,o,m,g,a,u,d,f,p,h,i,b,y,function(t){Y[t?"unshift":"push"]((()=>{o=t,n(3,o)}))},function(t){Y[t?"unshift":"push"]((()=>{o=t,n(3,o)}))},function(t){Y[t?"unshift":"push"]((()=>{r=t,n(2,r)}))}]}const Ur=class extends $t{constructor(t){super(),vt(this,t,Rr,Pr,s,{id:0,inline:1,disabled:6,apiKey:7,channel:8,scriptSrc:9,conf:10,modelEvents:11,value:4,text:5})}},Hr=[];var Br={useTiny:!0},Ir=function(e,n=t){let r;const o=new Set;function i(t){if(s(e,t)&&(e=t,r)){const t=!Hr.length;for(const t of o)t[1](),Hr.push(t,e);if(t){for(let t=0;t<Hr.length;t+=2)Hr[t][0](Hr[t+1]);Hr.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(s,l=t){const c=[s,l];return o.add(c),1===o.size&&(r=n(i)||t),s(e),()=>{o.delete(c),0===o.size&&(r(),r=null)}}}}(Br);function zr(e){let n,r;return{c(){n=C("svg"),r=C("polygon"),M(r,"points","0,490 490,490 245,0"),M(n,"version","1.1"),M(n,"xmlns","http://www.w3.org/2000/svg"),M(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),M(n,"x","0px"),M(n,"y","0px"),M(n,"viewBox","0 0 490 490"),M(n,"xml:space","preserve")},m(t,e){k(t,n,e),w(n,r)},p:t,i:t,o:t,d(t){t&&E(n)}}}const Wr=class extends $t{constructor(t){super(),vt(this,t,null,zr,s,{})}};function qr(e){let n,r;return{c(){n=C("svg"),r=C("polygon"),M(r,"points","0,332.668 245.004,82.631 490,332.668 413.507,407.369 245.004,235.402 76.493,407.369"),M(n,"version","1.1"),M(n,"xmlns","http://www.w3.org/2000/svg"),M(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),M(n,"x","0px"),M(n,"y","0px"),M(n,"viewBox","0 0 490 490"),M(n,"xml:space","preserve")},m(t,e){k(t,n,e),w(n,r)},p:t,i:t,o:t,d(t){t&&E(n)}}}const Yr=class extends $t{constructor(t){super(),vt(this,t,null,qr,s,{})}};function Kr(t){let e,n,r,i,s,l;return{c(){e=S("div"),n=S("span"),n.textContent="URL",r=A(),i=S("span"),M(n,"class","label svelte-1bu5w90"),M(i,"class","url svelte-1bu5w90"),M(i,"aria-label","URL"),M(i,"contenteditable",""),void 0===t[3]&&Z((()=>t[24].call(i))),M(e,"class","field svelte-1bu5w90")},m(o,c){k(o,e,c),w(e,n),w(e,r),w(e,i),void 0!==t[3]&&(i.innerHTML=t[3]),s||(l=[_(i,"input",t[24]),_(i,"keydown",t[16])],s=!0)},p(t,e){8&e&&t[3]!==i.innerHTML&&(i.innerHTML=t[3])},d(t){t&&E(e),s=!1,o(l)}}}function Gr(e){let n,r,o;return{c(){n=S("textarea"),n.disabled=e[2],M(n,"class","svelte-1bu5w90")},m(t,i){k(t,n,i),F(n,e[1]),r||(o=_(n,"input",e[26]),r=!0)},p(t,e){4&e&&(n.disabled=t[2]),2&e&&F(n,t[1])},i:t,o:t,d(t){t&&E(n),r=!1,o()}}}function Vr(t){let e,n,r=t[10]&&Xr(t);return{c(){r&&r.c(),e=O()},m(t,o){r&&r.m(t,o),k(t,e,o),n=!0},p(t,n){t[10]?r?(r.p(t,n),1024&n&&ct(r,1)):(r=Xr(t),r.c(),ct(r,1),r.m(e.parentNode,e)):r&&(st(),at(r,1,1,(()=>{r=null})),lt())},i(t){n||(ct(r),n=!0)},o(t){at(r),n=!1},d(t){r&&r.d(t),t&&E(e)}}}function Xr(t){let e,n,r;function o(e){t[25](e)}let i={disabled:t[2],apiKey:"okcf1pz4foebbixgcdydveaavknj41e62etldhxguuyug0v3",conf:t[19]};return void 0!==t[1]&&(i.value=t[1]),e=new Ur({props:i}),Y.push((()=>mt(e,"value",o))),{c(){gt(e.$$.fragment)},m(t,n){bt(e,t,n),r=!0},p(t,r){const o={};4&r&&(o.disabled=t[2]),!n&&2&r&&(n=!0,o.value=t[1],J((()=>n=!1))),e.$set(o)},i(t){r||(ct(e.$$.fragment,t),r=!0)},o(t){at(e.$$.fragment,t),r=!1},d(t){yt(e,t)}}}function Zr(t){let e,n,r,o,i;return{c(){e=S("label"),n=S("input"),r=D(" Fetch contents"),M(n,"type","checkbox"),M(n,"class","svelte-1bu5w90"),M(e,"class","svelte-1bu5w90")},m(s,l){k(s,e,l),w(e,n),n.checked=t[2],w(e,r),o||(i=_(n,"change",t[27]),o=!0)},p(t,e){4&e&&(n.checked=t[2])},d(t){t&&E(e),o=!1,i()}}}function Jr(t){let e,n,r,s,l,c,a,u,d,f,p,h,m,g,b,y,v,$,x,T,C,O,F,R,U,H,B,I,z,W,q,Y,K,G,V=Tt(t[1]||"")+"";m=new Yr({});let X=void 0!==t[3]&&Kr(t);const J=[Vr,Gr],Q=[];function tt(t,e){return t[13].useTiny?0:1}$=tt(t),x=Q[$]=J[$](t);let et=t[4]&&Zr(t);return R=new Wr({}),I=new Wr({}),{c(){e=S("div"),n=S("div"),r=S("div"),s=S("span"),s.textContent="Title",l=A(),c=S("span"),u=A(),d=S("span"),f=D(V),p=A(),h=S("span"),gt(m.$$.fragment),g=A(),b=S("div"),y=S("div"),X&&X.c(),v=A(),x.c(),T=A(),et&&et.c(),C=A(),O=S("div"),F=S("a"),gt(R.$$.fragment),U=D(" move up"),H=A(),B=S("a"),gt(I.$$.fragment),z=D(" move down"),W=A(),q=S("a"),q.textContent="remove",M(s,"class","label svelte-1bu5w90"),M(c,"class","title svelte-1bu5w90"),M(c,"aria-label","Title"),M(c,"contenteditable",""),M(c,"style",a=t[9]?"":"pointer-events: none"),void 0===t[0]&&Z((()=>t[22].call(c))),M(r,"class","field svelte-1bu5w90"),M(d,"class","content svelte-1bu5w90"),M(h,"class","toggle svelte-1bu5w90"),M(n,"class","preview svelte-1bu5w90"),M(F,"href","#up"),M(F,"class","small up svelte-1bu5w90"),j(F,"control-disabled",!t[5]),M(B,"href","#dowm"),M(B,"class","small down svelte-1bu5w90"),j(B,"control-disabled",!t[6]),M(q,"href","#remove"),M(q,"class","small remove svelte-1bu5w90"),M(O,"class","controls svelte-1bu5w90"),M(y,"class","edit-inner svelte-1bu5w90"),M(b,"class","edit svelte-1bu5w90"),M(e,"class","chapter svelte-1bu5w90"),M(e,"tabindex","0"),j(e,"open",t[9])},m(o,a){k(o,e,a),w(e,n),w(n,r),w(r,s),w(r,l),w(r,c),void 0!==t[0]&&(c.innerHTML=t[0]),t[23](c),w(n,u),w(n,d),w(d,f),w(n,p),w(n,h),bt(m,h,null),w(e,g),w(e,b),w(b,y),X&&X.m(y,null),w(y,v),Q[$].m(y,null),w(y,T),et&&et.m(y,null),w(y,C),w(y,O),w(O,F),bt(R,F,null),w(F,U),w(O,H),w(O,B),bt(I,B,null),w(B,z),w(O,W),w(O,q),t[28](y),t[29](b),Y=!0,K||(G=[_(c,"input",t[22]),_(c,"keydown",t[16]),_(h,"click",N(t[14])),_(n,"click",t[15]),_(F,"click",L((function(){i(t[5])&&t[5].apply(this,arguments)}))),_(B,"click",L((function(){i(t[6])&&t[6].apply(this,arguments)}))),_(q,"click",L((function(){i(t[7])&&t[7].apply(this,arguments)}))),_(e,"mousedown",t[17]),_(e,"touchstart",t[17]),_(e,"keydown",t[18])],K=!0)},p(n,[r]){t=n,(!Y||512&r&&a!==(a=t[9]?"":"pointer-events: none"))&&M(c,"style",a),1&r&&t[0]!==c.innerHTML&&(c.innerHTML=t[0]),(!Y||2&r)&&V!==(V=Tt(t[1]||"")+"")&&P(f,V),void 0!==t[3]?X?X.p(t,r):(X=Kr(t),X.c(),X.m(y,v)):X&&(X.d(1),X=null);let o=$;$=tt(t),$===o?Q[$].p(t,r):(st(),at(Q[o],1,1,(()=>{Q[o]=null})),lt(),x=Q[$],x?x.p(t,r):(x=Q[$]=J[$](t),x.c()),ct(x,1),x.m(y,T)),t[4]?et?et.p(t,r):(et=Zr(t),et.c(),et.m(y,C)):et&&(et.d(1),et=null),32&r&&j(F,"control-disabled",!t[5]),64&r&&j(B,"control-disabled",!t[6]),512&r&&j(e,"open",t[9])},i(t){Y||(ct(m.$$.fragment,t),ct(x),ct(R.$$.fragment,t),ct(I.$$.fragment,t),Y=!0)},o(t){at(m.$$.fragment,t),at(x),at(R.$$.fragment,t),at(I.$$.fragment,t),Y=!1},d(n){n&&E(e),t[23](null),yt(m),X&&X.d(),Q[$].d(),et&&et.d(),yt(R),yt(I),t[28](null),t[29](null),K=!1,o(G)}}}function Qr(t,e,n){let r;a(t,Ir,(t=>n(13,r=t)));let o,{title:i}=e,{content:s}=e,{needsFetching:l}=e,{url:c}=e,{canFetch:u=!1}=e,{startDrag:d}=e,{moveUp:f}=e,{moveDown:p}=e,{remove:h}=e;l=null==l||l,s=null!=s?s:"";let m,g=!1,b=!1,[y,v]=[];return W((()=>{m&&m.disconnect()})),t.$$set=t=>{"title"in t&&n(0,i=t.title),"content"in t&&n(1,s=t.content),"needsFetching"in t&&n(2,l=t.needsFetching),"url"in t&&n(3,c=t.url),"canFetch"in t&&n(4,u=t.canFetch),"startDrag"in t&&n(20,d=t.startDrag),"moveUp"in t&&n(5,f=t.moveUp),"moveDown"in t&&n(6,p=t.moveDown),"remove"in t&&n(7,h=t.remove)},t.$$.update=()=>{1&t.$$.dirty&&n(0,i=i.replace(/<[^>]*>/g,"")),768&t.$$.dirty&&(null==o||o.scrollTo({left:0})),512&t.$$.dirty&&g&&n(10,b=!0),2100224&t.$$.dirty&&b&&!m&&(n(21,m=new ResizeObserver((()=>n(12,v.style.height=`${y.scrollHeight}px`,v)))),m.observe(y))},[i,s,l,c,u,f,p,h,o,g,b,y,v,r,()=>n(9,g=!g),()=>n(9,g=!0),t=>{"Enter"!==t.key&&13!==t.keyCode||t.preventDefault()},t=>{g||d(t)},t=>{"Enter"!==t.key&&" "!==t.key||g||d(t)},{plugins:"advcode",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | code"},d,m,function(){i=this.innerHTML,n(0,i)},function(t){Y[t?"unshift":"push"]((()=>{o=t,n(8,o)}))},function(){c=this.innerHTML,n(3,c)},function(t){s=t,n(1,s)},function(){s=this.value,n(1,s)},function(){l=this.checked,n(2,l)},function(t){Y[t?"unshift":"push"]((()=>{y=t,n(11,y)}))},function(t){Y[t?"unshift":"push"]((()=>{v=t,n(12,v),n(10,b),n(21,m),n(11,y),n(9,g)}))}]}const to=class extends $t{constructor(t){super(),vt(this,t,Qr,Jr,s,{title:0,content:1,needsFetching:2,url:3,canFetch:4,startDrag:20,moveUp:5,moveDown:6,remove:7})}};function eo(t){let e,n,r;return{c(){e=S("span"),M(e,"class","edit svelte-i66bba"),M(e,"contenteditable",""),void 0===t[0]&&Z((()=>t[8].call(e)))},m(o,i){k(o,e,i),void 0!==t[0]&&(e.innerHTML=t[0]),n||(r=_(e,"input",t[8]),n=!0)},p(t,n){1&n&&t[0]!==e.innerHTML&&(e.innerHTML=t[0])},d(t){t&&E(e),n=!1,r()}}}function no(t){let e,n,r,o=Tt(t[0])+"";return{c(){e=S("a"),n=D(o),M(e,"href",r=Et(t[3])),M(e,"target","_blank")},m(t,r){k(t,e,r),w(e,n)},p(t,i){1&i&&o!==(o=Tt(t[0])+"")&&P(n,o),8&i&&r!==(r=Et(t[3]))&&M(e,"href",r)},d(t){t&&E(e)}}}function ro(t){let e,n,r;return{c(){e=S("span"),M(e,"class","edit svelte-i66bba"),M(e,"contenteditable",""),void 0===t[1]&&Z((()=>t[9].call(e)))},m(o,i){k(o,e,i),void 0!==t[1]&&(e.innerHTML=t[1]),n||(r=_(e,"input",t[9]),n=!0)},p(t,n){2&n&&t[1]!==e.innerHTML&&(e.innerHTML=t[1])},d(t){t&&E(e),n=!1,r()}}}function oo(t){let e,n=Tt(t[1])+"";return{c(){e=D(n)},m(t,n){k(t,e,n)},p(t,r){2&r&&n!==(n=Tt(t[1])+"")&&P(e,n)},d(t){t&&E(e)}}}function io(t){let e,n,r,o;const i=t[7].default,s=u(i,t,t[6],null);return{c(){e=S("h3"),e.textContent="Chapters",n=A(),r=S("div"),s&&s.c(),M(e,"class","svelte-i66bba"),M(r,"class","svelte-i66bba")},m(t,i){k(t,e,i),k(t,n,i),k(t,r,i),s&&s.m(r,null),o=!0},p(t,e){s&&s.p&&(!o||64&e)&&p(s,i,t,t[6],o?f(i,t[6],e,null):h(t[6]),null)},i(t){o||(ct(s,t),o=!0)},o(t){at(s,t),o=!1},d(t){t&&E(e),t&&E(n),t&&E(r),s&&s.d(t)}}}function so(t){let e,n,r,o,s,l,c,a,u,d,f,p;function h(t,e){return t[2]?eo:no}let m=h(t),g=m(t);function b(t,e){return t[2]?ro:oo}let y=b(t),v=y(t),$=t[5].default&&io(t);return{c(){e=S("form"),n=S("h3"),n.textContent="Title",r=A(),o=S("p"),g.c(),s=A(),l=S("h3"),l.textContent="Author",c=A(),a=S("p"),v.c(),u=A(),$&&$.c(),M(n,"class","svelte-i66bba"),M(o,"class","svelte-i66bba"),M(l,"class","svelte-i66bba"),M(a,"class","svelte-i66bba"),M(e,"class","series-card svelte-i66bba")},m(h,m){k(h,e,m),w(e,n),w(e,r),w(e,o),g.m(o,null),w(e,s),w(e,l),w(e,c),w(e,a),v.m(a,null),w(e,u),$&&$.m(e,null),d=!0,f||(p=_(e,"submit",L((function(){i(t[4])&&t[4].apply(this,arguments)}))),f=!0)},p(n,[r]){m===(m=h(t=n))&&g?g.p(t,r):(g.d(1),g=m(t),g&&(g.c(),g.m(o,null))),y===(y=b(t))&&v?v.p(t,r):(v.d(1),v=y(t),v&&(v.c(),v.m(a,null))),t[5].default?$?($.p(t,r),32&r&&ct($,1)):($=io(t),$.c(),ct($,1),$.m(e,null)):$&&(st(),at($,1,1,(()=>{$=null})),lt())},i(t){d||(ct($),d=!0)},o(t){at($),d=!1},d(t){t&&E(e),g.d(),v.d(),$&&$.d(),f=!1,p()}}}function lo(t,e,n){let{$$slots:r={},$$scope:o}=e;const i=function(t){const e={};for(const n in t)e[n]=!0;return e}(r);let{edit:s=!1}=e,{title:l}=e,{author:c}=e,{url:a=""}=e,{onSubmit:u}=e;return t.$$set=t=>{"edit"in t&&n(2,s=t.edit),"title"in t&&n(0,l=t.title),"author"in t&&n(1,c=t.author),"url"in t&&n(3,a=t.url),"onSubmit"in t&&n(4,u=t.onSubmit),"$$scope"in t&&n(6,o=t.$$scope)},[l,c,s,a,u,i,o,r,function(){l=this.innerHTML,n(0,l)},function(){c=this.innerHTML,n(1,c)}]}const co=class extends $t{constructor(t){super(),vt(this,t,lo,so,s,{edit:2,title:0,author:1,url:3,onSubmit:4})}};function ao(t,e,n){const r=t.slice();return r[29]=e[n],r}function uo(t,e,n){const r=t.slice();return r[32]=e[n],r[33]=e,r[34]=n,r}function fo(n,r){let i,s,l,c,a,u,d,f,p,h,m,$=t;function x(t){r[17](t,r[32])}function T(t){r[18](t,r[32])}function C(t){r[19](t,r[32])}function D(t){r[20](t,r[32])}let O={canFetch:!!r[32].apiUrl,startDrag:r[14],moveUp:(r[2]>0||r[34]>0)&&r[7].bind(null,r[34]),moveDown:(r[2]<r[3]||r[34]<r[4].length-1)&&r[8].bind(null,r[34]),remove:r[9].bind(null,r[34])};return void 0!==r[32].title&&(O.title=r[32].title),void 0!==r[32].content&&(O.content=r[32].content),void 0!==r[32].needsFetching&&(O.needsFetching=r[32].needsFetching),void 0!==r[32].displayUrl&&(O.url=r[32].displayUrl),s=new to({props:O}),Y.push((()=>mt(s,"title",x))),Y.push((()=>mt(s,"content",T))),Y.push((()=>mt(s,"needsFetching",C))),Y.push((()=>mt(s,"url",D))),{key:n,first:null,c(){i=S("div"),gt(s.$$.fragment),d=A(),this.first=i},m(t,e){k(t,i,e),bt(s,i,null),w(i,d),p=!0,h||(m=[_(i,"mouseup",r[15]),_(i,"touchend",r[15])],h=!0)},p(t,e){r=t;const n={};16&e[0]&&(n.canFetch=!!r[32].apiUrl),20&e[0]&&(n.moveUp=(r[2]>0||r[34]>0)&&r[7].bind(null,r[34])),28&e[0]&&(n.moveDown=(r[2]<r[3]||r[34]<r[4].length-1)&&r[8].bind(null,r[34])),16&e[0]&&(n.remove=r[9].bind(null,r[34])),!l&&16&e[0]&&(l=!0,n.title=r[32].title,J((()=>l=!1))),!c&&16&e[0]&&(c=!0,n.content=r[32].content,J((()=>c=!1))),!a&&16&e[0]&&(a=!0,n.needsFetching=r[32].needsFetching,J((()=>a=!1))),!u&&16&e[0]&&(u=!0,n.url=r[32].displayUrl,J((()=>u=!1))),s.$set(n)},r(){f=i.getBoundingClientRect()},f(){(function(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,o=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,function(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),o="none"===r.transform?"":r.transform;t.style.transform=`${o} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}(t,o)}})(i),$()},a(){$(),$=function(n,r,o,i){if(!r)return t;const s=n.getBoundingClientRect();if(r.left===s.left&&r.right===s.right&&r.top===s.top&&r.bottom===s.bottom)return t;const{delay:l=0,duration:c=300,easing:a=e,start:u=g()+l,end:d=u+c,tick:f=t,css:p}=o(n,{from:r,to:s},i);let h,m=!0,$=!1;function w(){p&&function(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=n.length-r.length;o&&(t.style.animation=r.join(", "),H-=o,H||b((()=>{H||(R.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),R.clear())})))}(n,h),m=!1}return function(t){let e;0===y.size&&b(v),new Promise((n=>{y.add(e={c:t,f:n})}))}((t=>{if(!$&&t>=u&&($=!0),$&&t>=d&&(f(1,0),w()),!m)return!1;if($){const e=0+1*a((t-u)/c);f(e,1-e)}return!0})),p&&(h=B(n,0,1,c,l,a,p)),l||($=!0),f(0,1),w}(i,f,_r,{duration:bo})},i(t){p||(ct(s.$$.fragment,t),p=!0)},o(t){at(s.$$.fragment,t),p=!1},d(t){t&&E(i),yt(s),h=!1,o(m)}}}function po(t){let e,n,r,o,s,l=t[29]+1+"";return{c(){e=S("a"),n=D(l),M(e,"class","small svelte-5zdmby"),M(e,"href",r=`#page ${t[29]+1}`),M(e,"role","navigation"),j(e,"current",t[29]==t[2])},m(r,l){k(r,e,l),w(e,n),o||(s=_(e,"click",L((function(){i(t[11].bind(null,t[29]))&&t[11].bind(null,t[29]).apply(this,arguments)}))),o=!0)},p(o,i){t=o,12&i[0]&&l!==(l=t[29]+1+"")&&P(n,l),12&i[0]&&r!==(r=`#page ${t[29]+1}`)&&M(e,"href",r),1036&i[0]&&j(e,"current",t[29]==t[2])},d(t){t&&E(e),o=!1,s()}}}function ho(e){let n,r,s,l,c,a,u,d,f,p,h,m,g,b,y,v=[],$=new Map,x=e[4];const C=t=>t[32].id;for(let t=0;t<x.length;t+=1){let n=uo(e,x,t),r=C(n);$.set(r,v[t]=fo(r,n))}let O=e[10](Math.max(0,e[2]-3),Math.min(e[3],e[2]+3)),N=[];for(let t=0;t<O.length;t+=1)N[t]=po(ao(e,O,t));return{c(){n=S("div");for(let t=0;t<v.length;t+=1)v[t].c();s=A(),l=S("nav"),c=S("a"),a=D("Previous"),d=D("\n      ::\n      ");for(let t=0;t<N.length;t+=1)N[t].c();f=D("\n      ::\n      "),p=S("a"),h=D("Next"),M(n,"class","chapters svelte-5zdmby"),M(c,"class","small svelte-5zdmby"),M(c,"href","#prevous"),M(c,"role","navigation"),M(c,"disabled",u=e[2]<=0),M(p,"class","small svelte-5zdmby"),M(p,"href","#next"),M(p,"role","navigation"),M(p,"disabled",m=e[2]>=e[3]),M(l,"class","svelte-5zdmby")},m(o,u){k(o,n,u);for(let t=0;t<v.length;t+=1)v[t].m(n,null);k(o,s,u),k(o,l,u),w(l,c),w(c,a),w(l,d);for(let t=0;t<N.length;t+=1)N[t].m(l,null);var m;w(l,f),w(l,p),w(p,h),g=!0,b||(y=[(m=r=Dr.call(null,n,{items:e[4],dragDisabled:e[5],flipDurationMs:bo}),m&&i(m.destroy)?m.destroy:t),_(n,"consider",e[12]),_(n,"finalize",e[13]),_(c,"click",L(e[21])),_(p,"click",L(e[22]))],b=!0)},p(t,e){if(50076&e[0]){x=t[4],st();for(let t=0;t<v.length;t+=1)v[t].r();v=ht(v,e,C,1,t,x,$,n,pt,fo,null,uo);for(let t=0;t<v.length;t+=1)v[t].a();lt()}if(r&&i(r.update)&&48&e[0]&&r.update.call(null,{items:t[4],dragDisabled:t[5],flipDurationMs:bo}),(!g||4&e[0]&&u!==(u=t[2]<=0))&&M(c,"disabled",u),3084&e[0]){let n;for(O=t[10](Math.max(0,t[2]-3),Math.min(t[3],t[2]+3)),n=0;n<O.length;n+=1){const r=ao(t,O,n);N[n]?N[n].p(r,e):(N[n]=po(r),N[n].c(),N[n].m(l,f))}for(;n<N.length;n+=1)N[n].d(1);N.length=O.length}(!g||12&e[0]&&m!==(m=t[2]>=t[3]))&&M(p,"disabled",m)},i(t){if(!g){for(let t=0;t<x.length;t+=1)ct(v[t]);g=!0}},o(t){for(let t=0;t<v.length;t+=1)at(v[t]);g=!1},d(t){t&&E(n);for(let t=0;t<v.length;t+=1)v[t].d();t&&E(s),t&&E(l),T(N,t),b=!1,o(y)}}}function mo(t){let e,n,r,i,s,l,c,a,u,d,f,p;function h(e){t[24](e)}function m(e){t[25](e)}let g={edit:!0,onSubmit:t[23],$$slots:{default:[ho]},$$scope:{ctx:t}};return void 0!==t[1].title&&(g.title=t[1].title),void 0!==t[1].author&&(g.author=t[1].author),r=new co({props:g}),Y.push((()=>mt(r,"title",h))),Y.push((()=>mt(r,"author",m))),{c(){e=D("You are editing:\n\n"),n=S("div"),gt(r.$$.fragment),l=A(),c=S("button"),c.textContent="Save",a=A(),u=S("a"),u.textContent="Cancel",M(n,"class","list svelte-5zdmby"),M(c,"type","submit"),M(u,"href","#cancel"),M(u,"class","small")},m(o,i){k(o,e,i),k(o,n,i),bt(r,n,null),k(o,l,i),k(o,c,i),k(o,a,i),k(o,u,i),d=!0,f||(p=[_(c,"click",t[26]),_(u,"click",L(t[27]))],f=!0)},p(t,e){const n={};3&e[0]&&(n.onSubmit=t[23]),60&e[0]|16&e[1]&&(n.$$scope={dirty:e,ctx:t}),!i&&2&e[0]&&(i=!0,n.title=t[1].title,J((()=>i=!1))),!s&&2&e[0]&&(s=!0,n.author=t[1].author,J((()=>s=!1))),r.$set(n)},i(t){d||(ct(r.$$.fragment,t),d=!0)},o(t){at(r.$$.fragment,t),d=!1},d(t){t&&E(e),t&&E(n),yt(r),t&&E(l),t&&E(c),t&&E(a),t&&E(u),f=!1,o(p)}}}const go=50,bo=200;function yo(t,e,n){let{bookData:r}=e,{goNext:o}=e;const i=St(r),s=St(r);let l,c,a=0,u=!0;const d=t=>{s.chapters.splice(a*go,go,...t.detail.items),n(1,s)};return t.$$set=t=>{"bookData"in t&&n(16,r=t.bookData),"goNext"in t&&n(0,o=t.goNext)},t.$$.update=()=>{2&t.$$.dirty[0]&&n(3,l=Math.ceil(s.chapters.length/go-1)),6&t.$$.dirty[0]&&n(4,c=s.chapters.slice(a*go,(a+1)*go))},[o,s,a,l,c,u,i,t=>{const e=t+go*a;e<1||(s.chapters.splice(e-1,2,s.chapters[e],s.chapters[e-1]),n(1,s))},t=>{const e=t+go*a;e>=s.chapters.length||(s.chapters.splice(e,2,s.chapters[e+1],s.chapters[e]),n(1,s))},t=>{const e=t+go*a;s.chapters.splice(e,1),n(1,s)},(t,e)=>{const n=new Array(e-t+1);for(let r=t;r<=e;r++)n[r-t]=r;return n},t=>{if(a==t){const t=prompt("New page:",""+(a+1)),e=+t;null!==t&&!isNaN(e)&&e>0&&e<=l+1&&n(2,a=e-1)}else n(2,a=t)},t=>{const{info:{source:e,trigger:r}}=t.detail;d(t),e===Ye&&r===We&&n(5,u=!0)},t=>{const{info:{source:e}}=t.detail;d(t),e===qe&&n(5,u=!0)},t=>{t instanceof KeyboardEvent||t.preventDefault(),n(5,u=!1)},t=>{t.preventDefault(),n(5,u=!0)},r,function(e,r){t.$$.not_equal(r.title,e)&&(r.title=e,n(4,c),n(1,s),n(2,a))},function(e,r){t.$$.not_equal(r.content,e)&&(r.content=e,n(4,c),n(1,s),n(2,a))},function(e,r){t.$$.not_equal(r.needsFetching,e)&&(r.needsFetching=e,n(4,c),n(1,s),n(2,a))},function(e,r){t.$$.not_equal(r.displayUrl,e)&&(r.displayUrl=e,n(4,c),n(1,s),n(2,a))},()=>n(2,a--,a),()=>n(2,a++,a),()=>o(s),function(e){t.$$.not_equal(s.title,e)&&(s.title=e,n(1,s))},function(e){t.$$.not_equal(s.author,e)&&(s.author=e,n(1,s))},()=>o(s),()=>o(i)]}const vo=class extends $t{constructor(t){super(),vt(this,t,yo,mo,s,{bookData:16,goNext:0},null,[-1,-1])}};function $o(t,e,n){const r=t.slice();return r[18]=e[n],r}function wo(t){let e,n,r,o;return e=new Pt({props:{error:t[21],retry:t[16]}}),r=new Lt({props:{backToSearch:t[3]}}),{c(){gt(e.$$.fragment),n=A(),gt(r.$$.fragment)},m(t,i){bt(e,t,i),k(t,n,i),bt(r,t,i),o=!0},p(t,n){const o={};256&n&&(o.error=t[21]),256&n&&(o.retry=t[16]),e.$set(o);const i={};8&n&&(i.backToSearch=t[3]),r.$set(i)},i(t){o||(ct(e.$$.fragment,t),ct(r.$$.fragment,t),o=!0)},o(t){at(e.$$.fragment,t),at(r.$$.fragment,t),o=!1},d(t){yt(e,t),t&&E(n),yt(r,t)}}}function xo(t){let e,n,r,o,i,s,l,c,a,u,d,f;function p(t,e){return(null==i||256&e)&&(i=!!t[17].chapters.find(Mo)),i?Oo:Ao}r=new co({props:{title:t[17].title,author:t[17].author,url:t[0].url,$$slots:{default:[Do]},$$scope:{ctx:t}}});let h=p(t,-1),m=h(t);function g(){return t[15](t[17])}return a=new Lt({props:{backToSearch:t[3]}}),{c(){e=D("Got the following series:\n\n  "),n=S("div"),gt(r.$$.fragment),o=A(),m.c(),s=A(),l=S("button"),l.textContent="Edit book",c=A(),gt(a.$$.fragment),M(n,"class","list svelte-1hsynpq")},m(t,i){k(t,e,i),k(t,n,i),bt(r,n,null),k(t,o,i),m.m(t,i),k(t,s,i),k(t,l,i),k(t,c,i),bt(a,t,i),u=!0,d||(f=_(l,"click",g),d=!0)},p(e,n){t=e;const o={};256&n&&(o.title=t[17].title),256&n&&(o.author=t[17].author),1&n&&(o.url=t[0].url),4194722&n&&(o.$$scope={dirty:n,ctx:t}),r.$set(o),h===(h=p(t,n))&&m?m.p(t,n):(m.d(1),m=h(t),m&&(m.c(),m.m(s.parentNode,s)));const i={};8&n&&(i.backToSearch=t[3]),a.$set(i)},i(t){u||(ct(r.$$.fragment,t),ct(a.$$.fragment,t),u=!0)},o(t){at(r.$$.fragment,t),at(a.$$.fragment,t),u=!1},d(t){t&&E(e),t&&E(n),yt(r),t&&E(o),m.d(t),t&&E(s),t&&E(l),t&&E(c),yt(a,t),d=!1,f()}}}function ko(t){let e;return{c(){e=D("hide")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function Eo(t){let e;return{c(){e=D("show")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function To(t){let e,n,r;return{c(){e=D("Found "),n=D(t[1]),r=D(" new")},m(t,o){k(t,e,o),k(t,n,o),k(t,r,o)},p(t,e){2&e&&P(n,t[1])},d(t){t&&E(e),t&&E(n),t&&E(r)}}}function So(t){let e,n=[],r=new Map,o=t[17].chapters;const i=t=>t[18].id;for(let e=0;e<o.length;e+=1){let s=$o(t,o,e),l=i(s);r.set(l,n[e]=Co(l,s))}return{c(){e=S("div");for(let t=0;t<n.length;t+=1)n[t].c();M(e,"class","chapter-list svelte-1hsynpq")},m(t,r){k(t,e,r);for(let t=0;t<n.length;t+=1)n[t].m(e,null)},p(t,s){256&s&&(o=t[17].chapters,n=ht(n,s,i,1,t,o,r,e,ft,Co,null,$o))},d(t){t&&E(e);for(let t=0;t<n.length;t+=1)n[t].d()}}}function Co(t,e){let n,r,o,i=Tt(e[18].title)+"";return{key:t,first:null,c(){n=S("a"),r=D(i),M(n,"href",o=e[18].displayUrl),M(n,"target","_blank"),M(n,"class","small"),this.first=n},m(t,e){k(t,n,e),w(n,r)},p(t,s){e=t,256&s&&i!==(i=Tt(e[18].title)+"")&&P(r,i),256&s&&o!==(o=e[18].displayUrl)&&M(n,"href",o)},d(t){t&&E(n)}}}function Do(t){let e,n,r,i,s,l,c,a,u,d,f,p,h,m,g=t[17].chapters.length+"";function b(t,e){return t[7]?ko:Eo}let y=b(t),v=y(t);function $(){return t[12](t[17])}let x="number"==typeof t[1]&&To(t),T=t[7]&&So(t);return{c(){e=S("p"),n=D("Found "),r=D(g),i=A(),s=S("a"),v.c(),l=A(),c=S("span"),a=A(),u=S("button"),u.textContent="Find more",d=A(),x&&x.c(),f=A(),T&&T.c(),p=O(),M(s,"href","#show"),M(s,"class","small"),M(c,"class","spacer svelte-1hsynpq"),M(e,"class","no-margin svelte-1hsynpq")},m(o,g){k(o,e,g),w(e,n),w(e,r),w(e,i),w(e,s),v.m(s,null),w(e,l),w(e,c),w(e,a),w(e,u),w(e,d),x&&x.m(e,null),k(o,f,g),T&&T.m(o,g),k(o,p,g),h||(m=[_(s,"click",L(t[11])),_(u,"click",$)],h=!0)},p(n,o){t=n,256&o&&g!==(g=t[17].chapters.length+"")&&P(r,g),y!==(y=b(t))&&(v.d(1),v=y(t),v&&(v.c(),v.m(s,null))),"number"==typeof t[1]?x?x.p(t,o):(x=To(t),x.c(),x.m(e,null)):x&&(x.d(1),x=null),t[7]?T?T.p(t,o):(T=So(t),T.c(),T.m(p.parentNode,p)):T&&(T.d(1),T=null)},d(t){t&&E(e),v.d(),x&&x.d(),t&&E(f),T&&T.d(t),t&&E(p),h=!1,o(m)}}}function Ao(t){let e,n,r;function o(){return t[14](t[17])}return{c(){e=S("button"),e.textContent="Generate EPUB"},m(t,i){k(t,e,i),n||(r=_(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&E(e),n=!1,r()}}}function Oo(t){let e,n,r;function o(){return t[13](t[17])}return{c(){e=S("button"),e.textContent="Fetch chapter contents"},m(t,i){k(t,e,i),n||(r=_(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&E(e),n=!1,r()}}}function _o(t){let e,n;return e=new Rt({props:{$$slots:{default:[Lo]},$$scope:{ctx:t}}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};4194304&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Lo(t){let e;return{c(){e=D("Please wait, fetching data...")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function No(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:_o,then:xo,catch:wo,value:17,error:21,blocks:[,,,]};return ut(n=t[8],o),{c(){e=O(),o.block.c()},m(t,n){k(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,256&r&&n!==(n=t[8])&&ut(n,o)||dt(o,t,r)},i(t){r||(ct(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)at(o.blocks[t]);r=!1},d(t){t&&E(e),o.block.d(t),o.token=null,o=null}}}const Mo=t=>!1!==t.needsFetching;function Po(t,e,n){let{series:r}=e,{bookData:o}=e,{newChapters:i}=e,{goNext:s}=e,{backToSearch:l}=e,{edit:c}=e,{findMore:a}=e,{downloadAll:u}=e,d=!1;const f=()=>o?Promise.resolve(St(o)):function(t){return e=void 0,n=void 0,o=function(){var e,n,r;return function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(o){switch(o.label){case 0:return[4,ne(t.url)];case 1:return[4,(e=o.sent()).json()];case 2:if(n=o.sent(),!e.ok)throw n.message;if(!(r=function(t,e){switch(t){case oe.HFY_SERIES:return s=(i=e.data).content_md,l=i.content_html,c=(new DOMParser).parseFromString(Tt(l),"text/html").querySelectorAll("a[href]"),{author:null===(n=s.match(/\[\*\*(?:Author\s*[-:]\s*)?([^*\]]+)\*\*\]|A Story By \[(?:\*\*)?([^\]]+?)(?:\*\*)?\]/i).slice(1).find(Boolean))||void 0===n?void 0:n.trim(),title:null===(o=null===(r=s.match(/##?\s*\*\*(.+)\*\*/))||void 0===r?void 0:r[1])||void 0===o?void 0:o.trim(),chapters:Array.from(c).filter((function(t){return t.getAttribute("href").match(ie)})).map((function(t){var e=t.getAttribute("href").startsWith("http")?t.getAttribute("href"):"https://www.reddit.com"+t.getAttribute("href");return{id:re(),title:t.textContent.trim(),apiUrl:kt(e),displayUrl:e}}))};case oe.POST:return function(t){return{author:t[0].data.children[0].data.author,title:t[0].data.children[0].data.title,chapters:[ae(t)]}}(e)}var n,r,o,i,s,l,c;throw new Error("Getting data from source type `"+oe[t]+"` not supported, this should never happen")}(t.type,n))||!r.chapters||!r.chapters.length)throw new Error("No chapters found");return[2,r]}}))},new((r=void 0)||(r=Promise))((function(t,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function l(t){try{c(o.throw(t))}catch(t){i(t)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(s,l)}c((o=o.apply(e,n||[])).next())}));var e,n,r,o}(r);let p=f();return t.$$set=t=>{"series"in t&&n(0,r=t.series),"bookData"in t&&n(10,o=t.bookData),"newChapters"in t&&n(1,i=t.newChapters),"goNext"in t&&n(2,s=t.goNext),"backToSearch"in t&&n(3,l=t.backToSearch),"edit"in t&&n(4,c=t.edit),"findMore"in t&&n(5,a=t.findMore),"downloadAll"in t&&n(6,u=t.downloadAll)},[r,i,s,l,c,a,u,d,p,f,o,()=>n(7,d=!d),t=>a(t),t=>u(t),t=>s(t),t=>c(t),()=>n(8,p=f())]}const Fo=class extends $t{constructor(t){super(),vt(this,t,Po,No,s,{series:0,bookData:10,newChapters:1,goNext:2,backToSearch:3,edit:4,findMore:5,downloadAll:6})}};function jo(t,e,n){const r=t.slice();return r[8]=e[n],r}function Ro(t){let e,n;return e=new Pt({props:{error:t[11],retry:t[5]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[11]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function Uo(e){let n,r,o,i,s,l,c,a,u=e[7],d=[];for(let t=0;t<u.length;t+=1)d[t]=Bo(jo(e,u,t));return{c(){n=S("p"),r=D("The search for '"),o=D(e[0]),i=D("' returned these results:"),s=A(),l=S("ul");for(let t=0;t<d.length;t+=1)d[t].c();c=A(),a=S("p"),a.textContent="Please select one.",M(a,"class","small")},m(t,e){k(t,n,e),w(n,r),w(n,o),w(n,i),k(t,s,e),k(t,l,e);for(let t=0;t<d.length;t+=1)d[t].m(l,null);k(t,c,e),k(t,a,e)},p(t,e){if(1&e&&P(o,t[0]),6&e){let n;for(u=t[7],n=0;n<u.length;n+=1){const r=jo(t,u,n);d[n]?d[n].p(r,e):(d[n]=Bo(r),d[n].c(),d[n].m(l,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=u.length}},i:t,o:t,d(t){t&&E(n),t&&E(s),t&&E(l),T(d,t),t&&E(c),t&&E(a)}}}function Ho(t){let e,n,r,o,i=t[8].author+"";return{c(){e=D("["),n=S("i"),r=D(i),o=D("]")},m(t,i){k(t,e,i),k(t,n,i),w(n,r),k(t,o,i)},p(t,e){4&e&&i!==(i=t[8].author+"")&&P(r,i)},d(t){t&&E(e),t&&E(n),t&&E(o)}}}function Bo(t){let e,n,r,o,i,s,l,c,a=t[8].title+"";function u(){return t[4](t[8])}let d=t[8].author&&Ho(t);return{c(){e=S("li"),n=S("a"),r=D(a),i=A(),d&&d.c(),s=A(),M(n,"href",o=Et(t[8].url))},m(t,o){k(t,e,o),w(e,n),w(n,r),w(e,i),d&&d.m(e,null),w(e,s),l||(c=_(n,"click",L(u)),l=!0)},p(i,l){t=i,4&l&&a!==(a=t[8].title+"")&&P(r,a),4&l&&o!==(o=Et(t[8].url))&&M(n,"href",o),t[8].author?d?d.p(t,l):(d=Ho(t),d.c(),d.m(e,s)):d&&(d.d(1),d=null)},d(t){t&&E(e),d&&d.d(),l=!1,c()}}}function Io(t){let e,n;return e=new Rt({props:{$$slots:{default:[zo]},$$scope:{ctx:t}}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function zo(t){let e;return{c(){e=D("Please wait, fetching results...")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function Wo(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Io,then:Uo,catch:Ro,value:7,error:11,blocks:[,,,]};return ut(n=t[2],o),{c(){e=O(),o.block.c()},m(t,n){k(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&ut(n,o)||dt(o,t,r)},i(t){r||(ct(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)at(o.blocks[t]);r=!1},d(t){t&&E(e),o.block.d(t),o.token=null,o=null}}}function qo(t,e,n){let{search:r}=e,{goNext:o}=e;const i=r.toLowerCase(),s=()=>ne("https://api.reddit.com/r/hfy/wiki/series.json").then((t=>t.json())).then((t=>t.data.content_md)).then((t=>[...t.matchAll(/\[([^\]]+)\]\s*\(((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/hfy\/wiki\/series\/[^)]+)\)\s*(?:\[\*([^\]]+)\*\])?/gim)].map((t=>({title:t[1],author:t[3],url:kt(t[2].startsWith("http")?t[2]:`https://api.reddit.com${t[2]}`)}))))).then((t=>t.filter((t=>-1!==t.title.toLowerCase().indexOf(i))))).then((t=>{if(!t.length)throw new Error(`No series matched input \`${r}\``);return t}));let l=s();return t.$$set=t=>{"search"in t&&n(0,r=t.search),"goNext"in t&&n(1,o=t.goNext)},[r,o,l,s,t=>o({url:t.url,type:oe.HFY_SERIES}),()=>n(2,l=s())]}const Yo=class extends $t{constructor(t){super(),vt(this,t,qo,Wo,s,{search:0,goNext:1})}};function Ko(t){let e;return{c(){e=S("p"),e.textContent="Please enter a search string",M(e,"class","small error svelte-1z0xb0f")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function Go(e){let n,r,i,s,l,c,a,u,d,f,p,h,m,g,b,y=!e[0].trim().length,v=y&&Ko();return{c(){n=S("h2"),n.innerHTML='Please enter your search terms below: <a class="small" href="https://github.com/cpiber/hfy-epub/tree/master/docs/index.md" target="_blank">Help</a>',r=A(),i=S("form"),s=S("p"),l=S("input"),c=A(),a=S("input"),d=A(),v&&v.c(),f=A(),p=S("p"),p.textContent="You can:",h=A(),m=S("ul"),m.innerHTML='<li>Search for a series title on the <a href="https://reddit.com/r/HFY/wiki/series" target="_blank">r/HFY wiki</a></li> \n  <li>Enter a series link to the <a href="https://reddit.com/r/HFY" target="_blank">r/HFY</a> wiki</li> \n  <li>Enter a link to any reddit post</li>',M(n,"class","heading svelte-1z0xb0f"),M(l,"class","search svelte-1z0xb0f"),M(l,"placeholder","Search or URL..."),M(a,"type","submit"),a.value="Go",M(a,"class","submit svelte-1z0xb0f"),a.disabled=u=!e[0].trim().length,M(a,"name","search"),M(s,"class","svelte-1z0xb0f"),M(i,"class","form svelte-1z0xb0f"),M(p,"class","spaceabove svelte-1z0xb0f")},m(t,o){k(t,n,o),k(t,r,o),k(t,i,o),w(i,s),w(s,l),F(l,e[0]),w(s,c),w(s,a),k(t,d,o),v&&v.m(t,o),k(t,f,o),k(t,p,o),k(t,h,o),k(t,m,o),g||(b=[_(l,"input",e[2]),_(i,"submit",N(e[3]))],g=!0)},p(t,[e]){1&e&&l.value!==t[0]&&F(l,t[0]),1&e&&u!==(u=!t[0].trim().length)&&(a.disabled=u),1&e&&(y=!t[0].trim().length),y?v||(v=Ko(),v.c(),v.m(f.parentNode,f)):v&&(v.d(1),v=null)},i:t,o:t,d(t){t&&E(n),t&&E(r),t&&E(i),t&&E(d),v&&v.d(t),t&&E(f),t&&E(p),t&&E(h),t&&E(m),g=!1,o(b)}}}function Vo(t,e,n){let{search:r=""}=e,{goNext:o}=e;return t.$$set=t=>{"search"in t&&n(0,r=t.search),"goNext"in t&&n(1,o=t.goNext)},[r,o,function(){r=this.value,n(0,r)},()=>o(r)]}const Xo=class extends $t{constructor(t){super(),vt(this,t,Vo,Go,s,{search:0,goNext:1})}};function Zo(e){let n;return{c(){n=S("header"),n.innerHTML='<h1 class="svelte-16374ub">r/HFY epub generator</h1>',M(n,"class","svelte-16374ub")},m(t,e){k(t,n,e)},p:t,i:t,o:t,d(t){t&&E(n)}}}const Jo=class extends $t{constructor(t){super(),vt(this,t,null,Zo,s,{})}};function Qo(t){let e;return{c(){e=S("p"),e.innerHTML='This website (<a href="https://cpiber.github.io/hfy-epub" target="_blank">https://cpiber.github.io/hfy-epub</a>) does not, and will not, collect any data from its users.\n      Any actions taken on this page are purely in the user&#39;s browser; there is no server-side component.\n      No data is ever sent away.\n      For collecting the chapter data, this site contacts <code>https://api.reddit.com</code> only. The book is generated in the browser.',M(e,"class","small svelte-1f8pws6")},m(t,n){k(t,e,n)},d(t){t&&E(e)}}}function ti(e){let n,r,i,s,l,c,a,u,d,f,p,h,m,g,b,y,v,$,x=e[0]&&Qo();return{c(){n=S("footer"),r=S("p"),i=D("Made by "),s=S("a"),s.textContent="@cpiber",l=D(".\n    Source Code: "),c=S("a"),c.textContent="cpiber/hfy-epub",a=D(".\n    \n    Version "),u=D("0.2.2"),d=D(".\n    "),f=S("a"),f.textContent="Privacy",p=D("."),h=A(),x&&x.c(),m=A(),g=S("label"),b=S("input"),y=D(" Use TinyMCE chapter editor"),M(s,"href","https://github.com/cpiber"),M(s,"target","_blank"),M(c,"href","https://github.com/cpiber/hfy-epub"),M(c,"target","_blank"),M(f,"href","#privacy"),M(r,"class","small svelte-1f8pws6"),M(b,"type","checkbox"),M(b,"aria-label","use TinyMCE editor"),M(b,"class","svelte-1f8pws6"),M(g,"class","small svelte-1f8pws6"),M(n,"class","svelte-1f8pws6")},m(t,o){k(t,n,o),w(n,r),w(r,i),w(r,s),w(r,l),w(r,c),w(r,a),w(r,u),w(r,d),w(r,f),w(r,p),w(n,h),x&&x.m(n,null),w(n,m),w(n,g),w(g,b),b.checked=e[1].useTiny,w(g,y),v||($=[_(f,"click",L(e[2])),_(b,"change",e[3])],v=!0)},p(t,[e]){t[0]?x||(x=Qo(),x.c(),x.m(n,m)):x&&(x.d(1),x=null),2&e&&(b.checked=t[1].useTiny)},i:t,o:t,d(t){t&&E(n),x&&x.d(),v=!1,o($)}}}function ei(t,e,n){let r;a(t,Ir,(t=>n(1,r=t)));let o=!1;return[o,r,()=>n(0,o=!o),function(){r.useTiny=this.checked,Ir.set(r)}]}const ni=class extends $t{constructor(t){super(),vt(this,t,ei,ti,s,{})}};function ri(t){let e,n;return e=new Jt({props:{data:t[4],backToSearch:t[6],backToBook:t[18]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};16&n&&(r.data=t[4]),64&n&&(r.backToSearch=t[6]),3&n&&(r.backToBook=t[18]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function oi(t){let e,n;return e=new $e({props:{goNext:t[17],data:t[4]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};51&n&&(r.goNext=t[17]),16&n&&(r.data=t[4]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ii(t){let e,n;return e=new Ae({props:{goNext:t[16],bookData:t[4]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};51&n&&(r.goNext=t[16]),16&n&&(r.bookData=t[4]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function si(t){let e,n;return e=new vo({props:{goNext:t[15],bookData:t[4]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};51&n&&(r.goNext=t[15]),16&n&&(r.bookData=t[4]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function li(t){let e,n;return e=new Fo({props:{goNext:t[11],series:t[3],bookData:t[4],newChapters:t[5],backToSearch:t[6],edit:t[12],findMore:t[13],downloadAll:t[14]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};19&n&&(r.goNext=t[11]),8&n&&(r.series=t[3]),16&n&&(r.bookData=t[4]),32&n&&(r.newChapters=t[5]),64&n&&(r.backToSearch=t[6]),19&n&&(r.edit=t[12]),19&n&&(r.findMore=t[13]),19&n&&(r.downloadAll=t[14]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ci(t){let e,n;return e=new Yo({props:{goNext:t[10],search:t[2]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};11&n&&(r.goNext=t[10]),4&n&&(r.search=t[2]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ai(t){let e,n;return e=new Xo({props:{goNext:t[7],search:t[2]}}),{c(){gt(e.$$.fragment)},m(t,r){bt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.search=t[2]),e.$set(r)},i(t){n||(ct(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){yt(e,t)}}}function ui(e){let n,r,o,i,s;return{c(){n=S("div"),r=A(),o=S("a"),o.textContent="Go back home",M(o,"href","#home"),M(o,"class","homelink svelte-1kaj6z6")},m(t,l){k(t,n,l),k(t,r,l),k(t,o,l),i||(s=_(o,"click",L(e[19])),i=!0)},p:t,d(t){t&&E(n),t&&E(r),t&&E(o),i=!1,s()}}}function di(t){let e,n,r,o,i,s,l,c,a,u;n=new Jo({});const d=[ai,ci,li,si,ii,oi,ri],f=[];function p(t,e){return t[1]===t[0].INPUT?0:t[1]===t[0].SEARCH?1:t[1]===t[0].BOOK_DATA?2:t[1]===t[0].EDIT_DATA?3:t[1]===t[0].FIND_CHAPTERS?4:t[1]===t[0].DOWNLOAD_CHAPTERS?5:t[1]===t[0].RESULT?6:-1}~(i=p(t))&&(s=f[i]=d[i](t));let h=t[1]!==t[0].INPUT&&ui(t);return a=new ni({}),{c(){e=S("div"),gt(n.$$.fragment),r=A(),o=S("main"),s&&s.c(),l=A(),h&&h.c(),c=A(),gt(a.$$.fragment),M(o,"class","App-main"),M(e,"class","App svelte-1kaj6z6")},m(t,s){k(t,e,s),bt(n,e,null),w(e,r),w(e,o),~i&&f[i].m(o,null),w(o,l),h&&h.m(o,null),w(e,c),bt(a,e,null),u=!0},p(t,[e]){let n=i;i=p(t),i===n?~i&&f[i].p(t,e):(s&&(st(),at(f[n],1,1,(()=>{f[n]=null})),lt()),~i?(s=f[i],s?s.p(t,e):(s=f[i]=d[i](t),s.c()),ct(s,1),s.m(o,l)):s=null),t[1]!==t[0].INPUT?h?h.p(t,e):(h=ui(t),h.c(),h.m(o,null)):h&&(h.d(1),h=null)},i(t){u||(ct(n.$$.fragment,t),ct(s),ct(a.$$.fragment,t),u=!0)},o(t){at(n.$$.fragment,t),at(s),at(a.$$.fragment,t),u=!1},d(t){t&&E(e),yt(n),~i&&f[i].d(),h&&h.d(),yt(a)}}}function fi(t,e,n){let r;var o;a(t,Ir,(t=>n(9,r=t))),function(t){t[t.INPUT=0]="INPUT",t[t.SEARCH=1]="SEARCH",t[t.BOOK_DATA=2]="BOOK_DATA",t[t.EDIT_DATA=3]="EDIT_DATA",t[t.FIND_CHAPTERS=4]="FIND_CHAPTERS",t[t.DOWNLOAD_CHAPTERS=5]="DOWNLOAD_CHAPTERS",t[t.RESULT=6]="RESULT"}(o||(o={}));let i,s,l,c,u,d=o.INPUT,f=!1;return t.$$.update=()=>{257&t.$$.dirty&&n(6,u=f?()=>n(1,d=o.SEARCH):void 0),t.$$.dirty,3&t.$$.dirty&&(d!==o.INPUT&&d!==o.SEARCH||(n(4,l=void 0),n(5,c=void 0))),512&t.$$.dirty&&localStorage.setItem("config",JSON.stringify(r))},[o,d,i,s,l,c,u,t=>{const e=function(t){try{if(new URL(t),function(t){return!!t.match(le)}(t))return oe.HFY_SERIES;if(function(t){return!!t.match(ce)}(t))return oe.POST}catch(t){}return oe.SEARCH}(t);return n(2,i=t),n(8,f=e===oe.SEARCH),e!==oe.SEARCH&&n(3,s={url:kt(t),type:e}),e===oe.SEARCH?n(1,d=o.SEARCH):n(1,d=o.BOOK_DATA)},f,r,t=>(n(3,s=t),n(1,d=o.BOOK_DATA)),t=>(n(4,l=t),n(1,d=o.RESULT)),t=>(n(4,l=t),n(1,d=o.EDIT_DATA)),t=>(n(4,l=t),n(1,d=o.FIND_CHAPTERS)),t=>(n(4,l=t),n(1,d=o.DOWNLOAD_CHAPTERS)),t=>(n(4,l=t),n(5,c=void 0),n(1,d=o.BOOK_DATA)),(t,e)=>(n(4,l=t),n(5,c=e),n(1,d=o.BOOK_DATA)),t=>(n(4,l=t),n(5,c=void 0),n(1,d=o.BOOK_DATA)),()=>n(1,d=o.BOOK_DATA),()=>n(1,d=o.INPUT)]}!function(){try{var t=JSON.parse(localStorage.getItem("config"));Ir.set(function(t){var e,n;if(!t||""+t!="[object Object]")return Br;var r=Object.keys(t),o=Object.keys(Br);try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),s=i.next();!s.done;s=i.next()){var l=s.value;r.includes(l)||(t[l]=Br[l]),typeof Br[l]!=typeof t[l]&&(t[l]=Br[l])}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return t}(t))}catch(t){}}();const pi=class extends $t{constructor(t){super(),vt(this,t,fi,di,s,{})}};let hi;try{hi=new pi({target:document.body})}catch(t){const e=document.createElement("div");e.className="fatal-error",e.ariaLabel="error",e.appendChild(document.createElement("h1")).textContent="Something went wrong:",e.appendChild(document.createElement("code")).textContent=t,document.body.appendChild(e)}})(),c=l.O(c)})();