(()=>{var t,e,n,o,r,i={4785:function(t,e){var n,o;void 0===(o="function"==typeof(n=function(){return function t(e,n,o){var r,i,s=window,l="application/octet-stream",c=o||l,a=e,u=!n&&!o&&a,d=document.createElement("a"),p=function(t){return String(t)},f=s.Blob||s.MozBlob||s.WebKitBlob||p,h=n||"download";if(f=f.call?f.bind(s):Blob,"true"===String(this)&&(c=(a=[a,c])[0],a=a[1]),u&&u.length<2048&&(h=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(e){t(e.target.response,h,l)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(a)){if(!(a.length>2096103.424&&f!==p))return navigator.msSaveBlob?navigator.msSaveBlob(y(a),h):v(a);c=(a=y(a)).type||l}else if(/([\x80-\xff])/.test(a)){for(var g=0,b=new Uint8Array(a.length),$=b.length;g<$;++g)b[g]=a.charCodeAt(g);a=new f([b],{type:c})}function y(t){for(var e=t.split(/[:;,]/),n=e[1],o=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=o.length,i=0,s=new Uint8Array(r);i<r;++i)s[i]=o.charCodeAt(i);return new f([s],{type:n})}function v(t,e){if("download"in d)return d.href=t,d.setAttribute("download",h),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){s.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(r=a instanceof f?a:new f([a],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(r,h);if(s.URL)v(s.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===p)try{return v("data:"+c+";base64,"+s.btoa(r))}catch(t){return v("data:"+c+","+encodeURIComponent(r))}(i=new FileReader).onload=function(t){v(this.result)},i.readAsDataURL(r)}return!0}})?n.apply(e,[]):n)||(t.exports=o)}},s={};function l(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={id:t,loaded:!1,exports:{}};return i[t].call(n.exports,n,n.exports,l),n.loaded=!0,n.exports}l.m=i,t=[],l.O=(e,n,o,r)=>{if(!n){var i=1/0;for(u=0;u<t.length;u++){for(var[n,o,r]=t[u],s=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(l.O).every((t=>l.O[t](n[c])))?n.splice(c--,1):(s=!1,r<i&&(i=r));if(s){t.splice(u--,1);var a=o();void 0!==a&&(e=a)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[n,o,r]},l.F={},l.E=t=>{Object.keys(l.F).map((e=>{l.F[e](t)}))},l.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return l.d(e,{a:e}),e},n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,l.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var r=Object.create(null);l.r(r);var i={};e=e||[null,n({}),n([]),n(n)];for(var s=2&o&&t;"object"==typeof s&&!~e.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,l.d(r,i),r},l.d=(t,e)=>{for(var n in e)l.o(e,n)&&!l.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},l.f={},l.e=t=>Promise.all(Object.keys(l.f).reduce(((e,n)=>(l.f[n](t,e),e)),[])),l.u=t=>t+"-"+{483:"fefd040803c093fe8d27",845:"74c785c44477a9538d2c"}[t]+".js",l.miniCssF=t=>{},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),l.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o={},r="hfy-epub:",l.l=(t,e,n,i)=>{if(o[t])o[t].push(e);else{var s,c;if(void 0!==n)for(var a=document.getElementsByTagName("script"),u=0;u<a.length;u++){var d=a[u];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==r+n){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,l.nc&&s.setAttribute("nonce",l.nc),s.setAttribute("data-webpack",r+n),s.src=t),o[t]=[e];var p=(e,n)=>{s.onerror=s.onload=null,clearTimeout(f);var r=o[t];if(delete o[t],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((t=>t(n))),e)return e(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),c&&document.head.appendChild(s)}},l.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;l.g.importScripts&&(t=l.g.location+"");var e=l.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=t})(),(()=>{var t={179:0};l.f.j=(e,n)=>{var o=l.o(t,e)?t[e]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,r)=>o=t[e]=[n,r]));n.push(o[2]=r);var i=l.p+l.u(e),s=new Error;l.l(i,(n=>{if(l.o(t,e)&&(0!==(o=t[e])&&(t[e]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",s.name="ChunkLoadError",s.type=r,s.request=i,o[1](s)}}),"chunk-"+e,e)}},l.F.j=e=>{if(!l.o(t,e)||void 0===t[e]){t[e]=null;var n=document.createElement("link");l.nc&&n.setAttribute("nonce",l.nc),n.rel="prefetch",n.as="script",n.href=l.p+l.u(e),document.head.appendChild(n)}},l.O.j=e=>0===t[e];var e=(e,n)=>{var o,r,[i,s,c]=n,a=0;if(i.some((e=>0!==t[e]))){for(o in s)l.o(s,o)&&(l.m[o]=s[o]);if(c)var u=c(l)}for(e&&e(n);a<i.length;a++)r=i[a],l.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return l.O(u)},n=self.webpackChunkhfy_epub=self.webpackChunkhfy_epub||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),l.O(0,[179],(()=>{l.E(845),l.E(483)}),5);var c={};(()=>{"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function o(t){return t()}function r(){return Object.create(null)}function i(t){t.forEach(o)}function s(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t){return 0===Object.keys(t).length}function u(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function d(t,e,n,o){if(t){const r=p(t,e,n,o);return t[0](r)}}function p(t,e,o,r){return t[1]&&r?n(o.ctx.slice(),t[1](r(e))):o.ctx}function f(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}function h(t,e,n,o,r,i){if(r){const s=p(e,n,o,i);t.p(s,r)}}function m(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}const g="undefined"!=typeof window;let b=g?()=>window.performance.now():()=>Date.now(),$=g?t=>requestAnimationFrame(t):t;const y=new Set;function v(t){y.forEach((e=>{e.c(t)||(y.delete(e),e.f())})),0!==y.size&&$(v)}let w=!1;function x(t,e){t.appendChild(e)}function k(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function E(t){const e=D("style");return function(t,e){x(t.head||t,e)}(k(t),e),e.sheet}function T(t,e,n){t.insertBefore(e,n||null)}function C(t){t.parentNode.removeChild(t)}function S(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function D(t){return document.createElement(t)}function A(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function O(t){return document.createTextNode(t)}function L(){return O(" ")}function N(){return O("")}function _(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function M(t){return function(e){return e.preventDefault(),t.call(this,e)}}function j(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function P(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function F(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function R(t,e){t.value=null==e?"":e}function U(t,e,n){t.classList[n?"add":"remove"](e)}function I(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,o,e),r}const H=new Map;let B,z=0;function W(t,e,n,o,r,i,s,l=0){const c=16.666/o;let a="{\n";for(let t=0;t<=1;t+=c){const o=e+(n-e)*i(t);a+=100*t+`%{${s(o,1-o)}}\n`}const u=a+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,p=k(t),{stylesheet:f,rules:h}=H.get(p)||function(t,e){const n={stylesheet:E(e),rules:{}};return H.set(t,n),n}(p,t);h[d]||(h[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${d} ${o}ms linear ${r}ms 1 both`,z+=1,d}function q(t){B=t}function Y(){if(!B)throw new Error("Function called outside component initialization");return B}const K=[],G=[],V=[],X=[],Z=Promise.resolve();let J=!1;function Q(t){V.push(t)}function tt(t){X.push(t)}const et=new Set;let nt,ot=0;function rt(){const t=B;do{for(;ot<K.length;){const t=K[ot];ot++,q(t),it(t.$$)}for(q(null),K.length=0,ot=0;G.length;)G.pop()();for(let t=0;t<V.length;t+=1){const e=V[t];et.has(e)||(et.add(e),e())}V.length=0}while(K.length);for(;X.length;)X.pop()();J=!1,et.clear(),q(t)}function it(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Q)}}function st(t,e,n){t.dispatchEvent(I(`${e?"intro":"outro"}${n}`))}const lt=new Set;let ct;function at(){ct={r:0,c:[],p:ct}}function ut(){ct.r||i(ct.c),ct=ct.p}function dt(t,e){t&&t.i&&(lt.delete(t),t.i(e))}function pt(t,e,n,o){if(t&&t.o){if(lt.has(t))return;lt.add(t),ct.c.push((()=>{lt.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}const ft={duration:0};function ht(n,o,r,l){let c=o(n,r),a=l?0:1,u=null,d=null,p=null;function f(){p&&function(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),r=n.length-o.length;r&&(t.style.animation=o.join(", "),z-=r,z||$((()=>{z||(H.forEach((t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}})),H.clear())})))}(n,p)}function h(t,e){const n=t.b-a;return e*=Math.abs(n),{a,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function m(o){const{delay:r=0,duration:s=300,easing:l=e,tick:m=t,css:g}=c||ft,w={start:b()+r,b:o};o||(w.group=ct,ct.r+=1),u||d?d=w:(g&&(f(),p=W(n,a,o,s,r,l,g)),o&&m(0,1),u=h(w,s),Q((()=>st(n,o,"start"))),function(t){let e;0===y.size&&$(v),new Promise((n=>{y.add(e={c:t,f:n})}))}((t=>{if(d&&t>d.start&&(u=h(d,s),d=null,st(n,u.b,"start"),g&&(f(),p=W(n,a,u.b,u.duration,0,l,c.css))),u)if(t>=u.end)m(a=u.b,1-a),st(n,u.b,"end"),d||(u.b?f():--u.group.r||i(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;a=u.a+u.d*l(e/u.duration),m(a,1-a)}return!(!u&&!d)})))}return{run(t){s(c)?(nt||(nt=Promise.resolve(),nt.then((()=>{nt=null}))),nt).then((()=>{c=c(),m(t)})):m(t)},end(){f(),u=d=null}}}function mt(t,e){const n=e.token={};function o(t,o,r,i){if(e.token!==n)return;e.resolved=i;let s=e.ctx;void 0!==r&&(s=s.slice(),s[r]=i);const l=t&&(e.current=t)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(at(),pt(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ut())})):e.block.d(1),l.c(),dt(l,1),l.m(e.mount(),e.anchor),c=!0),e.block=l,e.blocks&&(e.blocks[o]=l),c&&rt()}if((r=t)&&"object"==typeof r&&"function"==typeof r.then){const n=Y();if(t.then((t=>{q(n),o(e.then,1,e.value,t),q(null)}),(t=>{if(q(n),o(e.catch,2,e.error,t),q(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}var r}function gt(t,e,n){const o=e.slice(),{resolved:r}=t;t.current===t.then&&(o[t.value]=r),t.current===t.catch&&(o[t.error]=r),t.block.p(o,n)}function bt(t,e){t.d(1),e.delete(t.key)}function $t(t,e){pt(t,1,1,(()=>{e.delete(t.key)}))}function yt(t,e,n,o,r,i,s,l,c,a,u,d){let p=t.length,f=i.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const g=[],b=new Map,$=new Map;for(h=f;h--;){const t=d(r,i,h),l=n(t);let c=s.get(l);c?o&&c.p(t,e):(c=a(l,t),c.c()),b.set(l,g[h]=c),l in m&&$.set(l,Math.abs(h-m[l]))}const y=new Set,v=new Set;function w(t){dt(t,1),t.m(l,u),s.set(t.key,t),u=t.first,f--}for(;p&&f;){const e=g[f-1],n=t[p-1],o=e.key,r=n.key;e===n?(u=e.first,p--,f--):b.has(r)?!s.has(o)||y.has(o)?w(e):v.has(r)?p--:$.get(o)>$.get(r)?(v.add(o),w(e)):(y.add(r),p--):(c(n,s),p--)}for(;p--;){const e=t[p];b.has(e.key)||c(e,s)}for(;f;)w(g[f-1]);return g}let vt;function wt(t,e,n){const o=t.$$.props[e];void 0!==o&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function xt(t){t&&t.c()}function kt(t,e,n,r){const{fragment:l,on_mount:c,on_destroy:a,after_update:u}=t.$$;l&&l.m(e,n),r||Q((()=>{const e=c.map(o).filter(s);a?a.push(...e):i(e),t.$$.on_mount=[]})),u.forEach(Q)}function Et(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Tt(e,n,o,s,l,c,a,u=[-1]){const d=B;q(e);const p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(p.root);let f=!1;if(p.ctx=o?o(e,n.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=r)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](r),f&&function(t,e){-1===t.$$.dirty[0]&&(K.push(t),J||(J=!0,Z.then(rt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],p.update(),f=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),n.target){if(n.hydrate){w=!0;const t=(h=n.target,Array.from(h.childNodes));p.fragment&&p.fragment.l(t),t.forEach(C)}else p.fragment&&p.fragment.c();n.intro&&dt(e.$$.fragment),kt(e,n.target,n.anchor,n.customElement),w=!1,rt()}var h;q(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(vt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(o).filter(s);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){i(this.$$.on_disconnect)}$destroy(){Et(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class Ct{$destroy(){Et(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const St=t=>(t instanceof URL||(t=new URL(t)),t.hostname="www.reddit.com",t.pathname.endsWith("/")?t.pathname=`${t.pathname.slice(0,t.pathname.length-1)}.json`:t.pathname.endsWith(".json")||(t.pathname+=".json"),t.protocol="https",t.search="",t.hash="",t.toString()),Dt=t=>t.slice(0,-5).replace("https://api","https://www"),At=(()=>{const t=new DOMParser;return e=>t.parseFromString(e,"text/html").documentElement.textContent})(),Ot=t=>Object.assign(Object.assign({},t),{chapters:t.chapters.map((t=>Object.assign({},t)))});var Lt=l(4785),Nt=l.n(Lt);function _t(t){let e,n,o;return{c(){e=D("a"),e.textContent="Back to Search",P(e,"href","#search"),P(e,"class","small")},m(r,i){T(r,e,i),n||(o=_(e,"click",M((function(){s(t[0])&&t[0].apply(this,arguments)}))),n=!0)},p(e,n){t=e},d(t){t&&C(e),n=!1,o()}}}function Mt(e){let n,o=e[0]&&_t(e);return{c(){o&&o.c(),n=N()},m(t,e){o&&o.m(t,e),T(t,n,e)},p(t,[e]){t[0]?o?o.p(t,e):(o=_t(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&C(n)}}}function jt(t,e,n){let{backToSearch:o}=e;return t.$$set=t=>{"backToSearch"in t&&n(0,o=t.backToSearch)},[o]}const Pt=class extends Ct{constructor(t){super(),Tt(this,t,jt,Mt,c,{backToSearch:0})}};function Ft(e){let n,o,r,i,l,c,a,u,d=e[0]?": ":"",p=(e[0].message||e[0])+"";return{c(){n=D("p"),o=O("Sorry, can't process that"),r=O(d),i=O(p),l=L(),c=D("button"),c.textContent="Retry",P(n,"class","error svelte-alvqhf")},m(t,d){T(t,n,d),x(n,o),x(n,r),x(n,i),T(t,l,d),T(t,c,d),a||(u=_(c,"click",(function(){s(e[1])&&e[1].apply(this,arguments)})),a=!0)},p(t,[n]){e=t,1&n&&d!==(d=e[0]?": ":"")&&F(r,d),1&n&&p!==(p=(e[0].message||e[0])+"")&&F(i,p)},i:t,o:t,d(t){t&&C(n),t&&C(l),t&&C(c),a=!1,u()}}}function Rt(t,e,n){let{error:o}=e,{retry:r}=e;return t.$$set=t=>{"error"in t&&n(0,o=t.error),"retry"in t&&n(1,r=t.retry)},[o,r]}const Ut=class extends Ct{constructor(t){super(),Tt(this,t,Rt,Ft,c,{error:0,retry:1})}};function It(t){let e,n,o,r,i;const s=t[1].default,l=d(s,t,t[0],null),c=l||function(t){let e;return{c(){e=O("Loading...")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}();return{c(){e=D("div"),n=D("div"),n.innerHTML='<span class="loading-slider svelte-1pmb758">•</span>',o=L(),r=D("p"),c&&c.c(),P(n,"class","loading-slider-container svelte-1pmb758"),P(r,"class","loading svelte-1pmb758"),P(e,"class","loading-container svelte-1pmb758")},m(t,s){T(t,e,s),x(e,n),x(e,o),x(e,r),c&&c.m(r,null),i=!0},p(t,[e]){l&&l.p&&(!i||1&e)&&h(l,s,t,t[0],i?f(s,t[0],e,null):m(t[0]),null)},i(t){i||(dt(c,t),i=!0)},o(t){pt(c,t),i=!1},d(t){t&&C(e),c&&c.d(t)}}}function Ht(t,e,n){let{$$slots:o={},$$scope:r}=e;return t.$$set=t=>{"$$scope"in t&&n(0,r=t.$$scope)},[r,o]}const Bt=class extends Ct{constructor(t){super(),Tt(this,t,Ht,It,c,{})}};function zt(t,e,n){const o=t.slice();return o[9]=e[n][0],o[10]=e[n][1],o}function Wt(t,e,n){const o=t.slice();return o[9]=e[n][0],o[10]=e[n][1],o}function qt(t){let e,n,o,r,i,l,c,a;return e=new Ut({props:{error:t[16],retry:t[7]}}),i=new Pt({props:{backToSearch:t[1]}}),{c(){xt(e.$$.fragment),n=L(),o=D("button"),o.textContent="Back to book",r=L(),xt(i.$$.fragment)},m(u,d){kt(e,u,d),T(u,n,d),T(u,o,d),T(u,r,d),kt(i,u,d),l=!0,c||(a=_(o,"click",(function(){s(t[2])&&t[2].apply(this,arguments)})),c=!0)},p(n,o){t=n;const r={};16&o&&(r.error=t[16]),16&o&&(r.retry=t[7]),e.$set(r);const s={};2&o&&(s.backToSearch=t[1]),i.$set(s)},i(t){l||(dt(e.$$.fragment,t),dt(i.$$.fragment,t),l=!0)},o(t){pt(e.$$.fragment,t),pt(i.$$.fragment,t),l=!1},d(t){Et(e,t),t&&C(n),t&&C(o),t&&C(r),Et(i,t),c=!1,a()}}}function Yt(t){let e,n,o,r,l,c,a,u,d,p,f,h,m=t[3].find(te);function g(){return t[6](t[13])}a=new Pt({props:{backToSearch:t[1]}});let b=m&&Kt(t);return{c(){e=D("h3"),e.textContent="Your e-book is ready!",n=L(),o=D("button"),o.textContent="Download",r=L(),l=D("button"),l.textContent="Back to book",c=L(),xt(a.$$.fragment),u=L(),b&&b.c(),d=N(),P(e,"class","valid svelte-1o8hxnt")},m(i,m){T(i,e,m),T(i,n,m),T(i,o,m),T(i,r,m),T(i,l,m),T(i,c,m),kt(a,i,m),T(i,u,m),b&&b.m(i,m),T(i,d,m),p=!0,f||(h=[_(o,"click",g),_(l,"click",(function(){s(t[2])&&t[2].apply(this,arguments)}))],f=!0)},p(e,n){t=e;const o={};2&n&&(o.backToSearch=t[1]),a.$set(o),8&n&&(m=t[3].find(te)),m?b?b.p(t,n):(b=Kt(t),b.c(),b.m(d.parentNode,d)):b&&(b.d(1),b=null)},i(t){p||(dt(a.$$.fragment,t),p=!0)},o(t){pt(a.$$.fragment,t),p=!1},d(t){t&&C(e),t&&C(n),t&&C(o),t&&C(r),t&&C(l),t&&C(c),Et(a,t),t&&C(u),b&&b.d(t),t&&C(d),f=!1,i(h)}}}function Kt(t){let e,n=t[3],o=[];for(let e=0;e<n.length;e+=1)o[e]=Vt(zt(t,n,e));return{c(){e=D("div");for(let t=0;t<o.length;t+=1)o[t].c();P(e,"class","logs svelte-1o8hxnt")},m(t,n){T(t,e,n);for(let t=0;t<o.length;t+=1)o[t].m(e,null)},p(t,r){if(8&r){let i;for(n=t[3],i=0;i<n.length;i+=1){const s=zt(t,n,i);o[i]?o[i].p(s,r):(o[i]=Vt(s),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(t){t&&C(e),S(o,t)}}}function Gt(t){let e,n,o=t[10]+"";return{c(){e=D("p"),n=O(o),P(e,"class","small warning svelte-1o8hxnt")},m(t,o){T(t,e,o),x(e,n)},p(t,e){8&e&&o!==(o=t[10]+"")&&F(n,o)},d(t){t&&C(e)}}}function Vt(t){let e,n="warn"===t[9]&&Gt(t);return{c(){n&&n.c(),e=N()},m(t,o){n&&n.m(t,o),T(t,e,o)},p(t,o){"warn"===t[9]?n?n.p(t,o):(n=Gt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&C(e)}}}function Xt(t){let e,n,o,r;e=new Bt({props:{$$slots:{default:[Zt]},$$scope:{ctx:t}}});let i=t[3],s=[];for(let e=0;e<i.length;e+=1)s[e]=Jt(Wt(t,i,e));return{c(){xt(e.$$.fragment),n=L(),o=D("div");for(let t=0;t<s.length;t+=1)s[t].c();P(o,"class","logs svelte-1o8hxnt")},m(t,i){kt(e,t,i),T(t,n,i),T(t,o,i);for(let t=0;t<s.length;t+=1)s[t].m(o,null);r=!0},p(t,n){const r={};if(131072&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r),8&n){let e;for(i=t[3],e=0;e<i.length;e+=1){const r=Wt(t,i,e);s[e]?s[e].p(r,n):(s[e]=Jt(r),s[e].c(),s[e].m(o,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){r||(dt(e.$$.fragment,t),r=!0)},o(t){pt(e.$$.fragment,t),r=!1},d(t){Et(e,t),t&&C(n),t&&C(o),S(s,t)}}}function Zt(t){let e;return{c(){e=O("Please wait, generating e-book...")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Jt(t){let e,n,o=t[10]+"";return{c(){e=D("p"),n=O(o),P(e,"class","small svelte-1o8hxnt"),U(e,"warning","warn"===t[9])},m(t,o){T(t,e,o),x(e,n)},p(t,r){8&r&&o!==(o=t[10]+"")&&F(n,o),8&r&&U(e,"warning","warn"===t[9])},d(t){t&&C(e)}}}function Qt(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Xt,then:Yt,catch:qt,value:13,error:16,blocks:[,,,]};return mt(n=t[4],r),{c(){e=N(),r.block.c()},m(t,n){T(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(e,[o]){t=e,r.ctx=t,16&o&&n!==(n=t[4])&&mt(n,r)||gt(r,t,o)},i(t){o||(dt(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1)pt(r.blocks[t]);o=!1},d(t){t&&C(e),r.block.d(t),r.token=null,r=null}}}const te=([t])=>"warn"===t;function ee(t,e,n){let{data:o}=e,{backToSearch:r}=e,{backToBook:i}=e;const s=Promise.all([l.e(845),l.e(483)]).then(l.t.bind(l,9845,23));let c=[];const a=async()=>{n(3,c=[]);const{default:t}=await s;return await t({title:At(o.title),author:At(o.author),ignoreFailedDownloads:!0,verbose:(t,e,...o)=>{c.push([t,e]),n(3,c)}},o.chapters.map((t=>({title:At(t.title),content:t.content,url:t.displayUrl}))))};let u=a();return t.$$set=t=>{"data"in t&&n(0,o=t.data),"backToSearch"in t&&n(1,r=t.backToSearch),"backToBook"in t&&n(2,i=t.backToBook)},[o,r,i,c,u,a,t=>Nt()(t,`${At(o.author)} - ${At(o.title)}.epub`,"application/epub+zip"),()=>n(4,u=a())]}const ne=class extends Ct{constructor(t){super(),Tt(this,t,ee,Qt,c,{data:0,backToSearch:1,backToBook:2})}},oe=async(t,e)=>{const n="undefined"!=typeof AbortController?new AbortController:{},o=setTimeout((()=>n.abort&&n.abort()),e);try{return await fetch(t,{signal:n.signal})}finally{clearTimeout(o)}},re=async(t,e=1e4,n=3)=>{for(let o=0;o<n-1;o++)try{return await oe(t,e)}catch(e){console.log(`Failed to fetch \`${t}\` ${o+1} ${0===o?"time":"times"}. Retrying...`)}return oe(t,e)};let ie=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_")),"");const se=/(?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/.+/i,le=/href="((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/[^"]+)"[^>]*>\s*([^<]+)/gim,ce=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/hfy\/wiki\/series\//i,ae=async t=>{const e=await re("https://www.reddit.com/r/hfy/wiki/series.json"),n=[...(await e.json()).data.content_md.matchAll(/\[([^\]]+)\]\s*\(((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/hfy\/wiki\/series\/[^)]+)\)\s*(?:\[\*([^\]]+)\*\])?/gim)].map((t=>({title:t[1],author:t[3],url:St(t[2].startsWith("http")?t[2]:`https://www.reddit.com${t[2]}`)})));if(!t)return n;const o=t.toLowerCase();return n.filter((t=>-1!==t.title.toLowerCase().indexOf(o)))},ue=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/([^/]+)\/comments\//i,de=t=>({id:t[0].data.children[0].data.id,title:t[0].data.children[0].data.title,content:At(t[0].data.children[0].data.selftext_html),apiUrl:St(t[0].data.children[0].data.url),displayUrl:t[0].data.children[0].data.url,needsFetching:!1});var pe;!function(t){t[t.HFY_SERIES=0]="HFY_SERIES",t[t.POST=1]="POST",t[t.SEARCH=2]="SEARCH"}(pe||(pe={}));const fe=t=>{const e=t.match(/href="([^"]+)"[^>]*>\s*Next/i);if(e)return e[1];const n=[...t.matchAll(le)].reverse().find((t=>{const e=t[3].toLowerCase();return!e.startsWith("first")&&!e.startsWith("prev")&&!e.startsWith("index")}));return n?n[1]:void 0};function he(t,e,n){const o=t.slice();return o[7]=e[n],o}function me(t,e,n){const o=t.slice();return o[7]=e[n],o}function ge(t){let e,n,o,r,i,s,l,c,a,u,d=t[2],p=[];for(let e=0;e<d.length;e+=1)p[e]=$e(he(t,d,e));return i=new Ut({props:{error:t[11],retry:t[5]}}),{c(){e=D("p"),e.textContent="Error fetching chapters:",n=L(),o=D("div");for(let t=0;t<p.length;t+=1)p[t].c();r=L(),xt(i.$$.fragment),s=L(),l=D("a"),l.textContent="back",P(o,"class","chapters svelte-1ytkh6y"),P(l,"href","#back")},m(d,f){T(d,e,f),T(d,n,f),T(d,o,f);for(let t=0;t<p.length;t+=1)p[t].m(o,null);T(d,r,f),kt(i,d,f),T(d,s,f),T(d,l,f),c=!0,a||(u=_(l,"click",M(t[6])),a=!0)},p(t,e){if(4&e){let n;for(d=t[2],n=0;n<d.length;n+=1){const r=he(t,d,n);p[n]?p[n].p(r,e):(p[n]=$e(r),p[n].c(),p[n].m(o,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=d.length}const n={};8&e&&(n.error=t[11]),8&e&&(n.retry=t[5]),i.$set(n)},i(t){c||(dt(i.$$.fragment,t),c=!0)},o(t){pt(i.$$.fragment,t),c=!1},d(t){t&&C(e),t&&C(n),t&&C(o),S(p,t),t&&C(r),Et(i,t),t&&C(s),t&&C(l),a=!1,u()}}}function be(t){let e,n,o=t[7].title+"";return{c(){e=D("p"),n=O(o),P(e,"class","valid small svelte-1ytkh6y")},m(t,o){T(t,e,o),x(e,n)},p(t,e){4&e&&o!==(o=t[7].title+"")&&F(n,o)},d(t){t&&C(e)}}}function $e(t){let e,n=!0===t[7].new&&be(t);return{c(){n&&n.c(),e=N()},m(t,o){n&&n.m(t,o),T(t,e,o)},p(t,o){!0===t[7].new?n?n.p(t,o):(n=be(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&C(e)}}}function ye(e){let n,o=e[1](e[10])+"";return{c(){n=O(o)},m(t,e){T(t,n,e)},p(t,e){10&e&&o!==(o=t[1](t[10])+"")&&F(n,o)},i:t,o:t,d(t){t&&C(n)}}}function ve(t){let e,n,o,r;e=new Bt({props:{$$slots:{default:[we]},$$scope:{ctx:t}}});let i=t[2],s=[];for(let e=0;e<i.length;e+=1)s[e]=ke(me(t,i,e));return{c(){xt(e.$$.fragment),n=L(),o=D("div");for(let t=0;t<s.length;t+=1)s[t].c();P(o,"class","chapters svelte-1ytkh6y")},m(t,i){kt(e,t,i),T(t,n,i),T(t,o,i);for(let t=0;t<s.length;t+=1)s[t].m(o,null);r=!0},p(t,n){const r={};if(16384&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r),4&n){let e;for(i=t[2],e=0;e<i.length;e+=1){const r=me(t,i,e);s[e]?s[e].p(r,n):(s[e]=ke(r),s[e].c(),s[e].m(o,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){r||(dt(e.$$.fragment,t),r=!0)},o(t){pt(e.$$.fragment,t),r=!1},d(t){Et(e,t),t&&C(n),t&&C(o),S(s,t)}}}function we(t){let e;return{c(){e=O("Please wait, fetching chapters...")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function xe(t){let e,n,o=t[7].title+"";return{c(){e=D("p"),n=O(o),P(e,"class","valid small svelte-1ytkh6y")},m(t,o){T(t,e,o),x(e,n)},p(t,e){4&e&&o!==(o=t[7].title+"")&&F(n,o)},d(t){t&&C(e)}}}function ke(t){let e,n=t[7]&&!0===t[7].new&&xe(t);return{c(){n&&n.c(),e=N()},m(t,o){n&&n.m(t,o),T(t,e,o)},p(t,o){t[7]&&!0===t[7].new?n?n.p(t,o):(n=xe(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&C(e)}}}function Ee(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:ve,then:ye,catch:ge,value:10,error:11,blocks:[,,,]};return mt(n=t[3],r),{c(){e=N(),r.block.c()},m(t,n){T(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(e,[o]){t=e,r.ctx=t,8&o&&n!==(n=t[3])&&mt(n,r)||gt(r,t,o)},i(t){o||(dt(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1)pt(r.blocks[t]);o=!1},d(t){t&&C(e),r.block.d(t),r.token=null,r=null}}}function Te(t,e,n){let{data:o}=e,{goNext:r}=e,i=[...o.chapters.map((t=>Object.assign(Object.assign({},t),{new:!1})))];const s=async()=>{let t=i;n(2,i=new Array(i.length));for(let e=0;e<t.length;e+=100)await Promise.all(t.slice(e,e+100).map(((o,r)=>{if(n(2,i[r+e]=Object.assign({},t[r+e]),i),!1!==o.needsFetching)return re(o.apiUrl).then((t=>t.json())).then((t=>{n(2,i[r+e]=Object.assign(Object.assign({},de(t)),{new:!0}),i),n(2,i)}))})));return Object.assign(Object.assign({},o),{chapters:i})};let l=s();return t.$$set=t=>{"data"in t&&n(0,o=t.data),"goNext"in t&&n(1,r=t.goNext)},[o,r,i,l,s,()=>n(3,l=s()),()=>r({...o,chapters:i})]}const Ce=class extends Ct{constructor(t){super(),Tt(this,t,Te,Ee,c,{data:0,goNext:1})}};function Se(t,e,n){const o=t.slice();return o[7]=e[n],o}function De(t){let e,n;return e=new Ut({props:{error:t[11],retry:t[5]}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.error=t[11]),4&n&&(o.retry=t[5]),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Ae(e){let n,o=e[0](e[10],e[1].length)+"";return{c(){n=O(o)},m(t,e){T(t,n,e)},p(t,e){7&e&&o!==(o=t[0](t[10],t[1].length)+"")&&F(n,o)},i:t,o:t,d(t){t&&C(n)}}}function Oe(t){let e,n,o,r;e=new Bt({props:{$$slots:{default:[Le]},$$scope:{ctx:t}}});let i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=Ne(Se(t,i,e));return{c(){xt(e.$$.fragment),n=L(),o=D("div");for(let t=0;t<s.length;t+=1)s[t].c();P(o,"class","chapters")},m(t,i){kt(e,t,i),T(t,n,i),T(t,o,i);for(let t=0;t<s.length;t+=1)s[t].m(o,null);r=!0},p(t,n){const r={};if(4096&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r),2&n){let e;for(i=t[1],e=0;e<i.length;e+=1){const r=Se(t,i,e);s[e]?s[e].p(r,n):(s[e]=Ne(r),s[e].c(),s[e].m(o,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){r||(dt(e.$$.fragment,t),r=!0)},o(t){pt(e.$$.fragment,t),r=!1},d(t){Et(e,t),t&&C(n),t&&C(o),S(s,t)}}}function Le(t){let e;return{c(){e=O("Please wait, fetching chapters...")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Ne(t){let e,n,o,r,i,s,l=t[7].from+"",c=t[7].url+"";return{c(){e=D("p"),n=O(l),o=O(": Extracted "),r=D("a"),i=O(c),P(r,"href",s=t[7].url),P(e,"class","valid small svelte-188oh31")},m(t,s){T(t,e,s),x(e,n),x(e,o),x(e,r),x(r,i)},p(t,e){2&e&&l!==(l=t[7].from+"")&&F(n,l),2&e&&c!==(c=t[7].url+"")&&F(i,c),2&e&&s!==(s=t[7].url)&&P(r,"href",s)},d(t){t&&C(e)}}}function _e(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Oe,then:Ae,catch:De,value:10,error:11,blocks:[,,,]};return mt(n=t[2],r),{c(){e=N(),r.block.c()},m(t,n){T(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(e,[o]){t=e,r.ctx=t,4&o&&n!==(n=t[2])&&mt(n,r)||gt(r,t,o)},i(t){o||(dt(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1)pt(r.blocks[t]);o=!1},d(t){t&&C(e),r.block.d(t),r.token=null,r=null}}}function Me(t,e,n){let o,{bookData:r}=e,{goNext:i}=e,s=[];const l=async()=>{for(o=r.chapters.map((t=>Object.assign({},t)));;){let t=o[o.length-1];if(!1!==t.needsFetching){const e=await re(t.apiUrl),n=await e.json();if(!e.ok)throw n.message;o.splice(-1,1,t=de(n))}const e=fe(t.content);if(!e)break;const r=St(e);if(o.find((t=>t.apiUrl===r)))break;s.push({from:t.title,url:e}),n(1,s);const i=await re(r),l=await i.json();if(!i.ok)throw l.message;o.push(de(l))}return Object.assign(Object.assign({},r),{chapters:o})};let c=l();return t.$$set=t=>{"bookData"in t&&n(4,r=t.bookData),"goNext"in t&&n(0,i=t.goNext)},[i,s,c,l,r,()=>n(2,c=l())]}const je=class extends Ct{constructor(t){super(),Tt(this,t,Me,_e,c,{bookData:4,goNext:0})}};function Pe(t,e,n){t.dispatchEvent(new CustomEvent("finalize",{detail:{items:e,info:n}}))}function Fe(t,e,n){t.dispatchEvent(new CustomEvent("consider",{detail:{items:e,info:n}}))}const Re="draggedEntered",Ue="draggedLeft",Ie="draggedOverIndex",He="draggedLeftDocument",Be="leftForAnother",ze="outsideOfAny";function We(t,e,n){t.dispatchEvent(new CustomEvent(Re,{detail:{indexObj:e,draggedEl:n}}))}function qe(t,e,n){t.dispatchEvent(new CustomEvent(Ue,{detail:{draggedEl:e,type:Be,theOtherDz:n}}))}function Ye(t,e,n){t.dispatchEvent(new CustomEvent(Ie,{detail:{indexObj:e,draggedEl:n}}))}const Ke="dragStarted",Ge="droppedIntoZone",Ve="droppedIntoAnother",Xe="pointer",Ze="keyboard",Je="data-is-dnd-shadow-item",Qe="id:dnd-shadow-placeholder-0000";let tn="id",en=0;function nn(){en++}function on(){if(0===en)throw new Error("Bug! trying to decrement when there are no dropzones");en--}const rn="undefined"==typeof window;let sn;function ln(t){let e;const n=t.getBoundingClientRect(),o=getComputedStyle(t),r=o.transform;if(r){let i,s,l,c;if(r.startsWith("matrix3d("))e=r.slice(9,-1).split(/, /),i=+e[0],s=+e[5],l=+e[12],c=+e[13];else{if(!r.startsWith("matrix("))return n;e=r.slice(7,-1).split(/, /),i=+e[0],s=+e[3],l=+e[4],c=+e[5]}const a=o.transformOrigin,u=n.x-l-(1-i)*parseFloat(a),d=n.y-c-(1-s)*parseFloat(a.slice(a.indexOf(" ")+1)),p=i?n.width/i:t.offsetWidth,f=s?n.height/s:t.offsetHeight;return{x:u,y:d,width:p,height:f,top:d,right:u+p,bottom:d+f,left:u}}return n}function cn(t){const e=ln(t);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function an(t){const e=t.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function un(t){return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}function dn(t,e){return t.y<=e.bottom&&t.y>=e.top&&t.x>=e.left&&t.x<=e.right}function pn(t){return un(an(t))}function fn(t,e){return dn(pn(t),cn(e))}function hn(){sn=new Map}function mn(t){sn.delete(t)}function gn(t,e){if(!fn(t,e))return null;const n=e.children;if(0===n.length)return{index:0,isProximityBased:!0};const o=function(t){const e=Array.from(t.children).findIndex((t=>t.getAttribute(Je)));if(e>=0)return sn.has(t)||sn.set(t,new Map),sn.get(t).set(e,cn(t.children[e])),e}(e);for(let r=0;r<n.length;r++)if(fn(t,n[r])){const n=sn.has(e)&&sn.get(e).get(r);return n&&!dn(pn(t),n)?{index:o,isProximityBased:!1}:{index:r,isProximityBased:!1}}let r,i=Number.MAX_VALUE;for(let e=0;e<n.length;e++){const o=(s=t,l=n[e],c=void 0,a=void 0,c=pn(s),a=pn(l),Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)));o<i&&(i=o,r=e)}var s,l,c,a;return{index:r,isProximityBased:!0}}function bn(){let t;function e(){t={directionObj:void 0,stepPx:0}}function n(e){const{directionObj:o,stepPx:r}=t;o&&(e.scrollBy(o.x*r,o.y*r),window.requestAnimationFrame((()=>n(e))))}function o(t){return 25-t}return e(),{scrollIfNeeded:function(r,i){if(!i)return!1;const s=function(t,e){const n=an(e);return dn(t,n)?{top:t.y-n.top,bottom:n.bottom-t.y,left:t.x-n.left,right:Math.min(n.right,document.documentElement.clientWidth)-t.x}:null}(r,i);if(null===s)return e(),!1;const l=!!t.directionObj;let[c,a]=[!1,!1];return i.scrollHeight>i.clientHeight&&(s.bottom<25?(c=!0,t.directionObj={x:0,y:1},t.stepPx=o(s.bottom)):s.top<25&&(c=!0,t.directionObj={x:0,y:-1},t.stepPx=o(s.top)),!l&&c)||i.scrollWidth>i.clientWidth&&(s.right<25?(a=!0,t.directionObj={x:1,y:0},t.stepPx=o(s.right)):s.left<25&&(a=!0,t.directionObj={x:-1,y:0},t.stepPx=o(s.left)),!l&&a)?(n(i),!0):(e(),!1)},resetScrolling:e}}function $n(t){return JSON.stringify(t,null,2)}function yn(t){if(!t)throw new Error("cannot get depth of a falsy node");return vn(t,0)}function vn(t,e=0){return t.parentElement?vn(t.parentElement,e+1):e-1}hn();const{scrollIfNeeded:wn,resetScrolling:xn}=bn();let kn,En;function Tn(t){const e=t.touches?t.touches[0]:t;En={x:e.clientX,y:e.clientY}}const{scrollIfNeeded:Cn,resetScrolling:Sn}=bn();let Dn;function An(){En&&Cn(En,document.documentElement)&&hn(),Dn=window.setTimeout(An,300)}function On(t){return`${t} 0.2s ease`}function Ln(t,e,n,o,r){const i=e.getBoundingClientRect(),s=t.getBoundingClientRect(),l=i.width-s.width,c=i.height-s.height;if(l||c){const e={left:(n-s.left)/s.width,top:(o-s.top)/s.height};t.style.height=`${i.height}px`,t.style.width=`${i.width}px`,t.style.left=parseFloat(t.style.left)-e.left*l+"px",t.style.top=parseFloat(t.style.top)-e.top*c+"px"}Nn(e,t),r()}function Nn(t,e){const n=window.getComputedStyle(t);Array.from(n).filter((t=>t.startsWith("background")||t.startsWith("padding")||t.startsWith("font")||t.startsWith("text")||t.startsWith("align")||t.startsWith("justify")||t.startsWith("display")||t.startsWith("flex")||t.startsWith("border")||"opacity"===t||"color"===t||"list-style-type"===t)).forEach((t=>e.style.setProperty(t,n.getPropertyValue(t),n.getPropertyPriority(t))))}function _n(t,e){t.draggable=!1,t.ondragstart=()=>!1,e?(t.style.userSelect="",t.style.WebkitUserSelect="",t.style.cursor=""):(t.style.userSelect="none",t.style.WebkitUserSelect="none",t.style.cursor="grab")}function Mn(t){t.style.display="none",t.style.position="fixed",t.style.zIndex="-5"}function jn(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const o=e(t);Object.keys(o).forEach((e=>{t.style[e]=o[e]})),n(t).forEach((e=>t.classList.add(e)))}))}function Pn(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const o=e(t);Object.keys(o).forEach((e=>{t.style[e]=""})),n(t).forEach((e=>t.classList.contains(e)&&t.classList.remove(e)))}))}const Fn={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let Rn,Un,In,Hn,Bn,zn,Wn,qn,Yn,Kn,Gn,Vn=!1,Xn=!1,Zn=!1,Jn=[];const Qn=new Map,to=new Map,eo=new WeakMap;function no(t,e){Qn.get(e).delete(t),on(),0===Qn.get(e).size&&Qn.delete(e)}function oo(){window.addEventListener("mousemove",Tn),window.addEventListener("touchmove",Tn),An();const t=Qn.get(Hn);for(const e of t)e.addEventListener(Re,io),e.addEventListener(Ue,so),e.addEventListener(Ie,lo);window.addEventListener(He,ao);const e=Math.max(100,...Array.from(t.keys()).map((t=>to.get(t).dropAnimationDurationMs)));!function(t,e,n=200){let o,r,i,s=!1;const l=Array.from(e).sort(((t,e)=>yn(e)-yn(t)));!function e(){const c=pn(t),a=wn(c,o);if(!a&&i&&Math.abs(i.x-c.x)<10&&Math.abs(i.y-c.y)<10)return void(kn=window.setTimeout(e,n));if(function(t){const e=an(t);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}(t))return void function(t){window.dispatchEvent(new CustomEvent(He,{detail:{draggedEl:t}}))}(t);i=c;let u=!1;for(const e of l){a&&mn(o);const n=gn(t,e);if(null===n)continue;const{index:i}=n;u=!0,e!==o?(o&&qe(o,t,e),We(e,n,t),o=e):i!==r&&(Ye(e,n,t),r=i);break}!u&&s&&o?(function(t,e){t.dispatchEvent(new CustomEvent(Ue,{detail:{draggedEl:e,type:ze}}))}(o,t),o=void 0,r=void 0,s=!1):s=!0,kn=window.setTimeout(e,n)}()}(Un,t,1.07*e)}function ro(t){return t.findIndex((t=>!!t.isDndShadowItem&&t.id!==Qe))}function io(t){let{items:e,dropFromOthersDisabled:n}=to.get(t.currentTarget);if(n&&t.currentTarget!==Bn)return;if(Zn=!1,e=e.filter((t=>t.id!==Wn.id)),Bn!==t.currentTarget){const t=to.get(Bn).items.filter((t=>!t.isDndShadowItem));Fe(Bn,t,{trigger:"dragEnteredAnother",id:In.id,source:Xe})}else{const t=function(t){return t.findIndex((t=>t.id===Qe))}(e);-1!==t&&e.splice(t,1)}const{index:o,isProximityBased:r}=t.detail.indexObj,i=r&&o===t.currentTarget.children.length-1?o+1:o;qn=t.currentTarget,e.splice(i,0,Wn),Fe(t.currentTarget,e,{trigger:"draggedEntered",id:In.id,source:Xe})}function so(t){if(!Vn)return;const{items:e,dropFromOthersDisabled:n}=to.get(t.currentTarget);if(n&&t.currentTarget!==Bn&&t.currentTarget!==qn)return;const o=ro(e),r=e.splice(o,1)[0];qn=void 0;const{type:i,theOtherDz:s}=t.detail;if(i===ze||i===Be&&s!==Bn&&to.get(s).dropFromOthersDisabled){Zn=!0,qn=Bn;const t=to.get(Bn).items;t.splice(zn,0,r),Fe(Bn,t,{trigger:"draggedLeftAll",id:In.id,source:Xe})}Fe(t.currentTarget,e,{trigger:"draggedLeft",id:In.id,source:Xe})}function lo(t){const{items:e,dropFromOthersDisabled:n}=to.get(t.currentTarget);if(n&&t.currentTarget!==Bn)return;Zn=!1;const{index:o}=t.detail.indexObj,r=ro(e);e.splice(r,1),e.splice(o,0,Wn),Fe(t.currentTarget,e,{trigger:"draggedOverIndex",id:In.id,source:Xe})}function co(t){t.preventDefault();const e=t.touches?t.touches[0]:t;Kn={x:e.clientX,y:e.clientY},Un.style.transform=`translate3d(${Kn.x-Yn.x}px, ${Kn.y-Yn.y}px, 0)`}function ao(){Xn=!0,window.removeEventListener("mousemove",co),window.removeEventListener("touchmove",co),window.removeEventListener("mouseup",ao),window.removeEventListener("touchend",ao),function(){window.removeEventListener("mousemove",Tn),window.removeEventListener("touchmove",Tn),En=void 0,window.clearTimeout(Dn),Sn();const t=Qn.get(Hn);for(const e of t)e.removeEventListener(Re,io),e.removeEventListener(Ue,so),e.removeEventListener(Ie,lo);window.removeEventListener(He,ao),clearTimeout(kn),xn(),hn()}(),function(t){t.style.cursor="grab"}(Un),qn||(qn=Bn);let{items:t,type:e}=to.get(qn);Pn(Qn.get(e),(t=>to.get(t).dropTargetStyle),(t=>to.get(t).dropTargetClasses));let n=ro(t);-1===n&&(n=zn),t=t.map((t=>t.isDndShadowItem?In:t)),function(t,e){const n=ln(qn.children[t]),o=n.left-parseFloat(Un.style.left),r=n.top-parseFloat(Un.style.top),{dropAnimationDurationMs:i}=to.get(qn),s=`transform ${i}ms ease`;Un.style.transition=Un.style.transition?Un.style.transition+","+s:s,Un.style.transform=`translate3d(${o}px, ${r}px, 0)`,window.setTimeout(e,i)}(n,(function(){var e;Gn(),Pe(qn,t,{trigger:Zn?"droppedOutsideOfAny":Ge,id:In.id,source:Xe}),qn!==Bn&&Pe(Bn,to.get(Bn).items,{trigger:Ve,id:In.id,source:Xe}),(e=qn.children[n]).style.visibility="",e.removeAttribute(Je),Un.remove(),Rn.remove(),Jn.length&&(Jn.forEach((({dz:t,destroy:e})=>{e(),t.remove()})),Jn=[]),Un=void 0,Rn=void 0,In=void 0,Hn=void 0,Bn=void 0,zn=void 0,Wn=void 0,qn=void 0,Yn=void 0,Kn=void 0,Vn=!1,Xn=!1,Gn=void 0,Zn=!1}))}const uo={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},po={[uo.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[uo.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"};let fo;function ho(){fo||(fo=document.createElement("div"),fo.id="dnd-action-aria-alert",fo.style.position="fixed",fo.style.bottom="0",fo.style.left="0",fo.style.zIndex="-5",fo.style.opacity="0",fo.style.height="0",fo.style.width="0",fo.setAttribute("role","alert"),document.body.prepend(fo),Object.entries(po).forEach((([t,e])=>document.body.prepend(function(t,e){const n=document.createElement("div");return n.id=t,n.innerHTML=`<p>${e}</p>`,n.style.display="none",n.style.position="fixed",n.style.zIndex="-5",n}(t,e)))))}function mo(t){if(rn)return;fo||ho(),fo.innerHTML="";const e=document.createTextNode(t);fo.appendChild(e),fo.style.display="none",fo.style.display="inline"}const go={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let bo,$o,yo,vo,wo=!1,xo="",ko="";const Eo=new WeakSet,To=new WeakMap,Co=new WeakMap,So=new Map,Do=new Map,Ao=new Map;let Oo;function Lo(t,e){$o===t&&Po(),Ao.get(e).delete(t),on(),0===Ao.get(e).size&&Ao.delete(e),0===Ao.size&&(window.removeEventListener("keydown",No),window.removeEventListener("click",_o),Oo=void 0,!rn&&fo&&(Object.keys(po).forEach((t=>document.getElementById(t)?.remove())),fo.remove(),fo=void 0))}function No(t){wo&&"Escape"===t.key&&Po()}function _o(){wo&&(Eo.has(document.activeElement)||Po())}function Mo(t){if(!wo)return;const e=t.currentTarget;if(e===$o)return;xo=e.getAttribute("aria-label")||"";const{items:n}=Do.get($o),o=n.find((t=>t.id===vo)),r=n.indexOf(o),i=n.splice(r,1)[0],{items:s,autoAriaDisabled:l}=Do.get(e);e.getBoundingClientRect().top<$o.getBoundingClientRect().top||e.getBoundingClientRect().left<$o.getBoundingClientRect().left?(s.push(i),l||mo(`Moved item ${ko} to the end of the list ${xo}`)):(s.unshift(i),l||mo(`Moved item ${ko} to the beginning of the list ${xo}`)),Pe($o,n,{trigger:Ve,id:vo,source:Ze}),Pe(e,s,{trigger:Ge,id:vo,source:Ze}),$o=e}function jo(){So.forEach((({update:t},e)=>t(Do.get(e))))}function Po(t=!0){Do.get($o).autoAriaDisabled||mo(`Stopped dragging item ${ko}`),Eo.has(document.activeElement)&&document.activeElement.blur(),t&&Fe($o,Do.get($o).items,{trigger:"dragStopped",id:vo,source:Ze}),Pn(Ao.get(bo),(t=>Do.get(t).dropTargetStyle),(t=>Do.get(t).dropTargetClasses)),yo=null,vo=null,ko="",bo=null,$o=null,xo="",wo=!1,jo()}function Fo(t,e){const n={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:go,dropTargetClasses:[],autoAriaDisabled:!1};function o(t,e,n){t.length<=1||t.splice(n,1,t.splice(e,1,t[n])[0])}function r(e){switch(e.key){case"Enter":case" ":if((void 0!==e.target.disabled||e.target.href||e.target.isContentEditable)&&!Eo.has(e.target))return;e.preventDefault(),e.stopPropagation(),wo?Po():i(e);break;case"ArrowDown":case"ArrowRight":{if(!wo)return;e.preventDefault(),e.stopPropagation();const{items:r}=Do.get(t),i=Array.from(t.children),s=i.indexOf(e.currentTarget);s<i.length-1&&(n.autoAriaDisabled||mo(`Moved item ${ko} to position ${s+2} in the list ${xo}`),o(r,s,s+1),Pe(t,r,{trigger:Ge,id:vo,source:Ze}));break}case"ArrowUp":case"ArrowLeft":{if(!wo)return;e.preventDefault(),e.stopPropagation();const{items:r}=Do.get(t),i=Array.from(t.children).indexOf(e.currentTarget);i>0&&(n.autoAriaDisabled||mo(`Moved item ${ko} to position ${i} in the list ${xo}`),o(r,i,i-1),Pe(t,r,{trigger:Ge,id:vo,source:Ze}));break}}}function i(e){(function(e){const{items:n}=Do.get(t),o=Array.from(t.children),r=o.indexOf(e);yo=e,yo.tabIndex=0,vo=n[r].id,ko=o[r].getAttribute("aria-label")||""})(e.currentTarget),$o=t,bo=n.type,wo=!0;const o=Array.from(Ao.get(n.type)).filter((t=>t===$o||!Do.get(t).dropFromOthersDisabled));if(jn(o,(t=>Do.get(t).dropTargetStyle),(t=>Do.get(t).dropTargetClasses)),!n.autoAriaDisabled){let t=`Started dragging item ${ko}. Use the arrow keys to move it within its list ${xo}`;o.length>1&&(t+=", or tab to another list in order to move the item into it"),mo(t)}Fe(t,Do.get(t).items,{trigger:Ke,id:vo,source:Ze}),jo()}function s(t){wo&&t.currentTarget!==yo&&(t.stopPropagation(),Po(!1),i(t))}function l({items:e=[],type:o="--any--",dragDisabled:i=!1,zoneTabIndex:l=0,dropFromOthersDisabled:c=!1,dropTargetStyle:a=go,dropTargetClasses:u=[],autoAriaDisabled:d=!1}){var p,f;n.items=[...e],n.dragDisabled=i,n.dropFromOthersDisabled=c,n.zoneTabIndex=l,n.dropTargetStyle=a,n.dropTargetClasses=u,n.autoAriaDisabled=d,n.type&&o!==n.type&&Lo(t,n.type),n.type=o,p=t,f=o,0===Ao.size&&(Oo=rn?null:("complete"===document.readyState?ho():window.addEventListener("DOMContentLoaded",ho),{...uo}),window.addEventListener("keydown",No),window.addEventListener("click",_o)),Ao.has(f)||Ao.set(f,new Set),Ao.get(f).has(p)||(Ao.get(f).add(p),nn()),d||(t.setAttribute("aria-disabled",i),t.setAttribute("role","list"),t.setAttribute("aria-describedby",i?Oo.DND_ZONE_DRAG_DISABLED:Oo.DND_ZONE_ACTIVE)),Do.set(t,n),t.tabIndex=wo?t===$o||yo.contains(t)||n.dropFromOthersDisabled||$o&&n.type!==Do.get($o).type?-1:0:n.zoneTabIndex,t.addEventListener("focus",Mo);for(let e=0;e<t.children.length;e++){const o=t.children[e];Eo.add(o),o.tabIndex=wo?-1:0,d||o.setAttribute("role","listitem"),o.removeEventListener("keydown",To.get(o)),o.removeEventListener("click",Co.get(o)),i||(o.addEventListener("keydown",r),To.set(o,r),o.addEventListener("click",s),Co.set(o,s)),wo&&n.items[e].id===vo&&(yo=o,yo.tabIndex=0,o.focus())}}l(e);const c={update:t=>{l(t)},destroy:()=>{Lo(t,n.type),Do.delete(t),So.delete(t)}};return So.set(t,c),c}function Ro(t,e){Uo(e);const n=function(t,e){let n=!1;const o={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:Fn,dropTargetClasses:[],transformDraggedElement:()=>{},centreDraggedOnCursor:!1};let r=new Map;function i(){window.removeEventListener("mousemove",l),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",s),window.removeEventListener("touchend",s)}function s(){i(),Rn=void 0,Yn=void 0,Kn=void 0}function l(t){t.preventDefault();const e=t.touches?t.touches[0]:t;Kn={x:e.clientX,y:e.clientY},(Math.abs(Kn.x-Yn.x)>=3||Math.abs(Kn.y-Yn.y)>=3)&&(i(),function(){Vn=!0;const t=r.get(Rn);zn=t,Bn=Rn.parentElement;const e=Bn.getRootNode(),n=e.body||e,{items:i,type:s,centreDraggedOnCursor:l}=o;In={...i[t]},Hn=s,Wn={...In,isDndShadowItem:!0};const c={...Wn,[tn]:Qe};Un=function(t,e){const n=t.getBoundingClientRect(),o=function(t){const e=t.cloneNode(!0),n=[],o="SELECT"===t.tagName,r=o?[t]:[...t.querySelectorAll("select")];for(const t of r)n.push(t.value);if(r.length<=0)return e;const i=o?[e]:[...e.querySelectorAll("select")];for(let t=0;t<i.length;t++){const e=i[t],o=n[t],r=e.querySelector(`option[value="${o}"`);r&&r.setAttribute("selected",!0)}return e}(t);Nn(t,o),o.id="dnd-action-dragged-el",o.style.position="fixed";let r=n.top,i=n.left;if(o.style.top=`${r}px`,o.style.left=`${i}px`,e){const t=un(n);r-=t.y-e.y,i-=t.x-e.x,window.setTimeout((()=>{o.style.top=`${r}px`,o.style.left=`${i}px`}),0)}return o.style.margin="0",o.style.boxSizing="border-box",o.style.height=`${n.height}px`,o.style.width=`${n.width}px`,o.style.transition=`${On("top")}, ${On("left")}, ${On("background-color")}, ${On("opacity")}, ${On("color")} `,window.setTimeout((()=>o.style.transition+=`, ${On("width")}, ${On("height")}`),0),o.style.zIndex="9999",o.style.cursor="grabbing",o}(Rn,l&&Kn),window.requestAnimationFrame((function t(){Un.parentElement?window.requestAnimationFrame(t):(n.appendChild(Un),Un.focus(),oo(),Mn(Rn),n.appendChild(Rn))})),jn(Array.from(Qn.get(o.type)).filter((t=>t===Bn||!to.get(t).dropFromOthersDisabled)),(t=>to.get(t).dropTargetStyle),(t=>to.get(t).dropTargetClasses)),i.splice(t,1,c),Gn=function(t){const e=t.style.minHeight;t.style.minHeight=window.getComputedStyle(t).getPropertyValue("height");const n=t.style.minWidth;return t.style.minWidth=window.getComputedStyle(t).getPropertyValue("width"),function(){t.style.minHeight=e,t.style.minWidth=n}}(Bn),Fe(Bn,i,{trigger:Ke,id:In.id,source:Xe}),window.addEventListener("mousemove",co,{passive:!1}),window.addEventListener("touchmove",co,{passive:!1,capture:!1}),window.addEventListener("mouseup",ao,{passive:!1}),window.addEventListener("touchend",ao,{passive:!1})}())}function c(t){if(t.target!==t.currentTarget&&(void 0!==t.target.value||t.target.isContentEditable))return;if(t.button)return;if(Vn)return;t.stopPropagation();const e=t.touches?t.touches[0]:t;Yn={x:e.clientX,y:e.clientY},Kn={...Yn},Rn=t.currentTarget,window.addEventListener("mousemove",l,{passive:!1}),window.addEventListener("touchmove",l,{passive:!1,capture:!1}),window.addEventListener("mouseup",s,{passive:!1}),window.addEventListener("touchend",s,{passive:!1})}function a({items:e,flipDurationMs:i=0,type:s="--any--",dragDisabled:l=!1,morphDisabled:a=!1,dropFromOthersDisabled:u=!1,dropTargetStyle:d=Fn,dropTargetClasses:p=[],transformDraggedElement:f=(()=>{}),centreDraggedOnCursor:h=!1}){var m,g;function b(t,e){return to.get(t)?to.get(t)[e]:o[e]}o.dropAnimationDurationMs=i,o.type&&s!==o.type&&no(t,o.type),o.type=s,m=t,g=s,Qn.has(g)||Qn.set(g,new Set),Qn.get(g).has(m)||(Qn.get(g).add(m),nn()),o.items=[...e],o.dragDisabled=l,o.morphDisabled=a,o.transformDraggedElement=f,o.centreDraggedOnCursor=h,!n||!Vn||Xn||function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!{}.hasOwnProperty.call(e,n)||e[n]!==t[n])return!1;return!0}(d,o.dropTargetStyle)&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(p,o.dropTargetClasses)||(Pn([t],(()=>o.dropTargetStyle),(()=>p)),jn([t],(()=>d),(()=>p))),o.dropTargetStyle=d,o.dropTargetClasses=[...p],n&&Vn&&o.dropFromOthersDisabled!==u&&(u?Pn([t],(t=>b(t,"dropTargetStyle")),(t=>b(t,"dropTargetClasses"))):jn([t],(t=>b(t,"dropTargetStyle")),(t=>b(t,"dropTargetClasses")))),o.dropFromOthersDisabled=u,to.set(t,o);const $=ro(o.items);for(let e=0;e<t.children.length;e++){const i=t.children[e];_n(i,l),e!==$?(i.removeEventListener("mousedown",eo.get(i)),i.removeEventListener("touchstart",eo.get(i)),l||(i.addEventListener("mousedown",c),i.addEventListener("touchstart",c),eo.set(i,c)),r.set(i,e),n||(n=!0)):(a||Ln(Un,i,Kn.x,Kn.y,(()=>o.transformDraggedElement(Un,In,e))),(y=i).style.visibility="hidden",y.setAttribute(Je,"true"))}var y}return a(e),{update:t=>{a(t)},destroy:()=>{function e(){no(t,to.get(t).type),to.delete(t)}var n,o;Vn?(n=t,o=e,Jn.push({dz:n,destroy:o}),window.requestAnimationFrame((()=>{Mn(n),document.body.appendChild(n)}))):e()}}}(t,e),o=Fo(t,e);return{update:t=>{Uo(t),n.update(t),o.update(t)},destroy:()=>{n.destroy(),o.destroy()}}}function Uo(t){const{items:e,flipDurationMs:n,type:o,dragDisabled:r,morphDisabled:i,dropFromOthersDisabled:s,zoneTabIndex:l,dropTargetStyle:c,dropTargetClasses:a,transformDraggedElement:u,autoAriaDisabled:d,centreDraggedOnCursor:p,...f}=t;if(Object.keys(f).length>0&&console.warn("dndzone will ignore unknown options",f),!e)throw new Error("no 'items' key provided to dndzone");const h=e.find((t=>!{}.hasOwnProperty.call(t,tn)));if(h)throw new Error(`missing 'id' property for item ${$n(h)}`);if(a&&!Array.isArray(a))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof a}, ${$n(a)}`);if(l&&(m=l,isNaN(m)||(0|(g=parseFloat(m)))!==g))throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof l}, ${$n(l)}`);var m,g}function Io(t){const e=t-1;return e*e*e+1}function Ho(t,{delay:n=0,duration:o=400,easing:r=e}={}){const i=+getComputedStyle(t).opacity;return{delay:n,duration:o,easing:r,css:t=>"opacity: "+t*i}}function Bo(t,{delay:e=0,duration:n=400,easing:o=Io,x:r=0,y:i=0,opacity:s=0}={}){const l=getComputedStyle(t),c=+l.opacity,a="none"===l.transform?"":l.transform,u=c*(1-s);return{delay:e,duration:n,easing:o,css:(t,e)=>`\n\t\t\ttransform: ${a} translate(${(1-t)*r}px, ${(1-t)*i}px);\n\t\t\topacity: ${c-u*e}`}}const zo=["Activate","AddUndo","BeforeAddUndo","BeforeExecCommand","BeforeGetContent","BeforeRenderUI","BeforeSetContent","BeforePaste","Blur","Change","ClearUndos","Click","ContextMenu","Copy","Cut","Dblclick","Deactivate","Dirty","Drag","DragDrop","DragEnd","DragGesture","DragOver","Drop","ExecCommand","Focus","FocusIn","FocusOut","GetContent","Hide","Init","KeyDown","KeyPress","KeyUp","LoadContent","MouseDown","MouseEnter","MouseLeave","MouseMove","MouseOut","MouseOver","MouseUp","NodeChange","ObjectResizeStart","ObjectResized","ObjectSelected","Paste","PostProcess","PostRender","PreProcess","ProgressState","Redo","Remove","Reset","ResizeEditor","SaveContent","SelectionChange","SetAttrib","SetContent","Show","Submit","Undo","VisualAid"];function Wo(t){let e;return{c(){var n,o;e=D("textarea"),P(e,"id",t[0]),n=e,o="visibility",null==="hidden"?n.style.removeProperty(o):n.style.setProperty(o,"hidden","")},m(n,o){T(n,e,o),t[18](e)},p(t,n){1&n&&P(e,"id",t[0])},d(n){n&&C(e),t[18](null)}}}function qo(t){let e;return{c(){e=D("div"),P(e,"id",t[0])},m(n,o){T(n,e,o),t[17](e)},p(t,n){1&n&&P(e,"id",t[0])},d(n){n&&C(e),t[17](null)}}}function Yo(e){let n;function o(t,e){return t[1]?qo:Wo}let r=o(e),i=r(e);return{c(){n=D("div"),i.c(),P(n,"class",e[2])},m(t,o){T(t,n,o),i.m(n,null),e[19](n)},p(t,[e]){r===(r=o(t))&&i?i.p(t,e):(i.d(1),i=r(t),i&&(i.c(),i.m(n,null))),4&e&&P(n,"class",t[2])},i:t,o:t,d(t){t&&C(n),i.d(),e[19](null)}}}const Ko=t=>t+"_"+Math.floor(1e9*Math.random())+String(Date.now());let Go=(()=>{let t={listeners:[],scriptId:Ko("tiny-script"),scriptLoaded:!1,injected:!1};return{load:(e,n,o)=>{t.scriptLoaded?o():(t.listeners.push(o),t.injected||((e,n,o,r)=>{t.injected=!0;const i=n.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.src=o,i.onload=()=>{t.listeners.forEach((t=>t())),t.scriptLoaded=!0},n.head&&n.head.appendChild(i)})(t.scriptId,e,n))}}})();function Vo(t,e,n){var o;let r,i,s,{id:c=Ko("tinymce-svelte")}=e,{inline:a}=e,{disabled:u=!1}=e,{apiKey:d="no-api-key"}=e,{channel:p="6"}=e,{scriptSrc:f}=e,{conf:h={}}=e,{modelEvents:m="change input undo redo"}=e,{value:g=""}=e,{text:b=""}=e,{cssClass:$="tinymce-wrapper"}=e,y="",v=u;const w=function(){const t=Y();return(e,n,{cancelable:o=!1}={})=>{const r=t.$$.callbacks[e];if(r){const i=I(e,n,{cancelable:o});return r.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}(),x=()=>{const t="undefined"!=typeof window?window:l.g;return t&&t.tinymce?t.tinymce:null},k=()=>{const t=Object.assign(Object.assign({},h),{target:i,inline:void 0!==a?a:void 0!==h.inline&&h.inline,readonly:u,setup:t=>{n(14,s=t),t.on("init",(()=>{t.setContent(g),t.on(m,(()=>{n(15,y=t.getContent()),y!==g&&(n(5,g=y),n(6,b=t.getContent({format:"text"})))}))})),((t,e)=>{zo.forEach((n=>{t.on(n,(o=>{e(n.toLowerCase(),{eventName:n,event:o,editor:t})}))}))})(t,w),"function"==typeof h.setup&&h.setup(t)}});n(4,i.style.visibility="",i),x().init(t)};var E;return E=()=>{if(null!==x())setTimeout(k,0);else{const t=f||`https://cdn.tiny.cloud/1/${d}/tinymce/${p}/tinymce.min.js`;Go.load(r.ownerDocument,t,(()=>{k()}))}},Y().$$.on_mount.push(E),Y().$$.on_destroy.push((()=>{var t;s&&(null===(t=x())||void 0===t||t.remove(s))})),t.$$set=t=>{"id"in t&&n(0,c=t.id),"inline"in t&&n(1,a=t.inline),"disabled"in t&&n(7,u=t.disabled),"apiKey"in t&&n(8,d=t.apiKey),"channel"in t&&n(9,p=t.channel),"scriptSrc"in t&&n(10,f=t.scriptSrc),"conf"in t&&n(11,h=t.conf),"modelEvents"in t&&n(12,m=t.modelEvents),"value"in t&&n(5,g=t.value),"text"in t&&n(6,b=t.text),"cssClass"in t&&n(2,$=t.cssClass)},t.$$.update=()=>{123040&t.$$.dirty&&(s&&y!==g&&(s.setContent(g),n(6,b=s.getContent({format:"text"}))),s&&u!==v&&(n(16,v=u),"function"==typeof(null===n(13,o=s.mode)||void 0===o?void 0:o.set)?s.mode.set(u?"readonly":"design"):s.setMode(u?"readonly":"design")))},[c,a,$,r,i,g,b,u,d,p,f,h,m,o,s,y,v,function(t){G[t?"unshift":"push"]((()=>{i=t,n(4,i)}))},function(t){G[t?"unshift":"push"]((()=>{i=t,n(4,i)}))},function(t){G[t?"unshift":"push"]((()=>{r=t,n(3,r)}))}]}const Xo=class extends Ct{constructor(t){super(),Tt(this,t,Vo,Yo,c,{id:0,inline:1,disabled:7,apiKey:8,channel:9,scriptSrc:10,conf:11,modelEvents:12,value:5,text:6,cssClass:2})}},Zo=[];const Jo={useTiny:!0},Qo=function(e,n=t){let o;const r=new Set;function i(t){if(c(e,t)&&(e=t,o)){const t=!Zo.length;for(const t of r)t[1](),Zo.push(t,e);if(t){for(let t=0;t<Zo.length;t+=2)Zo[t][0](Zo[t+1]);Zo.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(s,l=t){const c=[s,l];return r.add(c),1===r.size&&(o=n(i)||t),s(e),()=>{r.delete(c),0===r.size&&(o(),o=null)}}}}(Jo);function tr(e){let n,o,r;return{c(){n=A("svg"),o=A("g"),r=A("path"),P(r,"d","M38,52a2,2,0,0,1-1.41-.59l-24-24a2,2,0,0,1,0-2.82l24-24a2,2,0,0,1,2.82,0,2,2,0,0,1,0,2.82L16.83,26,39.41,48.59A2,2,0,0,1,38,52Z"),P(n,"version","1.1"),P(n,"xmlns","http://www.w3.org/2000/svg"),P(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),P(n,"x","0px"),P(n,"y","0px"),P(n,"viewBox","0 0 52 52"),P(n,"xml:space","preserve")},m(t,e){T(t,n,e),x(n,o),x(o,r)},p:t,i:t,o:t,d(t){t&&C(n)}}}const er=class extends Ct{constructor(t){super(),Tt(this,t,null,tr,c,{})}};function nr(t){let e,n,o,r;const i=t[2].default,l=d(i,t,t[1],null);return{c(){e=D("form"),l&&l.c(),P(e,"class","column-card svelte-12n6e3q")},m(i,c){T(i,e,c),l&&l.m(e,null),n=!0,o||(r=_(e,"submit",M((function(){s(t[0])&&t[0].apply(this,arguments)}))),o=!0)},p(e,[o]){t=e,l&&l.p&&(!n||2&o)&&h(l,i,t,t[1],n?f(i,t[1],o,null):m(t[1]),null)},i(t){n||(dt(l,t),n=!0)},o(t){pt(l,t),n=!1},d(t){t&&C(e),l&&l.d(t),o=!1,r()}}}function or(t,e,n){let{$$slots:o={},$$scope:r}=e,{onSubmit:i}=e;return t.$$set=t=>{"onSubmit"in t&&n(0,i=t.onSubmit),"$$scope"in t&&n(1,r=t.$$scope)},[i,r,o]}const rr=class extends Ct{constructor(t){super(),Tt(this,t,or,nr,c,{onSubmit:0})}};function ir(t){let e,n,o,r,s,l;return{c(){e=D("div"),n=D("span"),n.textContent="URL",o=L(),r=D("span"),P(n,"class","label svelte-s2hi7p"),P(r,"class","url svelte-s2hi7p"),P(r,"aria-label","URL"),P(r,"contenteditable",""),void 0===t[3]&&Q((()=>t[10].call(r))),P(e,"class","field svelte-s2hi7p")},m(i,c){T(i,e,c),x(e,n),x(e,o),x(e,r),void 0!==t[3]&&(r.innerHTML=t[3]),s||(l=[_(r,"input",t[10]),_(r,"keydown",t[7])],s=!0)},p(t,e){8&e&&t[3]!==r.innerHTML&&(r.innerHTML=t[3])},d(t){t&&C(e),s=!1,i(l)}}}function sr(e){let n,o,r;return{c(){n=D("textarea"),n.disabled=e[2],P(n,"class","svelte-s2hi7p")},m(t,i){T(t,n,i),R(n,e[1]),o||(r=_(n,"input",e[12]),o=!0)},p(t,e){4&e&&(n.disabled=t[2]),2&e&&R(n,t[1])},i:t,o:t,d(t){t&&C(n),o=!1,r()}}}function lr(t){let e,n,o;function r(e){t[11](e)}let i={disabled:t[2],apiKey:"okcf1pz4foebbixgcdydveaavknj41e62etldhxguuyug0v3",conf:t[8]};return void 0!==t[1]&&(i.value=t[1]),e=new Xo({props:i}),G.push((()=>wt(e,"value",r))),{c(){xt(e.$$.fragment)},m(t,n){kt(e,t,n),o=!0},p(t,o){const r={};4&o&&(r.disabled=t[2]),!n&&2&o&&(n=!0,r.value=t[1],tt((()=>n=!1))),e.$set(r)},i(t){o||(dt(e.$$.fragment,t),o=!0)},o(t){pt(e.$$.fragment,t),o=!1},d(t){Et(e,t)}}}function cr(t){let e,n,o,r,i;return{c(){e=D("label"),n=D("input"),o=O(" Fetch contents"),P(n,"type","checkbox"),P(n,"class","svelte-s2hi7p"),P(e,"class","svelte-s2hi7p")},m(s,l){T(s,e,l),x(e,n),n.checked=t[2],x(e,o),r||(i=_(n,"change",t[13]),r=!0)},p(t,e){4&e&&(n.checked=t[2])},d(t){t&&C(e),r=!1,i()}}}function ar(t){let e,n,o,r,l,c,a,u,d,p,f,h,m,g,b,$,y,v;o=new er({});let w=void 0!==t[3]&&ir(t);const k=[lr,sr],E=[];function S(t,e){return t[6].useTiny?0:1}m=S(t),g=E[m]=k[m](t);let A=t[4]&&cr(t);return{c(){e=D("h3"),n=D("a"),xt(o.$$.fragment),r=O(" back"),l=L(),c=D("div"),a=D("div"),u=D("span"),u.textContent="Title",d=L(),p=D("span"),f=L(),w&&w.c(),h=L(),g.c(),b=L(),A&&A.c(),P(n,"href","#home"),P(n,"class","homelink svelte-s2hi7p"),P(e,"class","back svelte-s2hi7p"),P(u,"class","label svelte-s2hi7p"),P(p,"class","title svelte-s2hi7p"),P(p,"aria-label","Title"),P(p,"contenteditable",""),void 0===t[0]&&Q((()=>t[9].call(p))),P(a,"class","field svelte-s2hi7p"),P(c,"class","chapter edit svelte-s2hi7p")},m(i,g){T(i,e,g),x(e,n),kt(o,n,null),x(n,r),T(i,l,g),T(i,c,g),x(c,a),x(a,u),x(a,d),x(a,p),void 0!==t[0]&&(p.innerHTML=t[0]),x(c,f),w&&w.m(c,null),x(c,h),E[m].m(c,null),x(c,b),A&&A.m(c,null),$=!0,y||(v=[_(n,"click",M((function(){s(t[5])&&t[5].apply(this,arguments)}))),_(p,"input",t[9]),_(p,"keydown",t[7])],y=!0)},p(e,n){t=e,1&n&&t[0]!==p.innerHTML&&(p.innerHTML=t[0]),void 0!==t[3]?w?w.p(t,n):(w=ir(t),w.c(),w.m(c,h)):w&&(w.d(1),w=null);let o=m;m=S(t),m===o?E[m].p(t,n):(at(),pt(E[o],1,1,(()=>{E[o]=null})),ut(),g=E[m],g?g.p(t,n):(g=E[m]=k[m](t),g.c()),dt(g,1),g.m(c,b)),t[4]?A?A.p(t,n):(A=cr(t),A.c(),A.m(c,null)):A&&(A.d(1),A=null)},i(t){$||(dt(o.$$.fragment,t),dt(g),$=!0)},o(t){pt(o.$$.fragment,t),pt(g),$=!1},d(t){t&&C(e),Et(o),t&&C(l),t&&C(c),w&&w.d(),E[m].d(),A&&A.d(),y=!1,i(v)}}}function ur(t){let e,n;return e=new rr({props:{onSubmit:t[5],$$slots:{default:[ar]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};32&n&&(o.onSubmit=t[5]),16511&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function dr(t,e,n){let o;u(t,Qo,(t=>n(6,o=t)));let{title:r}=e,{content:i}=e,{needsFetching:s}=e,{url:l}=e,{canFetch:c=!1}=e,{close:a}=e;return s=null==s||s,i=null!=i?i:"",t.$$set=t=>{"title"in t&&n(0,r=t.title),"content"in t&&n(1,i=t.content),"needsFetching"in t&&n(2,s=t.needsFetching),"url"in t&&n(3,l=t.url),"canFetch"in t&&n(4,c=t.canFetch),"close"in t&&n(5,a=t.close)},t.$$.update=()=>{1&t.$$.dirty&&n(0,r=r.replace(/<[^>]*>/g,""))},[r,i,s,l,c,a,o,t=>{"Enter"!==t.key&&13!==t.keyCode||t.preventDefault()},{plugins:"code",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | code"},function(){r=this.innerHTML,n(0,r)},function(){l=this.innerHTML,n(3,l)},function(t){i=t,n(1,i)},function(){i=this.value,n(1,i)},function(){s=this.checked,n(2,s)}]}const pr=class extends Ct{constructor(t){super(),Tt(this,t,dr,ur,c,{title:0,content:1,needsFetching:2,url:3,canFetch:4,close:5})}};function fr(e){let n,o;return{c(){n=A("svg"),o=A("polygon"),P(o,"points","0,490 490,490 245,0"),P(n,"version","1.1"),P(n,"xmlns","http://www.w3.org/2000/svg"),P(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),P(n,"x","0px"),P(n,"y","0px"),P(n,"viewBox","0 0 490 490"),P(n,"xml:space","preserve")},m(t,e){T(t,n,e),x(n,o)},p:t,i:t,o:t,d(t){t&&C(n)}}}const hr=class extends Ct{constructor(t){super(),Tt(this,t,null,fr,c,{})}};function mr(t){let e,n;return{c(){e=D("span"),n=O(t[5]),P(e,"class","content svelte-1eilaou")},m(t,o){T(t,e,o),x(e,n)},p(t,e){32&e&&F(n,t[5])},d(t){t&&C(e)}}}function gr(t){let e,n,o,r,l,c,a,u,d,p,f,h,m,g,b,$,y,v,w,k=!t[6]&&mr(t);return d=new hr({}),m=new hr({}),{c(){e=D("div"),n=D("div"),o=D("span"),r=O(t[0]),l=L(),k&&k.c(),c=L(),a=D("div"),u=D("a"),xt(d.$$.fragment),p=O(" move up"),f=L(),h=D("a"),xt(m.$$.fragment),g=O(" move down"),b=L(),$=D("a"),$.textContent="remove",P(o,"class","title svelte-1eilaou"),P(o,"aria-label","Title"),P(n,"class","preview svelte-1eilaou"),U(n,"empty",t[6]),P(u,"href","#up"),P(u,"class","small up svelte-1eilaou"),U(u,"control-disabled",!t[2]),P(h,"href","#dowm"),P(h,"class","small down svelte-1eilaou"),U(h,"control-disabled",!t[3]),P($,"href","#remove"),P($,"class","small remove svelte-1eilaou"),P(a,"class","more controls svelte-1eilaou"),P(e,"class","chapter svelte-1eilaou"),P(e,"tabindex","0"),P(e,"title",t[0])},m(i,E){T(i,e,E),x(e,n),x(n,o),x(o,r),x(n,l),k&&k.m(n,null),x(e,c),x(e,a),x(a,u),kt(d,u,null),x(u,p),x(a,f),x(a,h),kt(m,h,null),x(h,g),x(a,b),x(a,$),y=!0,v||(w=[_(u,"click",j(M((function(){s(t[2])&&t[2].apply(this,arguments)})))),_(h,"click",j(M((function(){s(t[3])&&t[3].apply(this,arguments)})))),_($,"click",j(M((function(){s(t[4])&&t[4].apply(this,arguments)})))),_(e,"click",(function(){s(t[1])&&t[1].apply(this,arguments)}))],v=!0)},p(o,[i]){t=o,(!y||1&i)&&F(r,t[0]),t[6]?k&&(k.d(1),k=null):k?k.p(t,i):(k=mr(t),k.c(),k.m(n,null)),64&i&&U(n,"empty",t[6]),4&i&&U(u,"control-disabled",!t[2]),8&i&&U(h,"control-disabled",!t[3]),(!y||1&i)&&P(e,"title",t[0])},i(t){y||(dt(d.$$.fragment,t),dt(m.$$.fragment,t),y=!0)},o(t){pt(d.$$.fragment,t),pt(m.$$.fragment,t),y=!1},d(t){t&&C(e),k&&k.d(),Et(d),Et(m),v=!1,i(w)}}}function br(t,e,n){let o,{title:r}=e,{content:i}=e,{select:s}=e,{moveUp:l}=e,{moveDown:c}=e,{remove:a}=e;i=null!=i?i:"";let u="";return t.$$set=t=>{"title"in t&&n(0,r=t.title),"content"in t&&n(7,i=t.content),"select"in t&&n(1,s=t.select),"moveUp"in t&&n(2,l=t.moveUp),"moveDown"in t&&n(3,c=t.moveDown),"remove"in t&&n(4,a=t.remove)},t.$$.update=()=>{128&t.$$.dirty&&n(6,o=!i||!i.trim().length),128&t.$$.dirty&&setTimeout((()=>n(5,u=At(i||""))),0)},[r,s,l,c,a,u,o,i]}const $r=class extends Ct{constructor(t){super(),Tt(this,t,br,gr,c,{title:0,content:7,select:1,moveUp:2,moveDown:3,remove:4})}};function yr(t){let e,n,o;return{c(){e=D("span"),P(e,"class","edit svelte-1pemcjw"),P(e,"contenteditable",""),void 0===t[0]&&Q((()=>t[7].call(e)))},m(r,i){T(r,e,i),void 0!==t[0]&&(e.innerHTML=t[0]),n||(o=_(e,"input",t[7]),n=!0)},p(t,n){1&n&&t[0]!==e.innerHTML&&(e.innerHTML=t[0])},d(t){t&&C(e),n=!1,o()}}}function vr(t){let e,n,o,r=At(t[0])+"";return{c(){e=D("a"),n=O(r),P(e,"href",o=Dt(t[3])),P(e,"target","_blank")},m(t,o){T(t,e,o),x(e,n)},p(t,i){1&i&&r!==(r=At(t[0])+"")&&F(n,r),8&i&&o!==(o=Dt(t[3]))&&P(e,"href",o)},d(t){t&&C(e)}}}function wr(t){let e,n,o;return{c(){e=D("span"),P(e,"class","edit svelte-1pemcjw"),P(e,"contenteditable",""),void 0===t[1]&&Q((()=>t[8].call(e)))},m(r,i){T(r,e,i),void 0!==t[1]&&(e.innerHTML=t[1]),n||(o=_(e,"input",t[8]),n=!0)},p(t,n){2&n&&t[1]!==e.innerHTML&&(e.innerHTML=t[1])},d(t){t&&C(e),n=!1,o()}}}function xr(t){let e,n=At(t[1])+"";return{c(){e=O(n)},m(t,n){T(t,e,n)},p(t,o){2&o&&n!==(n=At(t[1])+"")&&F(e,n)},d(t){t&&C(e)}}}function kr(t){let e,n,o,r;const i=t[6].default,s=d(i,t,t[9],null);return{c(){e=D("h3"),e.textContent="Chapters",n=L(),o=D("div"),s&&s.c()},m(t,i){T(t,e,i),T(t,n,i),T(t,o,i),s&&s.m(o,null),r=!0},p(t,e){s&&s.p&&(!r||512&e)&&h(s,i,t,t[9],r?f(i,t[9],e,null):m(t[9]),null)},i(t){r||(dt(s,t),r=!0)},o(t){pt(s,t),r=!1},d(t){t&&C(e),t&&C(n),t&&C(o),s&&s.d(t)}}}function Er(t){let e,n,o,r,i,s,l,c,a,u;function d(t,e){return t[2]?yr:vr}let p=d(t),f=p(t);function h(t,e){return t[2]?wr:xr}let m=h(t),g=m(t),b=t[5].default&&kr(t);return{c(){e=D("h3"),e.textContent="Title",n=L(),o=D("p"),f.c(),r=L(),i=D("h3"),i.textContent="Author",s=L(),l=D("p"),g.c(),c=L(),b&&b.c(),a=N()},m(t,d){T(t,e,d),T(t,n,d),T(t,o,d),f.m(o,null),T(t,r,d),T(t,i,d),T(t,s,d),T(t,l,d),g.m(l,null),T(t,c,d),b&&b.m(t,d),T(t,a,d),u=!0},p(t,e){p===(p=d(t))&&f?f.p(t,e):(f.d(1),f=p(t),f&&(f.c(),f.m(o,null))),m===(m=h(t))&&g?g.p(t,e):(g.d(1),g=m(t),g&&(g.c(),g.m(l,null))),t[5].default?b?(b.p(t,e),32&e&&dt(b,1)):(b=kr(t),b.c(),dt(b,1),b.m(a.parentNode,a)):b&&(at(),pt(b,1,1,(()=>{b=null})),ut())},i(t){u||(dt(b),u=!0)},o(t){pt(b),u=!1},d(t){t&&C(e),t&&C(n),t&&C(o),f.d(),t&&C(r),t&&C(i),t&&C(s),t&&C(l),g.d(),t&&C(c),b&&b.d(t),t&&C(a)}}}function Tr(t){let e,n;return e=new rr({props:{onSubmit:t[4],$$slots:{default:[Er]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,[n]){const o={};16&n&&(o.onSubmit=t[4]),559&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Cr(t,e,n){let{$$slots:o={},$$scope:r}=e;const i=function(t){const e={};for(const n in t)e[n]=!0;return e}(o);let{edit:s=!1}=e,{title:l}=e,{author:c}=e,{url:a=""}=e,{onSubmit:u}=e;return t.$$set=t=>{"edit"in t&&n(2,s=t.edit),"title"in t&&n(0,l=t.title),"author"in t&&n(1,c=t.author),"url"in t&&n(3,a=t.url),"onSubmit"in t&&n(4,u=t.onSubmit),"$$scope"in t&&n(9,r=t.$$scope)},[l,c,s,a,u,i,o,function(){l=this.innerHTML,n(0,l)},function(){c=this.innerHTML,n(1,c)},r]}const Sr=class extends Ct{constructor(t){super(),Tt(this,t,Cr,Tr,c,{edit:2,title:0,author:1,url:3,onSubmit:4})}};function Dr(t,e,n){const o=t.slice();return o[35]=e[n],o}function Ar(t,e,n){const o=t.slice();return o[38]=e[n],o[40]=n,o}function Or(t,e){let n,o,r;function i(){return e[17](e[40])}return o=new $r({props:{title:e[38].title,content:e[38].content,select:i,moveUp:(e[2]>0||e[40]>0)&&e[11].bind(null,e[40]),moveDown:(e[2]<e[3]||e[40]<e[4].length-1)&&e[12].bind(null,e[40]),remove:e[13].bind(null,e[40])}}),{key:t,first:null,c(){n=N(),xt(o.$$.fragment),this.first=n},m(t,e){T(t,n,e),kt(o,t,e),r=!0},p(t,n){e=t;const r={};16&n[0]&&(r.title=e[38].title),16&n[0]&&(r.content=e[38].content),48&n[0]&&(r.select=i),20&n[0]&&(r.moveUp=(e[2]>0||e[40]>0)&&e[11].bind(null,e[40])),28&n[0]&&(r.moveDown=(e[2]<e[3]||e[40]<e[4].length-1)&&e[12].bind(null,e[40])),16&n[0]&&(r.remove=e[13].bind(null,e[40])),o.$set(r)},i(t){r||(dt(o.$$.fragment,t),r=!0)},o(t){pt(o.$$.fragment,t),r=!1},d(t){t&&C(n),Et(o,t)}}}function Lr(t){let e,n,o,r,i,l,c=t[6].pre+"";return{c(){e=D("a"),n=O(c),r=O("\n          ."),P(e,"class","small svelte-17sum1b"),P(e,"href",o=`#page ${t[6].pre}`),P(e,"role","navigation")},m(o,c){T(o,e,c),x(e,n),T(o,r,c),i||(l=_(e,"click",M((function(){s(t[14].bind(null,t[6].pre-1))&&t[14].bind(null,t[6].pre-1).apply(this,arguments)}))),i=!0)},p(r,i){t=r,64&i[0]&&c!==(c=t[6].pre+"")&&F(n,c),64&i[0]&&o!==(o=`#page ${t[6].pre}`)&&P(e,"href",o)},d(t){t&&C(e),t&&C(r),i=!1,l()}}}function Nr(t){let e,n,o,r,i,l=t[35]+1+"";return{c(){e=D("a"),n=O(l),P(e,"class","small svelte-17sum1b"),P(e,"href",o=`#page ${t[35]+1}`),P(e,"role","navigation"),U(e,"current",t[35]==t[2])},m(o,l){T(o,e,l),x(e,n),r||(i=_(e,"click",M((function(){s(t[14].bind(null,t[35]))&&t[14].bind(null,t[35]).apply(this,arguments)}))),r=!0)},p(r,i){t=r,64&i[0]&&l!==(l=t[35]+1+"")&&F(n,l),64&i[0]&&o!==(o=`#page ${t[35]+1}`)&&P(e,"href",o),68&i[0]&&U(e,"current",t[35]==t[2])},d(t){t&&C(e),r=!1,i()}}}function _r(t){let e,n,o,r,i,l,c=t[6].post+"";return{c(){e=O(".\n          "),n=D("a"),o=O(c),P(n,"class","small svelte-17sum1b"),P(n,"href",r=`#page ${t[6].post}`),P(n,"role","navigation")},m(r,c){T(r,e,c),T(r,n,c),x(n,o),i||(l=_(n,"click",M((function(){s(t[14].bind(null,t[6].post-1))&&t[14].bind(null,t[6].post-1).apply(this,arguments)}))),i=!0)},p(e,i){t=e,64&i[0]&&c!==(c=t[6].post+"")&&F(o,c),64&i[0]&&r!==(r=`#page ${t[6].post}`)&&P(n,"href",r)},d(t){t&&C(e),t&&C(n),i=!1,l()}}}function Mr(e){let n,o,r,l,c,a,u,d,p,f,h,m,g,b,$,y,v,w=[],k=new Map,E=e[4];const A=t=>t[38].id;for(let t=0;t<E.length;t+=1){let n=Ar(e,E,t),o=A(n);k.set(o,w[t]=Or(o,n))}let N=null!==e[6].pre&&Lr(e),j=e[6].pages,F=[];for(let t=0;t<j.length;t+=1)F[t]=Nr(Dr(e,j,t));let R=null!==e[6].post&&_r(e);return{c(){n=D("div");for(let t=0;t<w.length;t+=1)w[t].c();r=L(),l=D("nav"),c=D("a"),a=O("Previous"),d=O("\n        ::\n        "),N&&N.c(),p=L();for(let t=0;t<F.length;t+=1)F[t].c();f=L(),R&&R.c(),h=O("\n        ::\n        "),m=D("a"),g=O("Next"),P(n,"class","chapters svelte-17sum1b"),P(c,"class","small svelte-17sum1b"),P(c,"href","#prevous"),P(c,"role","navigation"),P(c,"disabled",u=e[2]<=0),P(m,"class","small svelte-17sum1b"),P(m,"href","#next"),P(m,"role","navigation"),P(m,"disabled",b=e[2]>=e[3]),P(l,"class","svelte-17sum1b")},m(i,u){T(i,n,u);for(let t=0;t<w.length;t+=1)w[t].m(n,null);T(i,r,u),T(i,l,u),x(l,c),x(c,a),x(l,d),N&&N.m(l,null),x(l,p);for(let t=0;t<F.length;t+=1)F[t].m(l,null);var b;x(l,f),R&&R.m(l,null),x(l,h),x(l,m),x(m,g),$=!0,y||(v=[(b=o=Ro.call(null,n,{items:e[4],flipDurationMs:Rr}),b&&s(b.destroy)?b.destroy:t),_(n,"consider",e[15]),_(n,"finalize",e[15]),_(c,"click",M(e[18])),_(m,"click",M(e[19]))],y=!0)},p(t,e){if(14396&e[0]&&(E=t[4],at(),w=yt(w,e,A,1,t,E,k,n,$t,Or,null,Ar),ut()),o&&s(o.update)&&16&e[0]&&o.update.call(null,{items:t[4],flipDurationMs:Rr}),(!$||4&e[0]&&u!==(u=t[2]<=0))&&P(c,"disabled",u),null!==t[6].pre?N?N.p(t,e):(N=Lr(t),N.c(),N.m(l,p)):N&&(N.d(1),N=null),16452&e[0]){let n;for(j=t[6].pages,n=0;n<j.length;n+=1){const o=Dr(t,j,n);F[n]?F[n].p(o,e):(F[n]=Nr(o),F[n].c(),F[n].m(l,f))}for(;n<F.length;n+=1)F[n].d(1);F.length=j.length}null!==t[6].post?R?R.p(t,e):(R=_r(t),R.c(),R.m(l,h)):R&&(R.d(1),R=null),(!$||12&e[0]&&b!==(b=t[2]>=t[3]))&&P(m,"disabled",b)},i(t){if(!$){for(let t=0;t<E.length;t+=1)dt(w[t]);$=!0}},o(t){for(let t=0;t<w.length;t+=1)pt(w[t]);$=!1},d(t){t&&C(n);for(let t=0;t<w.length;t+=1)w[t].d();t&&C(r),t&&C(l),N&&N.d(),S(F,t),R&&R.d(),y=!1,i(v)}}}function jr(t){let e,n,o,r,s,l,c,a,u,d;function p(e){t[24](e)}function f(e){t[25](e)}function h(e){t[26](e)}function m(e){t[27](e)}let g={canFetch:!!t[7].apiUrl,close:t[23]};return void 0!==t[7].title&&(g.title=t[7].title),void 0!==t[7].content&&(g.content=t[7].content),void 0!==t[7].needsFetching&&(g.needsFetching=t[7].needsFetching),void 0!==t[7].displayUrl&&(g.url=t[7].displayUrl),n=new pr({props:g}),G.push((()=>wt(n,"title",p))),G.push((()=>wt(n,"content",f))),G.push((()=>wt(n,"needsFetching",h))),G.push((()=>wt(n,"url",m))),{c(){e=D("div"),xt(n.$$.fragment),P(e,"class","svelte-17sum1b"),U(e,"float",t[9])},m(o,r){T(o,e,r),kt(n,e,null),a=!0,u||(d=[_(e,"introend",t[28]),_(e,"outrostart",t[29]),_(e,"outroend",t[30])],u=!0)},p(t,i){const c={};128&i[0]&&(c.canFetch=!!t[7].apiUrl),32&i[0]&&(c.close=t[23]),!o&&128&i[0]&&(o=!0,c.title=t[7].title,tt((()=>o=!1))),!r&&128&i[0]&&(r=!0,c.content=t[7].content,tt((()=>r=!1))),!s&&128&i[0]&&(s=!0,c.needsFetching=t[7].needsFetching,tt((()=>s=!1))),!l&&128&i[0]&&(l=!0,c.url=t[7].displayUrl,tt((()=>l=!1))),n.$set(c),512&i[0]&&U(e,"float",t[9])},i(t){a||(dt(n.$$.fragment,t),t&&Q((()=>{c||(c=ht(e,Bo,{x:50},!0)),c.run(1)})),a=!0)},o(t){pt(n.$$.fragment,t),t&&(c||(c=ht(e,Bo,{x:50},!1)),c.run(0)),a=!1},d(t){t&&C(e),Et(n),t&&c&&c.end(),u=!1,i(d)}}}function Pr(t){let e,n,o,r,s,l,c,a,u,d,p,f,h,m;function g(e){t[21](e)}function b(e){t[22](e)}let $={edit:!0,onSubmit:t[20],$$slots:{default:[Mr]},$$scope:{ctx:t}};void 0!==t[1].title&&($.title=t[1].title),void 0!==t[1].author&&($.author=t[1].author),r=new Sr({props:$}),G.push((()=>wt(r,"title",g))),G.push((()=>wt(r,"author",b)));let y=t[5]>=0&&jr(t);return{c(){e=O("You are editing:\n\n"),n=D("div"),o=D("div"),xt(r.$$.fragment),c=L(),y&&y.c(),a=L(),u=D("button"),u.textContent="Save",d=L(),p=D("a"),p.textContent="Cancel",P(o,"class","svelte-17sum1b"),U(o,"hide",t[8]),P(n,"class","list svelte-17sum1b"),P(u,"type","submit"),P(p,"href","#cancel"),P(p,"class","small")},m(i,s){T(i,e,s),T(i,n,s),x(n,o),kt(r,o,null),x(n,c),y&&y.m(n,null),T(i,a,s),T(i,u,s),T(i,d,s),T(i,p,s),f=!0,h||(m=[_(u,"click",t[31]),_(p,"click",M(t[32]))],h=!0)},p(t,e){const i={};3&e[0]&&(i.onSubmit=t[20]),124&e[0]|1024&e[1]&&(i.$$scope={dirty:e,ctx:t}),!s&&2&e[0]&&(s=!0,i.title=t[1].title,tt((()=>s=!1))),!l&&2&e[0]&&(l=!0,i.author=t[1].author,tt((()=>l=!1))),r.$set(i),256&e[0]&&U(o,"hide",t[8]),t[5]>=0?y?(y.p(t,e),32&e[0]&&dt(y,1)):(y=jr(t),y.c(),dt(y,1),y.m(n,null)):y&&(at(),pt(y,1,1,(()=>{y=null})),ut())},i(t){f||(dt(r.$$.fragment,t),dt(y),f=!0)},o(t){pt(r.$$.fragment,t),pt(y),f=!1},d(t){t&&C(e),t&&C(n),Et(r),y&&y.d(),t&&C(a),t&&C(u),t&&C(d),t&&C(p),h=!1,i(m)}}}const Fr=50,Rr=200;function Ur(t,e,n){let{bookData:o}=e,{goNext:r}=e;const i=Ot(o),s=Ot(o);let l,c,a,u=0,d=-1,p={pre:null,pages:[],post:null},f=!1,h=!0;return t.$$set=t=>{"bookData"in t&&n(16,o=t.bookData),"goNext"in t&&n(0,r=t.goNext)},t.$$.update=()=>{2&t.$$.dirty[0]&&n(3,l=Math.ceil(s.chapters.length/Fr-1)),6&t.$$.dirty[0]&&n(4,c=s.chapters.slice(u*Fr,(u+1)*Fr)),48&t.$$.dirty[0]&&n(7,a=d>=0?c[d]:void 0),76&t.$$.dirty[0]&&(n(6,p.pages=((t,e)=>{const n=new Array(e-t+1);for(let o=t;o<=e;o++)n[o-t]=o;return n})(Math.max(0,u-3),Math.min(l,u+3)),p),n(6,p.pre=0!==p.pages[0]?1:null,p),n(6,p.post=p.pages[p.pages.length-1]!==l?l+1:null,p))},[r,s,u,l,c,d,p,a,f,h,i,t=>{const e=t+Fr*u;e<1||(s.chapters.splice(e-1,2,s.chapters[e],s.chapters[e-1]),n(1,s))},t=>{const e=t+Fr*u;e>=s.chapters.length||(s.chapters.splice(e,2,s.chapters[e+1],s.chapters[e]),n(1,s))},t=>{const e=t+Fr*u;s.chapters.splice(e,1),n(1,s)},t=>{if(u==t){const t=prompt("New page:",""+(u+1)),e=+t;null!==t&&!isNaN(e)&&e>0&&e<=l+1&&n(2,u=e-1)}else n(2,u=t)},t=>{const{info:{source:e,trigger:o}}=t.detail;(t=>{s.chapters.splice(u*Fr,Fr,...t.detail.items),n(1,s)})(t)},o,t=>n(5,d=t),()=>n(2,u--,u),()=>n(2,u++,u),()=>r(s),function(e){t.$$.not_equal(s.title,e)&&(s.title=e,n(1,s))},function(e){t.$$.not_equal(s.author,e)&&(s.author=e,n(1,s))},()=>n(5,d=-1),function(e){t.$$.not_equal(a.title,e)&&(a.title=e,n(7,a),n(5,d),n(4,c),n(1,s),n(2,u))},function(e){t.$$.not_equal(a.content,e)&&(a.content=e,n(7,a),n(5,d),n(4,c),n(1,s),n(2,u))},function(e){t.$$.not_equal(a.needsFetching,e)&&(a.needsFetching=e,n(7,a),n(5,d),n(4,c),n(1,s),n(2,u))},function(e){t.$$.not_equal(a.displayUrl,e)&&(a.displayUrl=e,n(7,a),n(5,d),n(4,c),n(1,s),n(2,u))},()=>{n(8,f=!0),n(9,h=!1)},()=>{n(9,h=!0)},()=>{n(8,f=!1)},()=>r(s),()=>r(i)]}const Ir=class extends Ct{constructor(t){super(),Tt(this,t,Ur,Pr,c,{bookData:16,goNext:0},null,[-1,-1])}};function Hr(t,e,n){const o=t.slice();return o[19]=e[n],o}function Br(t){let e,n,o,r;return e=new Ut({props:{error:t[22],retry:t[17]}}),o=new Pt({props:{backToSearch:t[3]}}),{c(){xt(e.$$.fragment),n=L(),xt(o.$$.fragment)},m(t,i){kt(e,t,i),T(t,n,i),kt(o,t,i),r=!0},p(t,n){const r={};256&n&&(r.error=t[22]),256&n&&(r.retry=t[17]),e.$set(r);const i={};8&n&&(i.backToSearch=t[3]),o.$set(i)},i(t){r||(dt(e.$$.fragment,t),dt(o.$$.fragment,t),r=!0)},o(t){pt(e.$$.fragment,t),pt(o.$$.fragment,t),r=!1},d(t){Et(e,t),t&&C(n),Et(o,t)}}}function zr(t){let e,n,o,r,i,s,l,c,a,u,d,p;function f(t,e){return 256&e&&(i=null),null==i&&(i=!!t[18].chapters.find(ei)),i?Zr:Xr}o=new Sr({props:{title:t[18].title,author:t[18].author,url:t[1].url,$$slots:{default:[Vr]},$$scope:{ctx:t}}});let h=f(t,-1),m=h(t);function g(){return t[16](t[18])}return a=new Pt({props:{backToSearch:t[3]}}),{c(){e=O("Got the following series:\n\n  "),n=D("div"),xt(o.$$.fragment),r=L(),m.c(),s=L(),l=D("button"),l.textContent="Edit book",c=L(),xt(a.$$.fragment),P(n,"class","list svelte-1hsynpq")},m(t,i){T(t,e,i),T(t,n,i),kt(o,n,null),T(t,r,i),m.m(t,i),T(t,s,i),T(t,l,i),T(t,c,i),kt(a,t,i),u=!0,d||(p=_(l,"click",g),d=!0)},p(e,n){t=e;const r={};256&n&&(r.title=t[18].title),256&n&&(r.author=t[18].author),2&n&&(r.url=t[1].url),8389025&n&&(r.$$scope={dirty:n,ctx:t}),o.$set(r),h===(h=f(t,n))&&m?m.p(t,n):(m.d(1),m=h(t),m&&(m.c(),m.m(s.parentNode,s)));const i={};8&n&&(i.backToSearch=t[3]),a.$set(i)},i(t){u||(dt(o.$$.fragment,t),dt(a.$$.fragment,t),u=!0)},o(t){pt(o.$$.fragment,t),pt(a.$$.fragment,t),u=!1},d(t){t&&C(e),t&&C(n),Et(o),t&&C(r),m.d(t),t&&C(s),t&&C(l),t&&C(c),Et(a,t),d=!1,p()}}}function Wr(t){let e;return{c(){e=O("hide")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function qr(t){let e;return{c(){e=O("show")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Yr(t){let e,n,o,r,i,s;return{c(){e=D("span"),n=O("Found "),o=O(t[0]),r=O(" new")},m(l,c){T(l,e,c),x(e,n),x(e,o),x(e,r),i||(s=_(e,"click",t[13]),i=!0)},p(t,e){1&e&&F(o,t[0])},d(t){t&&C(e),i=!1,s()}}}function Kr(t){let e,n=[],o=new Map,r=t[18].chapters;const i=t=>t[19].id;for(let e=0;e<r.length;e+=1){let s=Hr(t,r,e),l=i(s);o.set(l,n[e]=Gr(l,s))}return{c(){e=D("div");for(let t=0;t<n.length;t+=1)n[t].c();P(e,"class","chapter-list svelte-1hsynpq")},m(t,o){T(t,e,o);for(let t=0;t<n.length;t+=1)n[t].m(e,null)},p(t,s){256&s&&(r=t[18].chapters,n=yt(n,s,i,1,t,r,o,e,bt,Gr,null,Hr))},d(t){t&&C(e);for(let t=0;t<n.length;t+=1)n[t].d()}}}function Gr(t,e){let n,o,r,i=At(e[19].title)+"";return{key:t,first:null,c(){n=D("a"),o=O(i),P(n,"href",r=e[19].displayUrl),P(n,"target","_blank"),P(n,"class","small"),this.first=n},m(t,e){T(t,n,e),x(n,o)},p(t,s){e=t,256&s&&i!==(i=At(e[19].title)+"")&&F(o,i),256&s&&r!==(r=e[19].displayUrl)&&P(n,"href",r)},d(t){t&&C(n)}}}function Vr(t){let e,n,o,r,s,l,c,a,u,d,p,f,h,m,g=t[18].chapters.length+"";function b(t,e){return t[7]?Wr:qr}let $=b(t),y=$(t);function v(){return t[12](t[18])}let w="number"==typeof t[0]&&Yr(t),k=t[7]&&Kr(t);return{c(){e=D("p"),n=O("Found "),o=O(g),r=L(),s=D("a"),y.c(),l=L(),c=D("span"),a=L(),u=D("button"),u.textContent="Find more",d=L(),w&&w.c(),p=L(),k&&k.c(),f=N(),P(s,"href","#show"),P(s,"class","small"),P(c,"class","spacer svelte-1hsynpq"),P(e,"class","no-margin svelte-1hsynpq")},m(i,g){T(i,e,g),x(e,n),x(e,o),x(e,r),x(e,s),y.m(s,null),x(e,l),x(e,c),x(e,a),x(e,u),x(e,d),w&&w.m(e,null),T(i,p,g),k&&k.m(i,g),T(i,f,g),h||(m=[_(s,"click",M(t[11])),_(u,"click",v)],h=!0)},p(n,r){t=n,256&r&&g!==(g=t[18].chapters.length+"")&&F(o,g),$!==($=b(t))&&(y.d(1),y=$(t),y&&(y.c(),y.m(s,null))),"number"==typeof t[0]?w?w.p(t,r):(w=Yr(t),w.c(),w.m(e,null)):w&&(w.d(1),w=null),t[7]?k?k.p(t,r):(k=Kr(t),k.c(),k.m(f.parentNode,f)):k&&(k.d(1),k=null)},d(t){t&&C(e),y.d(),w&&w.d(),t&&C(p),k&&k.d(t),t&&C(f),h=!1,i(m)}}}function Xr(t){let e,n,o;function r(){return t[15](t[18])}return{c(){e=D("button"),e.textContent="Generate EPUB"},m(t,i){T(t,e,i),n||(o=_(e,"click",r),n=!0)},p(e,n){t=e},d(t){t&&C(e),n=!1,o()}}}function Zr(t){let e,n,o;function r(){return t[14](t[18])}return{c(){e=D("button"),e.textContent="Fetch chapter contents"},m(t,i){T(t,e,i),n||(o=_(e,"click",r),n=!0)},p(e,n){t=e},d(t){t&&C(e),n=!1,o()}}}function Jr(t){let e,n;return e=new Bt({props:{$$slots:{default:[Qr]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};8388608&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Qr(t){let e;return{c(){e=O("Please wait, fetching data...")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function ti(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Jr,then:zr,catch:Br,value:18,error:22,blocks:[,,,]};return mt(n=t[8],r),{c(){e=N(),r.block.c()},m(t,n){T(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(e,[o]){t=e,r.ctx=t,256&o&&n!==(n=t[8])&&mt(n,r)||gt(r,t,o)},i(t){o||(dt(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1)pt(r.blocks[t]);o=!1},d(t){t&&C(e),r.block.d(t),r.token=null,r=null}}}const ei=t=>!1!==t.needsFetching;function ni(t,e,n){let{series:o}=e,{bookData:r}=e,{newChapters:i}=e,{goNext:s}=e,{backToSearch:l}=e,{edit:c}=e,{findMore:a}=e,{downloadAll:u}=e,d=!1;const p=()=>r?Promise.resolve(Ot(r)):(async t=>{const e=await re(t.url),n=await e.json();if(!e.ok)throw n.message;const o=((t,e)=>{switch(t){case pe.HFY_SERIES:return(({data:{content_md:t,content_html:e}})=>{var n,o,r;const i=(new DOMParser).parseFromString(At(e),"text/html").querySelectorAll("a[href]");return{author:null===(n=t.match(/\[\*\*(?:Author\s*[-:]\s*)?([^*\]]+)\*\*\]|A Story By \[(?:\*\*)?([^\]]+?)(?:\*\*)?\]/i).slice(1).find(Boolean))||void 0===n?void 0:n.trim(),title:null===(r=null===(o=t.match(/##?\s*\*\*(.+)\*\*/))||void 0===o?void 0:o[1])||void 0===r?void 0:r.trim(),chapters:Array.from(i).filter((t=>t.getAttribute("href").match(se))).map((t=>{const e=t.getAttribute("href").startsWith("http")?t.getAttribute("href"):`https://www.reddit.com${t.getAttribute("href")}`;return{id:ie(),title:t.textContent.trim(),apiUrl:St(e),displayUrl:e}}))}})(e);case pe.POST:return(t=>({author:t[0].data.children[0].data.author,title:t[0].data.children[0].data.title,chapters:[de(t)]}))(e)}throw new Error(`Getting data from source type \`${pe[t]}\` not supported, this should never happen`)})(t.type,n);if(!o||!o.chapters||!o.chapters.length)throw new Error("No chapters found");return o})(o);let f=p();return t.$$set=t=>{"series"in t&&n(1,o=t.series),"bookData"in t&&n(10,r=t.bookData),"newChapters"in t&&n(0,i=t.newChapters),"goNext"in t&&n(2,s=t.goNext),"backToSearch"in t&&n(3,l=t.backToSearch),"edit"in t&&n(4,c=t.edit),"findMore"in t&&n(5,a=t.findMore),"downloadAll"in t&&n(6,u=t.downloadAll)},[i,o,s,l,c,a,u,d,f,p,r,()=>n(7,d=!d),t=>a(t),()=>n(0,i=void 0),t=>u(t),t=>s(t),t=>c(t),()=>n(8,f=p())]}const oi=class extends Ct{constructor(t){super(),Tt(this,t,ni,ti,c,{series:1,bookData:10,newChapters:0,goNext:2,backToSearch:3,edit:4,findMore:5,downloadAll:6})}};function ri(t,e,n){const o=t.slice();return o[7]=e[n],o}function ii(t){let e,n;return e=new Ut({props:{error:t[10],retry:t[5]}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};4&n&&(o.error=t[10]),4&n&&(o.retry=t[5]),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function si(e){let n,o,r,i,s,l,c,a,u=e[6],d=[];for(let t=0;t<u.length;t+=1)d[t]=ci(ri(e,u,t));return{c(){n=D("p"),o=O("The search for '"),r=O(e[0]),i=O("' returned these results:"),s=L(),l=D("ul");for(let t=0;t<d.length;t+=1)d[t].c();c=L(),a=D("p"),a.textContent="Please select one.",P(a,"class","small")},m(t,e){T(t,n,e),x(n,o),x(n,r),x(n,i),T(t,s,e),T(t,l,e);for(let t=0;t<d.length;t+=1)d[t].m(l,null);T(t,c,e),T(t,a,e)},p(t,e){if(1&e&&F(r,t[0]),6&e){let n;for(u=t[6],n=0;n<u.length;n+=1){const o=ri(t,u,n);d[n]?d[n].p(o,e):(d[n]=ci(o),d[n].c(),d[n].m(l,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=u.length}},i:t,o:t,d(t){t&&C(n),t&&C(s),t&&C(l),S(d,t),t&&C(c),t&&C(a)}}}function li(t){let e,n,o,r,i=t[7].author+"";return{c(){e=O("["),n=D("i"),o=O(i),r=O("]")},m(t,i){T(t,e,i),T(t,n,i),x(n,o),T(t,r,i)},p(t,e){4&e&&i!==(i=t[7].author+"")&&F(o,i)},d(t){t&&C(e),t&&C(n),t&&C(r)}}}function ci(t){let e,n,o,r,i,s,l,c,a=t[7].title+"";function u(){return t[4](t[7])}let d=t[7].author&&li(t);return{c(){e=D("li"),n=D("a"),o=O(a),i=L(),d&&d.c(),s=L(),P(n,"href",r=Dt(t[7].url))},m(t,r){T(t,e,r),x(e,n),x(n,o),x(e,i),d&&d.m(e,null),x(e,s),l||(c=_(n,"click",M(u)),l=!0)},p(i,l){t=i,4&l&&a!==(a=t[7].title+"")&&F(o,a),4&l&&r!==(r=Dt(t[7].url))&&P(n,"href",r),t[7].author?d?d.p(t,l):(d=li(t),d.c(),d.m(e,s)):d&&(d.d(1),d=null)},d(t){t&&C(e),d&&d.d(),l=!1,c()}}}function ai(t){let e,n;return e=new Bt({props:{$$slots:{default:[ui]},$$scope:{ctx:t}}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2048&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function ui(t){let e;return{c(){e=O("Please wait, fetching results...")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function di(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:ai,then:si,catch:ii,value:6,error:10,blocks:[,,,]};return mt(n=t[2],r),{c(){e=N(),r.block.c()},m(t,n){T(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(e,[o]){t=e,r.ctx=t,4&o&&n!==(n=t[2])&&mt(n,r)||gt(r,t,o)},i(t){o||(dt(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1)pt(r.blocks[t]);o=!1},d(t){t&&C(e),r.block.d(t),r.token=null,r=null}}}function pi(t,e,n){let{search:o}=e,{goNext:r}=e;const i=()=>ae(o).then((t=>{if(!t.length)throw new Error(`No series matched input \`${o}\``);return t}));let s=i();return t.$$set=t=>{"search"in t&&n(0,o=t.search),"goNext"in t&&n(1,r=t.goNext)},[o,r,s,i,t=>r({url:t.url,type:pe.HFY_SERIES}),()=>n(2,s=i())]}const fi=class extends Ct{constructor(t){super(),Tt(this,t,pi,di,c,{search:0,goNext:1})}};function hi(t,e,n){const o=t.slice();return o[4]=e[n],o}function mi(t){let e,n,o={ctx:t,current:null,token:null,hasCatch:!1,pending:yi,then:bi,catch:gi,value:12};return mt(n=t[6](t[4],t[0]),o),{c(){e=N(),o.block.c()},m(t,n){T(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e},p(e,r){t=e,o.ctx=t,17&r&&n!==(n=t[6](t[4],t[0]))&&mt(n,o)||gt(o,t,r)},d(t){t&&C(e),o.block.d(t),o.token=null,o=null}}}function gi(e){return{c:t,m:t,p:t,d:t}}function bi(t){let e,n=t[12],o=[];for(let e=0;e<n.length;e+=1)o[e]=$i(hi(t,n,e));return{c(){e=D("div");for(let t=0;t<o.length;t+=1)o[t].c();P(e,"class","search-results svelte-f6azd4")},m(t,n){T(t,e,n);for(let t=0;t<o.length;t+=1)o[t].m(e,null)},p(t,r){if(83&r){let i;for(n=t[12],i=0;i<n.length;i+=1){const s=hi(t,n,i);o[i]?o[i].p(s,r):(o[i]=$i(s),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(t){t&&C(e),S(o,t)}}}function $i(t){let e,n,o,r,i,s=t[4].title+"";function l(){return t[9](t[4])}return{c(){e=D("a"),n=O(s),P(e,"class","result svelte-f6azd4"),P(e,"href",o=Dt(t[4].url))},m(t,o){T(t,e,o),x(e,n),r||(i=_(e,"click",M(l)),r=!0)},p(r,i){t=r,17&i&&s!==(s=t[4].title+"")&&F(n,s),17&i&&o!==(o=Dt(t[4].url))&&P(e,"href",o)},d(t){t&&C(e),r=!1,i()}}}function yi(e){return{c:t,m:t,p:t,d:t}}function vi(t){let e;return{c(){e=D("p"),e.textContent="Please enter a search string",P(e,"class","small error svelte-f6azd4")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function wi(t){let e,n,o;return{c(){e=D("div"),P(e,"class","overlay svelte-f6azd4")},m(t,n){T(t,e,n),o=!0},i(t){o||(Q((()=>{n||(n=ht(e,Ho,{duration:100},!0)),n.run(1)})),o=!0)},o(t){n||(n=ht(e,Ho,{duration:100},!1)),n.run(0),o=!1},d(t){t&&C(e),t&&n&&n.end()}}}function xi(t){let e,n,o,r,s,l,c,a,u,d,p,f,h,m,g,b,$,y,v=void 0!==t[0]&&!t[0].trim().length,w=t[2]&&mi(t),k=v&&vi(),E=t[2]&&wi();return{c(){e=D("form"),n=D("p"),o=O("Search:\n    "),r=D("input"),s=L(),l=D("input"),a=L(),w&&w.c(),u=L(),k&&k.c(),d=L(),p=D("div"),E&&E.c(),f=L(),h=D("p"),h.textContent="You can:",m=L(),g=D("ul"),g.innerHTML='<li>Search for a series title on the <a href="https://reddit.com/r/HFY/wiki/series" target="_blank">r/HFY wiki</a></li> \n    <li>Enter a series link to the <a href="https://reddit.com/r/HFY" target="_blank">r/HFY</a> wiki</li> \n    <li>Enter a link to any reddit post</li>',P(r,"class","search svelte-f6azd4"),P(r,"placeholder","Search or URL..."),P(l,"type","submit"),l.value="Go",P(l,"class","submit svelte-f6azd4"),l.disabled=c=void 0===t[0]||!t[0].trim().length,P(n,"class","svelte-f6azd4"),P(e,"class","form svelte-f6azd4"),P(h,"class","spaceabove svelte-f6azd4"),P(p,"class","overlay-wrapper svelte-f6azd4")},m(i,c){T(i,e,c),x(e,n),x(n,o),x(n,r),R(r,t[0]),x(n,s),x(n,l),x(e,a),w&&w.m(e,null),t[11](e),T(i,u,c),k&&k.m(i,c),T(i,d,c),T(i,p,c),E&&E.m(p,null),x(p,f),x(p,h),x(p,m),x(p,g),b=!0,$||(y=[_(r,"input",t[8]),_(r,"keyup",t[7]),_(r,"blur",t[5]),_(r,"click",t[7]),_(e,"submit",j(t[10]))],$=!0)},p(t,[n]){1&n&&r.value!==t[0]&&R(r,t[0]),(!b||1&n&&c!==(c=void 0===t[0]||!t[0].trim().length))&&(l.disabled=c),t[2]?w?w.p(t,n):(w=mi(t),w.c(),w.m(e,null)):w&&(w.d(1),w=null),1&n&&(v=void 0!==t[0]&&!t[0].trim().length),v?k||(k=vi(),k.c(),k.m(d.parentNode,d)):k&&(k.d(1),k=null),t[2]?E?4&n&&dt(E,1):(E=wi(),E.c(),dt(E,1),E.m(p,f)):E&&(at(),pt(E,1,1,(()=>{E=null})),ut())},i(t){b||(dt(E),b=!0)},o(t){pt(E),b=!1},d(n){n&&C(e),w&&w.d(),t[11](null),n&&C(u),k&&k.d(n),n&&C(d),n&&C(p),E&&E.d(),$=!1,i(y)}}}function ki(t,e,n){let o,r,{search:i}=e,{goNext:s}=e,l=!1;const c=()=>{n(4,o=o||ae().finally(c)),n(2,l=!1),o.then((()=>n(2,l=!!o&&!!i)))};return t.$$set=t=>{"search"in t&&n(0,i=t.search),"goNext"in t&&n(1,s=t.goNext)},[i,s,l,r,o,t=>n(2,l=r.contains(t.relatedTarget)),async(t,e)=>{if(!t)return[];const o=await t,r=e.toLowerCase(),i=o.filter((t=>-1!==t.title.toLowerCase().indexOf(r)));return i.length||n(2,l=!1),i},c,function(){i=this.value,n(0,i)},t=>s(t.url),()=>s(i||""),function(t){G[t?"unshift":"push"]((()=>{r=t,n(3,r)}))}]}const Ei=class extends Ct{constructor(t){super(),Tt(this,t,ki,xi,c,{search:0,goNext:1})}};var Ti;!function(t){t[t.INPUT=0]="INPUT",t[t.SEARCH=1]="SEARCH",t[t.BOOK_DATA=2]="BOOK_DATA",t[t.EDIT_DATA=3]="EDIT_DATA",t[t.FIND_CHAPTERS=4]="FIND_CHAPTERS",t[t.DOWNLOAD_CHAPTERS=5]="DOWNLOAD_CHAPTERS",t[t.RESULT=6]="RESULT"}(Ti||(Ti={}));class Ci{}class Si extends Ci{constructor(){super(...arguments),this.stage=Ti.INPUT}}class Di extends Ci{constructor(){super(...arguments),this.stage=Ti.SEARCH}}class Ai extends Ci{constructor(t,e){super(),this.bookData=t,this.newChapters=e,this.stage=Ti.BOOK_DATA}}class Oi extends Ci{constructor(t){super(),this.bookData=t,this.stage=Ti.EDIT_DATA}}class Li extends Ci{constructor(t){super(),this.bookData=t,this.stage=Ti.FIND_CHAPTERS}}class Ni extends Ci{constructor(t){super(),this.bookData=t,this.stage=Ti.DOWNLOAD_CHAPTERS}}class _i extends Ci{constructor(t){super(),this.bookData=t,this.stage=Ti.RESULT}}Ti.INPUT,Ti.SEARCH,Ti.BOOK_DATA,Ti.EDIT_DATA,Ti.FIND_CHAPTERS,Ti.DOWNLOAD_CHAPTERS,Ti.RESULT;const Mi=(t,e,...n)=>{const o=new e(...n);return o.from=t,o};function ji(t,e){return!!t&&t.stage===e}function Pi(e){let n;return{c(){n=D("header"),n.innerHTML='<h1 class="svelte-ntsh7z">r/HFY epub generator <a class="small svelte-ntsh7z" href="https://github.com/cpiber/hfy-epub/tree/master/docs/index.md" target="_blank">Help</a></h1>',P(n,"class","svelte-ntsh7z")},m(t,e){T(t,n,e)},p:t,i:t,o:t,d(t){t&&C(n)}}}const Fi=class extends Ct{constructor(t){super(),Tt(this,t,null,Pi,c,{})}};function Ri(e){let n,o,r,i,s,l;return{c(){n=D("p"),o=O("This website ("),r=D("a"),r.textContent="https://cpiber.github.io/hfy-epub",i=O(") does not, and will not, collect any data from its users.\n      Any actions taken on this page are purely in the user's browser; there is no server-side component.\n      No data is ever sent away.\n      For collecting the chapter data, this site contacts "),s=D("code"),s.textContent="www.reddit.com",l=O(" only. The book is generated in the browser."),P(r,"href","https://cpiber.github.io/hfy-epub"),P(r,"target","_blank"),P(n,"class","small svelte-1f8pws6")},m(t,e){T(t,n,e),x(n,o),x(n,r),x(n,i),x(n,s),x(n,l)},p:t,d(t){t&&C(n)}}}function Ui(e){let n,o,r,s,l,c,a,u,d,p,f,h,m,g,b,$,y,v,w=e[0]&&Ri();return{c(){n=D("footer"),o=D("p"),r=O("Made by "),s=D("a"),s.textContent="@cpiber",l=O(".\n    Source Code: "),c=D("a"),c.textContent="cpiber/hfy-epub",a=O(".\n    \n    Version "),u=O("0.2.4"),d=O(".\n    "),p=D("a"),p.textContent="Privacy",f=O("."),h=L(),w&&w.c(),m=L(),g=D("label"),b=D("input"),$=O(" Use TinyMCE chapter editor"),P(s,"href","https://github.com/cpiber"),P(s,"target","_blank"),P(c,"href","https://github.com/cpiber/hfy-epub"),P(c,"target","_blank"),P(p,"href","#privacy"),P(o,"class","small svelte-1f8pws6"),P(b,"type","checkbox"),P(b,"aria-label","use TinyMCE editor"),P(b,"class","svelte-1f8pws6"),P(g,"class","small svelte-1f8pws6"),P(n,"class","svelte-1f8pws6")},m(t,i){T(t,n,i),x(n,o),x(o,r),x(o,s),x(o,l),x(o,c),x(o,a),x(o,u),x(o,d),x(o,p),x(o,f),x(n,h),w&&w.m(n,null),x(n,m),x(n,g),x(g,b),b.checked=e[1].useTiny,x(g,$),y||(v=[_(p,"click",M(e[2])),_(b,"change",e[3])],y=!0)},p(t,[e]){t[0]?w?w.p(t,e):(w=Ri(),w.c(),w.m(n,m)):w&&(w.d(1),w=null),2&e&&(b.checked=t[1].useTiny)},i:t,o:t,d(t){t&&C(n),w&&w.d(),y=!1,i(v)}}}function Ii(t,e,n){let o;u(t,Qo,(t=>n(1,o=t)));let r=!1;return[r,o,()=>n(0,r=!r),function(){o.useTiny=this.checked,Qo.set(o)}]}const Hi=class extends Ct{constructor(t){super(),Tt(this,t,Ii,Ui,c,{})}};function Bi(e){let n,o,r,i,s,l,c;return r=new er({}),{c(){n=D("nav"),o=D("a"),xt(r.$$.fragment),i=O(" home"),P(o,"href","#home"),P(o,"class","homelink svelte-sy8itf"),P(n,"class","mainnav svelte-sy8itf")},m(t,a){T(t,n,a),x(n,o),kt(r,o,null),x(o,i),s=!0,l||(c=_(o,"click",M(e[7])),l=!0)},p:t,i(t){s||(dt(r.$$.fragment,t),s=!0)},o(t){pt(r.$$.fragment,t),s=!1},d(t){t&&C(n),Et(r),l=!1,c()}}}function zi(t){let e,n;return e=new ne({props:{data:t[0].bookData,backToSearch:t[3],backToBook:t[15]}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.data=t[0].bookData),8&n&&(o.backToSearch=t[3]),1&n&&(o.backToBook=t[15]),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Wi(t){let e,n;return e=new Ce({props:{goNext:t[14],data:t[0].bookData}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.goNext=t[14]),1&n&&(o.data=t[0].bookData),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function qi(t){let e,n;return e=new je({props:{goNext:t[13],bookData:t[0].bookData}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.goNext=t[13]),1&n&&(o.bookData=t[0].bookData),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Yi(t){let e,n;return e=new Ir({props:{goNext:t[12],bookData:t[0].bookData}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};1&n&&(o.goNext=t[12]),1&n&&(o.bookData=t[0].bookData),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Ki(t){let e,o;const r=[{goNext:t[8]},{series:t[2]},t[0],{backToSearch:t[3]},{edit:t[9]},{findMore:t[10]},{downloadAll:t[11]}];let i={};for(let t=0;t<r.length;t+=1)i=n(i,r[t]);return e=new oi({props:i}),{c(){xt(e.$$.fragment)},m(t,n){kt(e,t,n),o=!0},p(t,n){const o=13&n?function(t,e){const n={},o={},r={$$scope:1};let i=t.length;for(;i--;){const s=t[i],l=e[i];if(l){for(const t in s)t in l||(o[t]=1);for(const t in l)r[t]||(n[t]=l[t],r[t]=1);t[i]=l}else for(const t in s)r[t]=1}for(const t in o)t in n||(n[t]=void 0);return n}(r,[1&n&&{goNext:t[8]},4&n&&{series:t[2]},1&n&&(i=t[0],"object"==typeof i&&null!==i?i:{}),8&n&&{backToSearch:t[3]},1&n&&{edit:t[9]},1&n&&{findMore:t[10]},1&n&&{downloadAll:t[11]}]):{};var i;e.$set(o)},i(t){o||(dt(e.$$.fragment,t),o=!0)},o(t){pt(e.$$.fragment,t),o=!1},d(t){Et(e,t)}}}function Gi(t){let e,n;return e=new fi({props:{goNext:t[5],search:t[1]}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.search=t[1]),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Vi(t){let e,n;return e=new Ei({props:{goNext:t[4],search:t[1]}}),{c(){xt(e.$$.fragment)},m(t,o){kt(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.search=t[1]),e.$set(o)},i(t){n||(dt(e.$$.fragment,t),n=!0)},o(t){pt(e.$$.fragment,t),n=!1},d(t){Et(e,t)}}}function Xi(t){let e,n,o,r,i,s,l,c,a,u,d,p,f,h,m,g,b,$=!ji(t[0],Ti.INPUT),y=$&&Bi(t);o=new Fi({});const v=[Vi,Gi,Ki,Yi,qi,Wi,zi],w=[];function k(t,e){return 1&e&&(s=null),1&e&&(l=null),1&e&&(c=null),1&e&&(a=null),1&e&&(u=null),1&e&&(d=null),1&e&&(p=null),null==s&&(s=!!ji(t[0],Ti.INPUT)),s?0:(null==l&&(l=!!ji(t[0],Ti.SEARCH)),l?1:(null==c&&(c=!!ji(t[0],Ti.BOOK_DATA)),c?2:(null==a&&(a=!!ji(t[0],Ti.EDIT_DATA)),a?3:(null==u&&(u=!!ji(t[0],Ti.FIND_CHAPTERS)),u?4:(null==d&&(d=!!ji(t[0],Ti.DOWNLOAD_CHAPTERS)),d?5:(null==p&&(p=!!ji(t[0],Ti.RESULT)),p?6:-1))))))}return~(f=k(t,-1))&&(h=w[f]=v[f](t)),g=new Hi({}),{c(){e=D("div"),y&&y.c(),n=L(),xt(o.$$.fragment),r=L(),i=D("main"),h&&h.c(),m=L(),xt(g.$$.fragment),P(i,"class","App-main"),P(e,"class","App svelte-sy8itf")},m(t,s){T(t,e,s),y&&y.m(e,null),x(e,n),kt(o,e,null),x(e,r),x(e,i),~f&&w[f].m(i,null),x(e,m),kt(g,e,null),b=!0},p(t,[o]){1&o&&($=!ji(t[0],Ti.INPUT)),$?y?(y.p(t,o),1&o&&dt(y,1)):(y=Bi(t),y.c(),dt(y,1),y.m(e,n)):y&&(at(),pt(y,1,1,(()=>{y=null})),ut());let r=f;f=k(t,o),f===r?~f&&w[f].p(t,o):(h&&(at(),pt(w[r],1,1,(()=>{w[r]=null})),ut()),~f?(h=w[f],h?h.p(t,o):(h=w[f]=v[f](t),h.c()),dt(h,1),h.m(i,null)):h=null)},i(t){b||(dt(y),dt(o.$$.fragment,t),dt(h),dt(g.$$.fragment,t),b=!0)},o(t){pt(y),pt(o.$$.fragment,t),pt(h),pt(g.$$.fragment,t),b=!1},d(t){t&&C(e),y&&y.d(),Et(o),~f&&w[f].d(),Et(g)}}}function Zi(t,e,n){let o;u(t,Qo,(t=>n(6,o=t)));let r,i,s,l=new Si;return t.$$.update=()=>{1&t.$$.dirty&&n(3,s=ji(l.from,Ti.SEARCH)?()=>n(0,l=Mi(l,Di)):void 0),t.$$.dirty,t.$$.dirty,64&t.$$.dirty&&localStorage.setItem("config",JSON.stringify(o))},[l,r,i,s,t=>{const e=(t=>{try{if(new URL(t),(t=>!!t.match(ce))(t))return pe.HFY_SERIES;if((t=>!!t.match(ue))(t))return pe.POST}catch(t){}return pe.SEARCH})(t);return n(1,r=t),e!==pe.SEARCH&&n(2,i={url:St(t),type:e}),e===pe.SEARCH?n(0,l=Mi(l,Di)):n(0,l=Mi(l,Ai))},t=>{n(2,i=t),n(0,l=Mi(l,Ai))},o,()=>n(0,l=Mi(l,Si)),t=>Mi(l,_i,t),t=>n(0,l=Mi(l,Oi,t)),t=>n(0,l=Mi(l,Li,t)),t=>n(0,l=Mi(l,Ni,t)),t=>n(0,l=Mi(l,Ai,t)),(t,e)=>n(0,l=Mi(l,Ai,t,e)),t=>n(0,l=Mi(l,Ai,t)),()=>n(0,l=Mi(l,Ai))]}(()=>{try{const t=JSON.parse(localStorage.getItem("config"));Qo.set((t=>{if(!t||""+t!="[object Object]")return Jo;const e=Object.keys(t),n=Object.keys(Jo);for(const o of n)e.includes(o)||(t[o]=Jo[o]),typeof Jo[o]!=typeof t[o]&&(t[o]=Jo[o]);return t})(t))}catch(t){}})();const Ji=class extends Ct{constructor(t){super(),Tt(this,t,Zi,Xi,c,{})}};let Qi;try{Qi=new Ji({target:document.body})}catch(t){const e=document.createElement("div");e.className="fatal-error",e.ariaLabel="error",e.appendChild(document.createElement("h1")).textContent="Something went wrong:",e.appendChild(document.createElement("code")).textContent=t,document.body.appendChild(e)}})(),c=l.O(c)})();