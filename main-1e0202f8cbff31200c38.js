(()=>{var t,e,n,r,o,s={4785:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){return function t(e,n,r){var o,s,i=window,l="application/octet-stream",c=r||l,a=e,u=!n&&!r&&a,d=document.createElement("a"),p=function(t){return String(t)},f=i.Blob||i.MozBlob||i.WebKitBlob||p,h=n||"download";if(f=f.call?f.bind(i):Blob,"true"===String(this)&&(c=(a=[a,c])[0],a=a[1]),u&&u.length<2048&&(h=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(e){t(e.target.response,h,l)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(a)){if(!(a.length>2096103.424&&f!==p))return navigator.msSaveBlob?navigator.msSaveBlob($(a),h):y(a);c=(a=$(a)).type||l}else if(/([\x80-\xff])/.test(a)){for(var g=0,v=new Uint8Array(a.length),b=v.length;g<b;++g)v[g]=a.charCodeAt(g);a=new f([v],{type:c})}function $(t){for(var e=t.split(/[:;,]/),n=e[1],r=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=r.length,s=0,i=new Uint8Array(o);s<o;++s)i[s]=r.charCodeAt(s);return new f([i],{type:n})}function y(t,e){if("download"in d)return d.href=t,d.setAttribute("download",h),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){i.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=a instanceof f?a:new f([a],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,h);if(i.URL)y(i.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===p)try{return y("data:"+c+";base64,"+i.btoa(o))}catch(t){return y("data:"+c+","+encodeURIComponent(o))}(s=new FileReader).onload=function(t){y(this.result)},s.readAsDataURL(o)}return!0}})?n.apply(e,[]):n)||(t.exports=r)}},i={};function l(t){var e=i[t];if(void 0!==e)return e.exports;var n=i[t]={id:t,loaded:!1,exports:{}};return s[t].call(n.exports,n,n.exports,l),n.loaded=!0,n.exports}l.m=s,t=[],l.O=(e,n,r,o)=>{if(!n){var s=1/0;for(u=0;u<t.length;u++){for(var[n,r,o]=t[u],i=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(l.O).every((t=>l.O[t](n[c])))?n.splice(c--,1):(i=!1,o<s&&(s=o));if(i){t.splice(u--,1);var a=r();void 0!==a&&(e=a)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[n,r,o]},l.F={},l.E=t=>{Object.keys(l.F).map((e=>{l.F[e](t)}))},l.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return l.d(e,{a:e}),e},n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,l.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var o=Object.create(null);l.r(o);var s={};e=e||[null,n({}),n([]),n(n)];for(var i=2&r&&t;"object"==typeof i&&!~e.indexOf(i);i=n(i))Object.getOwnPropertyNames(i).forEach((e=>s[e]=()=>t[e]));return s.default=()=>t,l.d(o,s),o},l.d=(t,e)=>{for(var n in e)l.o(e,n)&&!l.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},l.f={},l.e=t=>Promise.all(Object.keys(l.f).reduce(((e,n)=>(l.f[n](t,e),e)),[])),l.u=t=>t+"-"+{483:"fefd040803c093fe8d27",845:"74c785c44477a9538d2c"}[t]+".js",l.miniCssF=t=>{},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),l.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},o="hfy-epub:",l.l=(t,e,n,s)=>{if(r[t])r[t].push(e);else{var i,c;if(void 0!==n)for(var a=document.getElementsByTagName("script"),u=0;u<a.length;u++){var d=a[u];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==o+n){i=d;break}}i||(c=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",o+n),i.src=t),r[t]=[e];var p=(e,n)=>{i.onerror=i.onload=null,clearTimeout(f);var o=r[t];if(delete r[t],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((t=>t(n))),e)return e(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),c&&document.head.appendChild(i)}},l.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),l.p="/hfy-epub/",(()=>{var t={179:0};l.f.j=(e,n)=>{var r=l.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=t[e]=[n,o]));n.push(r[2]=o);var s=l.p+l.u(e),i=new Error;l.l(s,(n=>{if(l.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;i.message="Loading chunk "+e+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,r[1](i)}}),"chunk-"+e,e)}},l.F.j=e=>{if(!l.o(t,e)||void 0===t[e]){t[e]=null;var n=document.createElement("link");l.nc&&n.setAttribute("nonce",l.nc),n.rel="prefetch",n.as="script",n.href=l.p+l.u(e),document.head.appendChild(n)}},l.O.j=e=>0===t[e];var e=(e,n)=>{var r,o,[s,i,c]=n,a=0;if(s.some((e=>0!==t[e]))){for(r in i)l.o(i,r)&&(l.m[r]=i[r]);if(c)var u=c(l)}for(e&&e(n);a<s.length;a++)o=s[a],l.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return l.O(u)},n=self.webpackChunkhfy_epub=self.webpackChunkhfy_epub||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),l.O(0,[179],(()=>{l.E(845),l.E(483)}),5);var c={};(()=>{"use strict";function t(){}const e=t=>t;function n(t){return t()}function r(){return Object.create(null)}function o(t){t.forEach(n)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t){return 0===Object.keys(t).length}function a(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(t,e,n,r){if(t){const o=d(t,e,n,r);return t[0](o)}}function d(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function p(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function f(t,e,n,r,o,s){if(o){const i=d(e,n,r,s);t.p(i,o)}}function h(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function m(e){return e&&s(e.destroy)?e.destroy:t}const g="undefined"!=typeof window;let v=g?()=>window.performance.now():()=>Date.now(),b=g?t=>requestAnimationFrame(t):t;const $=new Set;function y(t){$.forEach((e=>{e.c(t)||($.delete(e),e.f())})),0!==$.size&&b(y)}let w=!1;function x(t,e){t.appendChild(e)}function k(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function E(t){const e=D("style");return function(t,e){x(t.head||t,e)}(k(t),e),e.sheet}function S(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode.removeChild(t)}function C(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function D(t){return document.createElement(t)}function O(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function L(t){return document.createTextNode(t)}function A(){return L(" ")}function F(){return L("")}function N(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function R(t){return function(e){return e.preventDefault(),t.call(this,e)}}function _(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function M(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function j(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function P(t,e){t.value=null==e?"":e}function U(t,e,n){t.classList[n?"add":"remove"](e)}function I(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,r,e),o}const H=new Map;let z,B=0;function q(t,e,n,r,o,s,i,l=0){const c=16.666/r;let a="{\n";for(let t=0;t<=1;t+=c){const r=e+(n-e)*s(t);a+=100*t+`%{${i(r,1-r)}}\n`}const u=a+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,p=k(t),{stylesheet:f,rules:h}=H.get(p)||function(t,e){const n={stylesheet:E(e),rules:{}};return H.set(t,n),n}(p,t);h[d]||(h[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${d} ${r}ms linear ${o}ms 1 both`,B+=1,d}function W(t){z=t}function G(){if(!z)throw new Error("Function called outside component initialization");return z}function X(t){G().$$.on_mount.push(t)}function Y(t){G().$$.on_destroy.push(t)}function K(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const V=[],Z=[],J=[],Q=[],tt=Promise.resolve();let et=!1;function nt(t){J.push(t)}function rt(t){Q.push(t)}const ot=new Set;let st,it=0;function lt(){const t=z;do{for(;it<V.length;){const t=V[it];it++,W(t),ct(t.$$)}for(W(null),V.length=0,it=0;Z.length;)Z.pop()();for(let t=0;t<J.length;t+=1){const e=J[t];ot.has(e)||(ot.add(e),e())}J.length=0}while(V.length);for(;Q.length;)Q.pop()();et=!1,ot.clear(),W(t)}function ct(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(nt)}}function at(t,e,n){t.dispatchEvent(I(`${e?"intro":"outro"}${n}`))}const ut=new Set;let dt;function pt(){dt={r:0,c:[],p:dt}}function ft(){dt.r||o(dt.c),dt=dt.p}function ht(t,e){t&&t.i&&(ut.delete(t),t.i(e))}function mt(t,e,n,r){if(t&&t.o){if(ut.has(t))return;ut.add(t),dt.c.push((()=>{ut.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}const gt={duration:0};function vt(n,r,i,l){let c=r(n,i),a=l?0:1,u=null,d=null,p=null;function f(){p&&function(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=n.length-r.length;o&&(t.style.animation=r.join(", "),B-=o,B||b((()=>{B||(H.forEach((t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}})),H.clear())})))}(n,p)}function h(t,e){const n=t.b-a;return e*=Math.abs(n),{a,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function m(r){const{delay:s=0,duration:i=300,easing:l=e,tick:m=t,css:g}=c||gt,w={start:v()+s,b:r};r||(w.group=dt,dt.r+=1),u||d?d=w:(g&&(f(),p=q(n,a,r,i,s,l,g)),r&&m(0,1),u=h(w,i),nt((()=>at(n,r,"start"))),function(t){let e;0===$.size&&b(y),new Promise((n=>{$.add(e={c:t,f:n})}))}((t=>{if(d&&t>d.start&&(u=h(d,i),d=null,at(n,u.b,"start"),g&&(f(),p=q(n,a,u.b,u.duration,0,l,c.css))),u)if(t>=u.end)m(a=u.b,1-a),at(n,u.b,"end"),d||(u.b?f():--u.group.r||o(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;a=u.a+u.d*l(e/u.duration),m(a,1-a)}return!(!u&&!d)})))}return{run(t){s(c)?(st||(st=Promise.resolve(),st.then((()=>{st=null}))),st).then((()=>{c=c(),m(t)})):m(t)},end(){f(),u=d=null}}}function bt(t,e){const n=e.token={};function r(t,r,o,s){if(e.token!==n)return;e.resolved=s;let i=e.ctx;void 0!==o&&(i=i.slice(),i[o]=s);const l=t&&(e.current=t)(i);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(pt(),mt(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ft())})):e.block.d(1),l.c(),ht(l,1),l.m(e.mount(),e.anchor),c=!0),e.block=l,e.blocks&&(e.blocks[r]=l),c&&lt()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=G();if(t.then((t=>{W(n),r(e.then,1,e.value,t),W(null)}),(t=>{if(W(n),r(e.catch,2,e.error,t),W(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function $t(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}function yt(t,e){t.d(1),e.delete(t.key)}function wt(t,e){mt(t,1,1,(()=>{e.delete(t.key)}))}function xt(t,e,n,r,o,s,i,l,c,a,u,d){let p=t.length,f=s.length,h=p;const m={};for(;h--;)m[t[h].key]=h;const g=[],v=new Map,b=new Map;for(h=f;h--;){const t=d(o,s,h),l=n(t);let c=i.get(l);c?r&&c.p(t,e):(c=a(l,t),c.c()),v.set(l,g[h]=c),l in m&&b.set(l,Math.abs(h-m[l]))}const $=new Set,y=new Set;function w(t){ht(t,1),t.m(l,u),i.set(t.key,t),u=t.first,f--}for(;p&&f;){const e=g[f-1],n=t[p-1],r=e.key,o=n.key;e===n?(u=e.first,p--,f--):v.has(o)?!i.has(r)||$.has(r)?w(e):y.has(o)?p--:b.get(r)>b.get(o)?(y.add(r),w(e)):($.add(o),p--):(c(n,i),p--)}for(;p--;){const e=t[p];v.has(e.key)||c(e,i)}for(;f;)w(g[f-1]);return g}let kt;function Et(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function St(t){t&&t.c()}function Tt(t,e,r,i){const{fragment:l,on_mount:c,on_destroy:a,after_update:u}=t.$$;l&&l.m(e,r),i||nt((()=>{const e=c.map(n).filter(s);a?a.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(nt)}function Ct(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Dt(e,n,s,i,l,c,a,u=[-1]){const d=z;W(e);const p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(p.root);let f=!1;if(p.ctx=s?s(e,n.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&l(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),f&&function(t,e){-1===t.$$.dirty[0]&&(V.push(t),et||(et=!0,tt.then(lt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],p.update(),f=!0,o(p.before_update),p.fragment=!!i&&i(p.ctx),n.target){if(n.hydrate){w=!0;const t=(h=n.target,Array.from(h.childNodes));p.fragment&&p.fragment.l(t),t.forEach(T)}else p.fragment&&p.fragment.c();n.intro&&ht(e.$$.fragment),Tt(e,n.target,n.anchor,n.customElement),w=!1,lt()}var h;W(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(kt=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(n).filter(s);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){Ct(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class Ot{$destroy(){Ct(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!c(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Lt(t){let e,n,r,o;const i=t[2].default,l=u(i,t,t[1],null);return{c(){e=D("form"),l&&l.c(),M(e,"class","column-card svelte-12n6e3q")},m(i,c){S(i,e,c),l&&l.m(e,null),n=!0,r||(o=N(e,"submit",R((function(){s(t[0])&&t[0].apply(this,arguments)}))),r=!0)},p(e,[r]){t=e,l&&l.p&&(!n||2&r)&&f(l,i,t,t[1],n?p(i,t[1],r,null):h(t[1]),null)},i(t){n||(ht(l,t),n=!0)},o(t){mt(l,t),n=!1},d(t){t&&T(e),l&&l.d(t),r=!1,o()}}}function At(t,e,n){let{$$slots:r={},$$scope:o}=e,{onSubmit:s}=e;return t.$$set=t=>{"onSubmit"in t&&n(0,s=t.onSubmit),"$$scope"in t&&n(1,o=t.$$scope)},[s,o,r]}const Ft=class extends Ot{constructor(t){super(),Dt(this,t,At,Lt,i,{onSubmit:0})}};function Nt(t,e,n){const r=t.slice();return r[4]=e[n],r}function Rt(t,e){let n,r,o,s,i,l,c,a,u=e[4].label+"";function d(){return e[3](e[4])}return{key:t,first:null,c(){n=D("label"),r=D("input"),i=A(),l=L(u),M(r,"type","radio"),M(r,"name",e[2]),r.value=o=e[4].value,r.checked=s=e[0]===e[4].value,M(n,"class","svelte-1tapr9t"),this.first=n},m(t,e){S(t,n,e),x(n,r),x(n,i),x(n,l),c||(a=N(r,"click",d),c=!0)},p(t,n){e=t,4&n&&M(r,"name",e[2]),2&n&&o!==(o=e[4].value)&&(r.value=o),3&n&&s!==(s=e[0]===e[4].value)&&(r.checked=s),2&n&&u!==(u=e[4].label+"")&&j(l,u)},d(t){t&&T(n),c=!1,a()}}}function _t(e){let n,r=[],o=new Map,s=e[1];const i=t=>t[4].value;for(let t=0;t<s.length;t+=1){let n=Nt(e,s,t),l=i(n);o.set(l,r[t]=Rt(l,n))}return{c(){n=D("div");for(let t=0;t<r.length;t+=1)r[t].c();M(n,"role","radiogroup")},m(t,e){S(t,n,e);for(let t=0;t<r.length;t+=1)r[t].m(n,null)},p(t,[e]){7&e&&(s=t[1],r=xt(r,e,i,1,t,s,o,n,yt,Rt,null,Nt))},i:t,o:t,d(t){t&&T(n);for(let t=0;t<r.length;t+=1)r[t].d()}}}function Mt(t,e,n){let{options:r}=e,{selected:o}=e,{name:s=`radio-${Math.random().toString().slice(2)}`}=e;return t.$$set=t=>{"options"in t&&n(1,r=t.options),"selected"in t&&n(0,o=t.selected),"name"in t&&n(2,s=t.name)},[o,r,s,t=>n(0,o=t.value)]}const jt=class extends Ot{constructor(t){super(),Dt(this,t,Mt,_t,i,{options:1,selected:0,name:2})}},Pt=[];function Ut(e,n=t){let r;const o=new Set;function s(t){if(i(e,t)&&(e=t,r)){const t=!Pt.length;for(const t of o)t[1](),Pt.push(t,e);if(t){for(let t=0;t<Pt.length;t+=2)Pt[t][0](Pt[t+1]);Pt.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(i,l=t){const c=[i,l];return o.add(c),1===o.size&&(r=n(s)||t),i(e),()=>{o.delete(c),0===o.size&&(r(),r=null)}}}}var It,Ht;!function(t){t[t.DEFAULT=0]="DEFAULT",t[t.REGEXP=1]="REGEXP",t[t.FUNCTION=2]="FUNCTION"}(It||(It={})),function(t){t[t.NONE=0]="NONE",t[t.REGEXP=1]="REGEXP",t[t.SELECTOR=2]="SELECTOR",t[t.FUNCTION=3]="FUNCTION"}(Ht||(Ht={}));const zt={useTiny:!0,nextLink:It.DEFAULT,nextLinkRegex:'href="([^"]+)"[^>]*>\\s*Next',nextLinkFn:'return "https://www.reddit.com/r/HFY/comments/f94rak/oc_pthok_eats_an_ice_cream_cone/"',transform:Ht.NONE,transformRegex:".md",transformSelector:"",transformFn:'title = "P\'Thok Eats an Ice Cream Cone"\nhtml = "https://www.reddit.com/r/HFY/comments/f94rak/oc_pthok_eats_an_ice_cream_cone/"'},Bt=Ut(zt),qt=t=>{const e=new Function("sandbox",`with (sandbox) {${t}}`),n=Object.create(null);n.console={log:console.log,table:console.table,error:console.error,assert:console.assert};const r=new Proxy(n,{has:Wt,get:Gt});return t=>(Object.defineProperties(r,t),{proxy:r,ret:e(r)})};function Wt(t,e){return!0}function Gt(t,e){if(e!==Symbol.unscopables)return t[e]}function Xt(t){let e,n,r,o,s,i,l,c,a,u;return{c(){e=D("label"),n=L("Function: "),r=D("span"),r.textContent="Only input code you trust!",o=A(),s=D("textarea"),l=A(),c=D("span"),c.innerHTML="Globals <code>document</code> and <code>html</code> are available; Must produce the url as <code>return</code>",M(r,"class","small warning svelte-5v9ihf"),M(s,"type","text"),M(s,"rows","5"),M(s,"placeholder",i=zt.nextLinkFn),M(s,"class","svelte-5v9ihf"),M(c,"class","small svelte-5v9ihf"),M(e,"class","field svelte-5v9ihf")},m(i,d){S(i,e,d),x(e,n),x(e,r),x(e,o),x(e,s),P(s,t[0].nextLinkFn),x(e,l),x(e,c),a||(u=N(s,"input",t[7]),a=!0)},p(t,e){1&e&&P(s,t[0].nextLinkFn)},d(t){t&&T(e),a=!1,u()}}}function Yt(t){let e,n,r,o,s,i,l,c;return{c(){e=D("label"),n=L("Regex:\n          "),r=D("input"),s=A(),i=D("span"),i.textContent="Must produce the url in the first group",M(r,"type","text"),M(r,"placeholder",o=zt.nextLinkRegex),M(r,"class","svelte-5v9ihf"),M(i,"class","small svelte-5v9ihf"),M(e,"class","field svelte-5v9ihf")},m(o,a){S(o,e,a),x(e,n),x(e,r),P(r,t[0].nextLinkRegex),x(e,s),x(e,i),l||(c=N(r,"input",t[6]),l=!0)},p(t,e){1&e&&r.value!==t[0].nextLinkRegex&&P(r,t[0].nextLinkRegex)},d(t){t&&T(e),l=!1,c()}}}function Kt(e){let n;return{c(){n=D("span"),n.textContent='Finds a "First" link, with fallback to other links that aren\'t "Previous" or "Index" or "First"',M(n,"class","small svelte-5v9ihf")},m(t,e){S(t,n,e)},p:t,d(t){t&&T(n)}}}function Vt(t){let e,n,r,o,s,i,l,c,a,u;return{c(){e=D("label"),n=L("Function: "),r=D("span"),r.textContent="Only input code you trust!",o=A(),s=D("textarea"),l=A(),c=D("span"),c.innerHTML="Globals <code>document</code>, <code>html</code>, <code>title</code> and <code>url</code> are available; Modify the latter two to transform",M(r,"class","small warning svelte-5v9ihf"),M(s,"type","text"),M(s,"rows","5"),M(s,"placeholder",i=zt.transformFn),M(s,"class","svelte-5v9ihf"),M(c,"class","small svelte-5v9ihf"),M(e,"class","field svelte-5v9ihf")},m(i,d){S(i,e,d),x(e,n),x(e,r),x(e,o),x(e,s),P(s,t[0].transformFn),x(e,l),x(e,c),a||(u=N(s,"input",t[11]),a=!0)},p(t,e){1&e&&P(s,t[0].transformFn)},d(t){t&&T(e),a=!1,u()}}}function Zt(t){let e,n,r,o,s,i;return{c(){e=D("label"),n=L("Selector:\n          "),r=D("input"),M(r,"type","text"),M(r,"placeholder",o=zt.transformSelector),M(r,"class","svelte-5v9ihf"),M(e,"class","field svelte-5v9ihf")},m(o,l){S(o,e,l),x(e,n),x(e,r),P(r,t[0].transformSelector),s||(i=N(r,"input",t[10]),s=!0)},p(t,e){1&e&&r.value!==t[0].transformSelector&&P(r,t[0].transformSelector)},d(t){t&&T(e),s=!1,i()}}}function Jt(t){let e,n,r,o,s,i,l,c;return{c(){e=D("label"),n=L("Regex:\n          "),r=D("input"),s=A(),i=D("span"),i.textContent="Must produce the new html in the first group",M(r,"type","text"),M(r,"placeholder",o=zt.transformRegex),M(r,"class","svelte-5v9ihf"),M(i,"class","small svelte-5v9ihf"),M(e,"class","field svelte-5v9ihf")},m(o,a){S(o,e,a),x(e,n),x(e,r),P(r,t[0].transformRegex),x(e,s),x(e,i),l||(c=N(r,"input",t[9]),l=!0)},p(t,e){1&e&&r.value!==t[0].transformRegex&&P(r,t[0].transformRegex)},d(t){t&&T(e),l=!1,c()}}}function Qt(t){let e,n,r,o,s,i,l,c,a,u,d,p,f,h,m,g,v,b,$,y,w,k,E,C,O,F,R;function _(e){t[5](e)}let j={options:[{value:It.DEFAULT,label:"Default"},{value:It.REGEXP,label:"Regex"},{value:It.FUNCTION,label:"Function"}],name:"radio-next-type"};function P(t,e){return t[0].nextLink===It.DEFAULT?Kt:t[0].nextLink===It.REGEXP?Yt:t[0].nextLink===It.FUNCTION?Xt:void 0}void 0!==t[0].nextLink&&(j.selected=t[0].nextLink),f=new jt({props:j}),Z.push((()=>Et(f,"selected",_)));let U=P(t),I=U&&U(t);function H(e){t[8](e)}let z={options:[{value:Ht.NONE,label:"No transform"},{value:Ht.REGEXP,label:"Regex"},{value:Ht.SELECTOR,label:"Query-Selector"},{value:Ht.FUNCTION,label:"Function"}],name:"radio-transform"};function B(t,e){return t[0].transform===Ht.REGEXP?Jt:t[0].transform===Ht.SELECTOR?Zt:t[0].transform===Ht.FUNCTION?Vt:void 0}void 0!==t[0].transform&&(z.selected=t[0].transform),k=new jt({props:z}),Z.push((()=>Et(k,"selected",H)));let q=B(t),W=q&&q(t);return{c(){e=D("h3"),e.textContent="Editor",n=A(),r=D("div"),o=D("label"),s=D("input"),i=L("\n        Use TinyMCE, a powerful HTML editor, for editing chapters"),l=A(),c=D("h3"),c.textContent="Next chapter",a=A(),u=D("div"),d=D("p"),d.textContent="Specify how next chapter links are extracted.",p=A(),St(f.$$.fragment),m=A(),I&&I.c(),g=A(),v=D("h3"),v.textContent="Chapter transform",b=A(),$=D("div"),y=D("p"),y.textContent="Automatically transform chapter contents.",w=A(),St(k.$$.fragment),C=A(),W&&W.c(),M(s,"type","checkbox"),M(s,"class","svelte-5v9ihf"),M(o,"class","field svelte-5v9ihf")},m(h,E){S(h,e,E),S(h,n,E),S(h,r,E),x(r,o),x(o,s),s.checked=t[0].useTiny,x(o,i),S(h,l,E),S(h,c,E),S(h,a,E),S(h,u,E),x(u,d),x(u,p),Tt(f,u,null),x(u,m),I&&I.m(u,null),S(h,g,E),S(h,v,E),S(h,b,E),S(h,$,E),x($,y),x($,w),Tt(k,$,null),x($,C),W&&W.m($,null),O=!0,F||(R=N(s,"change",t[4]),F=!0)},p(t,e){1&e&&(s.checked=t[0].useTiny);const n={};!h&&1&e&&(h=!0,n.selected=t[0].nextLink,rt((()=>h=!1))),f.$set(n),U===(U=P(t))&&I?I.p(t,e):(I&&I.d(1),I=U&&U(t),I&&(I.c(),I.m(u,null)));const r={};!E&&1&e&&(E=!0,r.selected=t[0].transform,rt((()=>E=!1))),k.$set(r),q===(q=B(t))&&W?W.p(t,e):(W&&W.d(1),W=q&&q(t),W&&(W.c(),W.m($,null)))},i(t){O||(ht(f.$$.fragment,t),ht(k.$$.fragment,t),O=!0)},o(t){mt(f.$$.fragment,t),mt(k.$$.fragment,t),O=!1},d(t){t&&T(e),t&&T(n),t&&T(r),t&&T(l),t&&T(c),t&&T(a),t&&T(u),Ct(f),I&&I.d(),t&&T(g),t&&T(v),t&&T(b),t&&T($),Ct(k),W&&W.d(),F=!1,R()}}}function te(t){let e,n,r,o;return{c(){e=D("span"),n=L("Transform Function invalid: "),r=D("code"),o=L(t[3]),M(e,"class","small error svelte-5v9ihf")},m(t,s){S(t,e,s),x(e,n),x(e,r),x(r,o)},p(t,e){8&e&&j(o,t[3])},d(t){t&&T(e)}}}function ee(t){let e,n,r,o;return{c(){e=D("span"),n=L("Transform Selector invalid: "),r=D("code"),o=L(t[3]),M(e,"class","small error svelte-5v9ihf")},m(t,s){S(t,e,s),x(e,n),x(e,r),x(r,o)},p(t,e){8&e&&j(o,t[3])},d(t){t&&T(e)}}}function ne(t){let e,n,r,o;return{c(){e=D("span"),n=L("Transform Regex invalid: "),r=D("code"),o=L(t[3]),M(e,"class","small error svelte-5v9ihf")},m(t,s){S(t,e,s),x(e,n),x(e,r),x(r,o)},p(t,e){8&e&&j(o,t[3])},d(t){t&&T(e)}}}function re(t){let e,n,r,o;return{c(){e=D("span"),n=L("Chapter Function invalid: "),r=D("code"),o=L(t[2]),M(e,"class","small error svelte-5v9ihf")},m(t,s){S(t,e,s),x(e,n),x(e,r),x(r,o)},p(t,e){4&e&&j(o,t[2])},d(t){t&&T(e)}}}function oe(t){let e,n,r,o;return{c(){e=D("span"),n=L("Chapter Regex invalid: "),r=D("code"),o=L(t[2]),M(e,"class","small error svelte-5v9ihf")},m(t,s){S(t,e,s),x(e,n),x(e,r),x(r,o)},p(t,e){4&e&&j(o,t[2])},d(t){t&&T(e)}}}function se(t){let e,n,r,o,s,i,l,c,a,u;function d(t,e){return t[1]&&t[0].nextLink===It.REGEXP&&t[2]?oe:t[1]&&t[0].nextLink===It.FUNCTION&&t[2]?re:t[1]&&t[0].transform===Ht.REGEXP&&t[3]?ne:t[1]&&t[0].transform===Ht.SELECTOR&&t[3]?ee:t[1]&&t[0].transform===Ht.FUNCTION&&t[3]?te:void 0}n=new Ft({props:{$$slots:{default:[Qt]},$$scope:{ctx:t}}});let p=d(t),f=p&&p(t);return{c(){e=D("div"),St(n.$$.fragment),r=A(),o=D("button"),s=L("Save"),i=A(),f&&f.c(),l=F(),M(e,"class","settings svelte-5v9ihf"),M(o,"type","submit"),o.disabled=t[1]},m(d,p){S(d,e,p),Tt(n,e,null),S(d,r,p),S(d,o,p),x(o,s),S(d,i,p),f&&f.m(d,p),S(d,l,p),c=!0,a||(u=N(o,"click",t[12]),a=!0)},p(t,[e]){const r={};262145&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r),(!c||2&e)&&(o.disabled=t[1]),p===(p=d(t))&&f?f.p(t,e):(f&&f.d(1),f=p&&p(t),f&&(f.c(),f.m(l.parentNode,l)))},i(t){c||(ht(n.$$.fragment,t),c=!0)},o(t){mt(n.$$.fragment,t),c=!1},d(t){t&&T(e),Ct(n),t&&T(r),t&&T(o),t&&T(i),f&&f.d(t),t&&T(l),a=!1,u()}}}function ie(t,e,n){let r;a(t,Bt,(t=>n(13,r=t)));const o=Object.assign({},r),s=Object.assign({},r),i=(t,e)=>{if(!t.trim().length)return{error:"Must specify a regular expression",disableSave:!0};try{return new RegExp(t,"i"),{error:void 0,disableSave:e}}catch(t){return{error:t,disableSave:!0}}},l=(t,e)=>{if(!t.trim().length)return{error:"Must specify a function",disableSave:!0};try{return qt(t),{error:void 0,disableSave:e}}catch(t){return{error:t,disableSave:!0}}};let c,u,d=!1;return X((()=>n(1,d=!0))),t.$$.update=()=>{1&t.$$.dirty&&n(1,d=o.nextLink===s.nextLink&&o.nextLinkRegex===s.nextLinkRegex&&o.nextLinkFn===s.nextLinkFn&&o.transform===s.transform&&o.transformRegex===s.transformRegex&&o.transformSelector===s.transformSelector&&o.transformFn===s.transformFn&&o.useTiny===s.useTiny),3&t.$$.dirty&&o.nextLink===It.REGEXP&&n(1,({disableSave:d,error:c}=i(o.nextLinkRegex,d)),d,(n(2,c),n(0,o),n(1,d))),3&t.$$.dirty&&o.nextLink===It.FUNCTION&&n(1,({disableSave:d,error:c}=l(o.nextLinkFn,d)),d,(n(2,c),n(0,o),n(1,d))),3&t.$$.dirty&&o.transform===Ht.REGEXP&&n(1,({disableSave:d,error:u}=i(o.transformRegex,d)),d,(n(3,u),n(0,o),n(1,d))),3&t.$$.dirty&&o.transform===Ht.SELECTOR&&n(1,({disableSave:d,error:u}=((t,e)=>{if(!t.trim().length)return{error:"Must specify a selector",disableSave:!0};try{return document.querySelector(t),{error:void 0,disableSave:e}}catch(t){return{error:t,disableSave:!0}}})(o.transformSelector,d)),d,(n(3,u),n(0,o),n(1,d))),3&t.$$.dirty&&o.transform===Ht.FUNCTION&&n(1,({disableSave:d,error:u}=l(o.transformFn,d)),d,(n(3,u),n(0,o),n(1,d)))},[o,d,c,u,function(){o.useTiny=this.checked,n(0,o)},function(e){t.$$.not_equal(o.nextLink,e)&&(o.nextLink=e,n(0,o))},function(){o.nextLinkRegex=this.value,n(0,o)},function(){o.nextLinkFn=this.value,n(0,o)},function(e){t.$$.not_equal(o.transform,e)&&(o.transform=e,n(0,o))},function(){o.transformRegex=this.value,n(0,o)},function(){o.transformSelector=this.value,n(0,o)},function(){o.transformFn=this.value,n(0,o)},()=>{Bt.set(o),n(1,d=!0)}]}const le=class extends Ot{constructor(t){super(),Dt(this,t,ie,se,i,{})}};var ce=l(4785),ae=l.n(ce);function ue(t){let e,n,r;return{c(){e=D("a"),e.textContent="Back to Search",M(e,"href","#search"),M(e,"class","small")},m(o,i){S(o,e,i),n||(r=N(e,"click",R((function(){s(t[0])&&t[0].apply(this,arguments)}))),n=!0)},p(e,n){t=e},d(t){t&&T(e),n=!1,r()}}}function de(e){let n,r=e[0]&&ue(e);return{c(){r&&r.c(),n=F()},m(t,e){r&&r.m(t,e),S(t,n,e)},p(t,[e]){t[0]?r?r.p(t,e):(r=ue(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&T(n)}}}function pe(t,e,n){let{backToSearch:r}=e;return t.$$set=t=>{"backToSearch"in t&&n(0,r=t.backToSearch)},[r]}const fe=class extends Ot{constructor(t){super(),Dt(this,t,pe,de,i,{backToSearch:0})}};function he(t,e,n){const r=t.slice();return r[4]=e[n],r}function me(e){let n,r,o,s,i=e[4]?": ":"",l=(e[4].message||e[4])+"";return{c(){n=D("span"),r=L("Sorry, can't process that"),o=L(i),s=L(l),M(n,"class","error svelte-m4i2yw")},m(t,e){S(t,n,e),x(n,r),x(n,o),x(n,s)},p:t,d(t){t&&T(n)}}}function ge(t){let e,n,r;return{c(){e=D("a"),e.textContent="back",M(e,"href","#back")},m(o,i){S(o,e,i),n||(r=N(e,"click",R((function(){s(t[1])&&t[1].apply(this,arguments)}))),n=!0)},p(e,n){t=e},d(t){t&&T(e),n=!1,r()}}}function ve(e){let n,r,o,i,l,c,a,u=e[2],d=[];for(let t=0;t<u.length;t+=1)d[t]=me(he(e,u,t));let p=e[1]&&ge(e);return{c(){n=D("p");for(let t=0;t<d.length;t+=1)d[t].c();r=A(),o=D("button"),o.textContent="Retry",i=A(),p&&p.c(),l=F()},m(t,u){S(t,n,u);for(let t=0;t<d.length;t+=1)d[t].m(n,null);S(t,r,u),S(t,o,u),S(t,i,u),p&&p.m(t,u),S(t,l,u),c||(a=N(o,"click",(function(){s(e[0])&&e[0].apply(this,arguments)})),c=!0)},p(t,[r]){if(e=t,4&r){let t;for(u=e[2],t=0;t<u.length;t+=1){const o=he(e,u,t);d[t]?d[t].p(o,r):(d[t]=me(o),d[t].c(),d[t].m(n,null))}for(;t<d.length;t+=1)d[t].d(1);d.length=u.length}e[1]?p?p.p(e,r):(p=ge(e),p.c(),p.m(l.parentNode,l)):p&&(p.d(1),p=null)},i:t,o:t,d(t){t&&T(n),C(d,t),t&&T(r),t&&T(o),t&&T(i),p&&p.d(t),t&&T(l),c=!1,a()}}}function be(t,e,n){let{error:r}=e,{retry:o}=e,{back:s}=e,i=Array.isArray(r)?r:[r];return t.$$set=t=>{"error"in t&&n(3,r=t.error),"retry"in t&&n(0,o=t.retry),"back"in t&&n(1,s=t.back)},[o,s,i,r]}const $e=class extends Ot{constructor(t){super(),Dt(this,t,be,ve,i,{error:3,retry:0,back:1})}};function ye(t){let e,n,r,o,s;const i=t[1].default,l=u(i,t,t[0],null),c=l||function(t){let e;return{c(){e=L("Loading...")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}();return{c(){e=D("div"),n=D("div"),n.innerHTML='<span class="loading-slider svelte-w1n7v1">â€¢</span>',r=A(),o=D("p"),c&&c.c(),M(n,"class","loading-slider-container svelte-w1n7v1"),M(o,"class","loading svelte-w1n7v1"),M(e,"class","loading-container svelte-w1n7v1")},m(t,i){S(t,e,i),x(e,n),x(e,r),x(e,o),c&&c.m(o,null),s=!0},p(t,[e]){l&&l.p&&(!s||1&e)&&f(l,i,t,t[0],s?p(i,t[0],e,null):h(t[0]),null)},i(t){s||(ht(c,t),s=!0)},o(t){mt(c,t),s=!1},d(t){t&&T(e),c&&c.d(t)}}}function we(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}const xe=class extends Ot{constructor(t){super(),Dt(this,t,we,ye,i,{})}};function ke(t){const e=t-1;return e*e*e+1}const Ee=t=>(t instanceof URL||(t=new URL(t)),t.hostname="www.reddit.com",t.pathname.endsWith("/")?t.pathname=`${t.pathname.slice(0,t.pathname.length-1)}.json`:t.pathname.endsWith(".json")||(t.pathname+=".json"),t.protocol="https",t.search="",t.hash="",t.toString()),Se=t=>t.slice(0,-5).replace("https://api","https://www"),Te=(()=>{const t=new DOMParser;return e=>t.parseFromString(e,"text/html").documentElement.textContent})(),Ce=t=>Object.assign(Object.assign({},t),{chapters:t.chapters.map((t=>Object.assign({},t)))});function De(t){return"string"==typeof t||t instanceof String}function Oe(t,{delay:e=0,duration:n=200,prop:r="height",easing:o=ke}={}){const s=getComputedStyle(t)[r];if(!De(s)||!s.endsWith("px"))throw new Error(`invalid property '${r}' does not return pixels`);const i=+s.slice(0,-2);return{delay:e,duration:n,easing:o,css:t=>`overflow: hidden; ${r}: ${t*i}px`}}function Le(t,e,n){const r=t.slice();return r[8]=e[n][0],r[9]=e[n][1],r}function Ae(t,e,n){const r=t.slice();return r[8]=e[n][0],r[9]=e[n][1],r}function Fe(t){let e,n,r,o,i,l,c,a;return e=new $e({props:{error:t[15],retry:t[6]}}),i=new fe({props:{backToSearch:t[1]}}),{c(){St(e.$$.fragment),n=A(),r=D("button"),r.textContent="Back to book",o=A(),St(i.$$.fragment)},m(u,d){Tt(e,u,d),S(u,n,d),S(u,r,d),S(u,o,d),Tt(i,u,d),l=!0,c||(a=N(r,"click",(function(){s(t[0].next.bind(t[0]))&&t[0].next.bind(t[0]).apply(this,arguments)})),c=!0)},p(n,r){t=n;const o={};8&r&&(o.error=t[15]),8&r&&(o.retry=t[6]),e.$set(o);const s={};2&r&&(s.backToSearch=t[1]),i.$set(s)},i(t){l||(ht(e.$$.fragment,t),ht(i.$$.fragment,t),l=!0)},o(t){mt(e.$$.fragment,t),mt(i.$$.fragment,t),l=!1},d(t){Ct(e,t),t&&T(n),t&&T(r),t&&T(o),Ct(i,t),c=!1,a()}}}function Ne(t){let e,n,r,i,l,c,a,u,d,p,f,h,m=t[2].find(He);function g(){return t[5](t[12])}a=new fe({props:{backToSearch:t[1]}});let v=m&&Re(t);return{c(){e=D("h3"),e.textContent="Your e-book is ready!",n=A(),r=D("button"),r.textContent="Download",i=A(),l=D("button"),l.textContent="Back to book",c=A(),St(a.$$.fragment),u=A(),v&&v.c(),d=F(),M(e,"class","valid svelte-ardw9p")},m(o,m){S(o,e,m),S(o,n,m),S(o,r,m),S(o,i,m),S(o,l,m),S(o,c,m),Tt(a,o,m),S(o,u,m),v&&v.m(o,m),S(o,d,m),p=!0,f||(h=[N(r,"click",g),N(l,"click",(function(){s(t[0].next.bind(t[0]))&&t[0].next.bind(t[0]).apply(this,arguments)}))],f=!0)},p(e,n){t=e;const r={};2&n&&(r.backToSearch=t[1]),a.$set(r),4&n&&(m=t[2].find(He)),m?v?v.p(t,n):(v=Re(t),v.c(),v.m(d.parentNode,d)):v&&(v.d(1),v=null)},i(t){p||(ht(a.$$.fragment,t),p=!0)},o(t){mt(a.$$.fragment,t),p=!1},d(t){t&&T(e),t&&T(n),t&&T(r),t&&T(i),t&&T(l),t&&T(c),Ct(a,t),t&&T(u),v&&v.d(t),t&&T(d),f=!1,o(h)}}}function Re(t){let e,n=t[2],r=[];for(let e=0;e<n.length;e+=1)r[e]=Me(Le(t,n,e));return{c(){e=D("div");for(let t=0;t<r.length;t+=1)r[t].c();M(e,"class","logs svelte-ardw9p")},m(t,n){S(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(4&o){let s;for(n=t[2],s=0;s<n.length;s+=1){const i=Le(t,n,s);r[s]?r[s].p(i,o):(r[s]=Me(i),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(t){t&&T(e),C(r,t)}}}function _e(t){let e,n,r=t[9]+"";return{c(){e=D("p"),n=L(r),M(e,"class","small warning svelte-ardw9p")},m(t,r){S(t,e,r),x(e,n)},p(t,e){4&e&&r!==(r=t[9]+"")&&j(n,r)},d(t){t&&T(e)}}}function Me(t){let e,n="warn"===t[8]&&_e(t);return{c(){n&&n.c(),e=F()},m(t,r){n&&n.m(t,r),S(t,e,r)},p(t,r){"warn"===t[8]?n?n.p(t,r):(n=_e(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&T(e)}}}function je(t){let e,n,r,o;e=new xe({props:{$$slots:{default:[Pe]},$$scope:{ctx:t}}});let s=t[2],i=[];for(let e=0;e<s.length;e+=1)i[e]=Ue(Ae(t,s,e));return{c(){St(e.$$.fragment),n=A(),r=D("div");for(let t=0;t<i.length;t+=1)i[t].c();M(r,"class","logs svelte-ardw9p")},m(t,s){Tt(e,t,s),S(t,n,s),S(t,r,s);for(let t=0;t<i.length;t+=1)i[t].m(r,null);o=!0},p(t,n){const o={};if(65536&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),4&n){let e;for(s=t[2],e=0;e<s.length;e+=1){const o=Ae(t,s,e);i[e]?i[e].p(o,n):(i[e]=Ue(o),i[e].c(),i[e].m(r,null))}for(;e<i.length;e+=1)i[e].d(1);i.length=s.length}},i(t){o||(ht(e.$$.fragment,t),o=!0)},o(t){mt(e.$$.fragment,t),o=!1},d(t){Ct(e,t),t&&T(n),t&&T(r),C(i,t)}}}function Pe(t){let e;return{c(){e=L("Please wait, generating e-book...")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function Ue(t){let e,n,r=t[9]+"";return{c(){e=D("p"),n=L(r),M(e,"class","small svelte-ardw9p"),U(e,"warning","warn"===t[8])},m(t,r){S(t,e,r),x(e,n)},p(t,o){4&o&&r!==(r=t[9]+"")&&j(n,r),4&o&&U(e,"warning","warn"===t[8])},d(t){t&&T(e)}}}function Ie(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:je,then:Ne,catch:Fe,value:12,error:15,blocks:[,,,]};return bt(n=t[3],o),{c(){e=F(),o.block.c()},m(t,n){S(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,8&r&&n!==(n=t[3])&&bt(n,o)||$t(o,t,r)},i(t){r||(ht(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)mt(o.blocks[t]);r=!1},d(t){t&&T(e),o.block.d(t),o.token=null,o=null}}}const He=([t])=>"warn"===t;function ze(t,e,n){let{stage:r}=e,{backToSearch:o}=e;const s=Promise.all([l.e(845),l.e(483)]).then(l.t.bind(l,9845,23));let i=[];const c=async()=>{n(2,i=[]);const{default:t}=await s;return await t({title:Te(r.bookData.title),author:Te(r.bookData.author),ignoreFailedDownloads:!0,verbose:(t,e,...r)=>{i.push([t,e]),n(2,i)}},r.bookData.chapters.map((t=>({title:Te(t.title),content:t.content,url:t.displayUrl}))))};let a=c();return t.$$set=t=>{"stage"in t&&n(0,r=t.stage),"backToSearch"in t&&n(1,o=t.backToSearch)},[r,o,i,a,c,t=>ae()(t,`${Te(r.bookData.author)} - ${Te(r.bookData.title)}.epub`,"application/epub+zip"),()=>n(3,a=c())]}const Be=class extends Ot{constructor(t){super(),Dt(this,t,ze,Ie,i,{stage:0,backToSearch:1})}},qe=async(t,e)=>{const n="undefined"!=typeof AbortController?new AbortController:{},r=setTimeout((()=>n.abort&&n.abort()),e);try{return await fetch(t,{signal:n.signal})}finally{clearTimeout(r)}},We=async(t,e=1e4,n=3)=>{for(let r=0;r<n-1;r++)try{return await qe(t,e)}catch(e){console.log(`Failed to fetch \`${t}\` ${r+1} ${0===r?"time":"times"}. Retrying...`)}return qe(t,e)};let Ge=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_")),"");const Xe=/(?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/.+/i,Ye=/href="((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/[^"]+)"[^>]*>\s*([^<]+)/gim,Ke=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/hfy\/wiki\/series\//i,Ve=async t=>{const e=await We("https://www.reddit.com/r/hfy/wiki/series.json"),n=await e.json();if(!e.ok)throw n.message;const r=[...n.data.content_md.matchAll(/\[([^\]]+)\]\s*\(((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/hfy\/wiki\/series\/[^)]+)\)\s*(?:\[\*([^\]]+)\*\])?/gim)].map((t=>({title:t[1],author:t[3],url:Ee(t[2].startsWith("http")?t[2]:`https://www.reddit.com${t[2]}`)})));if(!t)return r;const o=t.toLowerCase();return r.filter((t=>-1!==t.title.toLowerCase().indexOf(o)))},Ze=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/([^/]+)\/comments\//i,Je=t=>({id:t[0].data.children[0].data.id,title:t[0].data.children[0].data.title,content:Te(t[0].data.children[0].data.selftext_html),apiUrl:Ee(t[0].data.children[0].data.url),displayUrl:t[0].data.children[0].data.url,needsFetching:!1});var Qe;!function(t){t[t.HFY_SERIES=0]="HFY_SERIES",t[t.POST=1]="POST",t[t.SEARCH=2]="SEARCH"}(Qe||(Qe={}));const tn=new DOMParser;let en,nn;const rn=(t,e)=>{switch(t.nextLink){case It.DEFAULT:return(t=>{const e=t.match(/href="([^"]+)"[^>]*>\s*Next/i);if(e)return e[1];const n=[...t.matchAll(Ye)].reverse().find((t=>{const e=t[3].toLowerCase();return!e.startsWith("first")&&!e.startsWith("prev")&&!e.startsWith("index")}));return n?n[1]:void 0})(e);case It.REGEXP:return(t=>{const e=t.match(en);if(e&&e.length>1)return e[1]})(e);case It.FUNCTION:return(t=>{let e;return nn({document:{get:()=>e=null!=e?e:tn.parseFromString(t,"text/html"),configurable:!0},html:{writable:!1,value:t,configurable:!0}}).ret})(e)}};let on;const sn=t=>{const e=t.match(on);return e&&e.length>1&&(t=e[1]),t};let ln;const cn=(t,e)=>{switch(t.transform){case Ht.NONE:return Object.assign({},e);case Ht.REGEXP:return Object.assign(Object.assign({},e),{content:sn(e.content||"")});case Ht.SELECTOR:return Object.assign(Object.assign({},e),{content:(n=t.transformSelector,r=e.content||"",null===(o=tn.parseFromString(r,"text/html").querySelector(n))||void 0===o?void 0:o.innerHTML)});case Ht.FUNCTION:return(t=>{let e;const n={document:{get:()=>e=null!=e?e:tn.parseFromString(t.content||"","text/html"),configurable:!0},title:{writable:!0,value:t.title,configurable:!0},html:{writable:!0,value:t.content,configurable:!0},url:{writable:!0,value:t.displayUrl,configurable:!0}},{proxy:r}=ln(n);return Object.assign(Object.assign({},t),{title:De(r.title)?r.title:t.title,content:De(r.html)?r.html:t.content,displayUrl:De(r.url)?r.url:t.displayUrl})})(e)}var n,r,o},an=(t,e)=>e.map(cn.bind(null,t));function un(t,e,n){const r=t.slice();return r[8]=e[n],r}function dn(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function pn(e){let n,r=!e[2].length&&fn(e);return{c(){r&&r.c(),n=F()},m(t,e){r&&r.m(t,e),S(t,n,e)},p(t,e){t[2].length?r&&(r.d(1),r=null):r?r.p(t,e):(r=fn(t),r.c(),r.m(n.parentNode,n))},i:t,o:t,d(t){r&&r.d(t),t&&T(n)}}}function fn(t){let e,n=t[0].next(t[11])+"";return{c(){e=L(n)},m(t,n){S(t,e,n)},p(t,r){9&r&&n!==(n=t[0].next(t[11])+"")&&j(e,n)},d(t){t&&T(e)}}}function hn(t){let e,n;return e=new xe({props:{$$slots:{default:[mn]},$$scope:{ctx:t}}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};4096&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function mn(t){let e;return{c(){e=L("Please wait, fetching chapters...")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function gn(t){let e,n,r=t[8].title+"";return{c(){e=D("p"),n=L(r),M(e,"class","valid small svelte-1rrnlr6")},m(t,r){S(t,e,r),x(e,n)},p(t,e){2&e&&r!==(r=t[8].title+"")&&j(n,r)},d(t){t&&T(e)}}}function vn(t){let e,n=t[8]&&!0===t[8].new&&gn(t);return{c(){n&&n.c(),e=F()},m(t,r){n&&n.m(t,r),S(t,e,r)},p(t,r){t[8]&&!0===t[8].new?n?n.p(t,r):(n=gn(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&T(e)}}}function bn(e){let n,r,o=e[2],s=$n(e);return{c(){s.c(),n=F()},m(t,e){s.m(t,e),S(t,n,e),r=!0},p(e,r){4&r&&i(o,o=e[2])?(pt(),mt(s,1,1,t),ft(),s=$n(e),s.c(),ht(s,1),s.m(n.parentNode,n)):s.p(e,r)},i(t){r||(ht(s),r=!0)},o(t){mt(s),r=!1},d(t){t&&T(n),s.d(t)}}}function $n(t){let e,n;return e=new $e({props:{error:t[2],retry:t[5],back:t[6]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[2]),8&n&&(r.retry=t[5]),3&n&&(r.back=t[6]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function yn(t){let e,n,r,o,s,i,l={ctx:t,current:null,token:null,hasCatch:!1,pending:hn,then:pn,catch:dn,value:11,blocks:[,,,]};bt(e=t[3],l);let c=t[1],a=[];for(let e=0;e<c.length;e+=1)a[e]=vn(un(t,c,e));let u=t[2].length&&bn(t);return{c(){l.block.c(),n=A(),r=D("div");for(let t=0;t<a.length;t+=1)a[t].c();o=A(),u&&u.c(),s=F(),M(r,"class","chapters svelte-1rrnlr6")},m(t,e){l.block.m(t,l.anchor=e),l.mount=()=>n.parentNode,l.anchor=n,S(t,n,e),S(t,r,e);for(let t=0;t<a.length;t+=1)a[t].m(r,null);S(t,o,e),u&&u.m(t,e),S(t,s,e),i=!0},p(n,[o]){if(t=n,l.ctx=t,8&o&&e!==(e=t[3])&&bt(e,l)||$t(l,t,o),2&o){let e;for(c=t[1],e=0;e<c.length;e+=1){const n=un(t,c,e);a[e]?a[e].p(n,o):(a[e]=vn(n),a[e].c(),a[e].m(r,null))}for(;e<a.length;e+=1)a[e].d(1);a.length=c.length}t[2].length?u?(u.p(t,o),4&o&&ht(u,1)):(u=bn(t),u.c(),ht(u,1),u.m(s.parentNode,s)):u&&(pt(),mt(u,1,1,(()=>{u=null})),ft())},i(t){i||(ht(l.block),ht(u),i=!0)},o(t){for(let t=0;t<3;t+=1)mt(l.blocks[t]);mt(u),i=!1},d(t){l.block.d(t),l.token=null,l=null,t&&T(n),t&&T(r),C(a,t),t&&T(o),u&&u.d(t),t&&T(s)}}}function wn(t,e,n){let r;a(t,Bt,(t=>n(7,r=t)));let{stage:o}=e,s=[...o.bookData.chapters.map((t=>Object.assign(Object.assign({},t),{new:!1})))],i=[];const l=async()=>{let t=s;n(1,s=new Array(s.length)),n(2,i=[]);for(let e=0;e<t.length;e+=100)await Promise.all(t.slice(e,e+100).map((async(o,l)=>{if(n(1,s[l+e]=Object.assign({},t[l+e]),s),!1!==o.needsFetching)try{const t=await We(o.apiUrl),i=await t.json();if(!t.ok)throw i.message;n(1,s[l+e]=Object.assign(Object.assign({},cn(r,Je(i))),{new:!0}),s),n(1,s)}catch(t){i.push(t),n(2,i)}})));return Object.assign(Object.assign({},o.bookData),{chapters:s})};let c=l();return t.$$set=t=>{"stage"in t&&n(0,o=t.stage)},[o,s,i,c,l,()=>n(3,c=l()),()=>o.next({...o.bookData,chapters:s})]}Bt.subscribe((t=>{en=new RegExp(t.nextLinkRegex,"i"),nn=qt(t.nextLinkFn),on=new RegExp(t.transformRegex,"i"),ln=qt(t.transformFn)}));const xn=class extends Ot{constructor(t){super(),Dt(this,t,wn,yn,i,{stage:0})}};function kn(t,e,n){const r=t.slice();return r[11]=e[n],r}function En(t){let e,n;return e=new $e({props:{error:t[15],retry:t[7],back:t[8]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};8&n&&(r.error=t[15]),8&n&&(r.retry=t[7]),7&n&&(r.back=t[8]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function Sn(e){let n,r=e[0].next(e[14],e[1].length)+"";return{c(){n=L(r)},m(t,e){S(t,n,e)},p(t,e){11&e&&r!==(r=t[0].next(t[14],t[1].length)+"")&&j(n,r)},i:t,o:t,d(t){t&&T(n)}}}function Tn(t){let e,n,r,o,i,l,c;e=new xe({props:{$$slots:{default:[Cn]},$$scope:{ctx:t}}});let a=t[1],u=[];for(let e=0;e<a.length;e+=1)u[e]=Dn(kn(t,a,e));return{c(){St(e.$$.fragment),n=A(),r=D("div");for(let t=0;t<u.length;t+=1)u[t].c();M(r,"class","chapters")},m(s,a){Tt(e,s,a),S(s,n,a),S(s,r,a);for(let t=0;t<u.length;t+=1)u[t].m(r,null);i=!0,l||(c=m(o=t[6].call(null,r,{newchapters:t[1],scroll:t[4]})),l=!0)},p(t,n){const i={};if(65536&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i),2&n){let e;for(a=t[1],e=0;e<a.length;e+=1){const o=kn(t,a,e);u[e]?u[e].p(o,n):(u[e]=Dn(o),u[e].c(),u[e].m(r,null))}for(;e<u.length;e+=1)u[e].d(1);u.length=a.length}o&&s(o.update)&&18&n&&o.update.call(null,{newchapters:t[1],scroll:t[4]})},i(t){i||(ht(e.$$.fragment,t),i=!0)},o(t){mt(e.$$.fragment,t),i=!1},d(t){Ct(e,t),t&&T(n),t&&T(r),C(u,t),l=!1,c()}}}function Cn(t){let e;return{c(){e=L("Please wait, fetching chapters...")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function Dn(t){let e,n,r,o,s,i,l=t[11].from+"",c=t[11].url+"";return{c(){e=D("p"),n=L(l),r=L(": Found "),o=D("a"),s=L(c),M(o,"href",i=t[11].url),M(e,"class","valid small svelte-tsai6h")},m(t,i){S(t,e,i),x(e,n),x(e,r),x(e,o),x(o,s)},p(t,e){2&e&&l!==(l=t[11].from+"")&&j(n,l),2&e&&c!==(c=t[11].url+"")&&j(s,c),2&e&&i!==(i=t[11].url)&&M(o,"href",i)},d(t){t&&T(e)}}}function On(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Tn,then:Sn,catch:En,value:14,error:15,blocks:[,,,]};return bt(n=t[3],o),{c(){e=F(),o.block.c()},m(t,n){S(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,8&r&&n!==(n=t[3])&&bt(n,o)||$t(o,t,r)},i(t){r||(ht(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)mt(o.blocks[t]);r=!1},d(t){t&&T(e),o.block.d(t),o.token=null,o=null}}}function Ln(t,e,n){let r;a(t,Bt,(t=>n(9,r=t)));let o,{stage:s}=e,i=[];const l=async()=>{for(n(2,o=s.bookData.chapters.map((t=>Object.assign({},t))));;){let t=o[o.length-1];if(!1!==t.needsFetching){const e=await We(t.apiUrl),n=await e.json();if(!e.ok)throw n.message;o.splice(-1,1,t=cn(r,Je(n)))}const e=rn(r,t.content);if(!e)break;const s=Ee(e);if(o.find((t=>t.apiUrl===s)))break;i.push({from:t.title,url:e}),n(1,i);const l=await We(s),c=await l.json();if(!l.ok)throw c.message;o.push(cn(r,Je(c)))}return Object.assign(Object.assign({},s.bookData),{chapters:o})};let c=l(),u=!0;function d(){const t=document.documentElement.scrollHeight-document.documentElement.scrollTop;n(4,u=Math.abs(document.documentElement.clientHeight-t)<1)}return window.addEventListener("scroll",d),Y((()=>{window.removeEventListener("scroll",d)})),t.$$set=t=>{"stage"in t&&n(0,s=t.stage)},[s,i,o,c,u,l,(t,e)=>({update:({scroll:t})=>{t&&document.querySelector("footer").scrollIntoView()}}),()=>n(3,c=l()),()=>s.next({...s.bookData,chapters:o},i.length)]}const An=class extends Ot{constructor(t){super(),Dt(this,t,Ln,On,i,{stage:0})}};function Fn(t,e,n){t.dispatchEvent(new CustomEvent("finalize",{detail:{items:e,info:n}}))}function Nn(t,e,n){t.dispatchEvent(new CustomEvent("consider",{detail:{items:e,info:n}}))}const Rn="draggedEntered",_n="draggedLeft",Mn="draggedOverIndex",jn="draggedLeftDocument",Pn="leftForAnother",Un="outsideOfAny";function In(t,e,n){t.dispatchEvent(new CustomEvent(Rn,{detail:{indexObj:e,draggedEl:n}}))}function Hn(t,e,n){t.dispatchEvent(new CustomEvent(_n,{detail:{draggedEl:e,type:Pn,theOtherDz:n}}))}function zn(t,e,n){t.dispatchEvent(new CustomEvent(Mn,{detail:{indexObj:e,draggedEl:n}}))}const Bn="dragStarted",qn="droppedIntoZone",Wn="droppedIntoAnother",Gn="pointer",Xn="keyboard",Yn="data-is-dnd-shadow-item",Kn="id:dnd-shadow-placeholder-0000";let Vn="id",Zn=0;function Jn(){Zn++}function Qn(){if(0===Zn)throw new Error("Bug! trying to decrement when there are no dropzones");Zn--}const tr="undefined"==typeof window;let er;function nr(t){let e;const n=t.getBoundingClientRect(),r=getComputedStyle(t),o=r.transform;if(o){let s,i,l,c;if(o.startsWith("matrix3d("))e=o.slice(9,-1).split(/, /),s=+e[0],i=+e[5],l=+e[12],c=+e[13];else{if(!o.startsWith("matrix("))return n;e=o.slice(7,-1).split(/, /),s=+e[0],i=+e[3],l=+e[4],c=+e[5]}const a=r.transformOrigin,u=n.x-l-(1-s)*parseFloat(a),d=n.y-c-(1-i)*parseFloat(a.slice(a.indexOf(" ")+1)),p=s?n.width/s:t.offsetWidth,f=i?n.height/i:t.offsetHeight;return{x:u,y:d,width:p,height:f,top:d,right:u+p,bottom:d+f,left:u}}return n}function rr(t){const e=nr(t);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function or(t){const e=t.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function sr(t){return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}function ir(t,e){return t.y<=e.bottom&&t.y>=e.top&&t.x>=e.left&&t.x<=e.right}function lr(t){return sr(or(t))}function cr(t,e){return ir(lr(t),rr(e))}function ar(){er=new Map}function ur(t){er.delete(t)}function dr(t,e){if(!cr(t,e))return null;const n=e.children;if(0===n.length)return{index:0,isProximityBased:!0};const r=function(t){const e=Array.from(t.children).findIndex((t=>t.getAttribute(Yn)));if(e>=0)return er.has(t)||er.set(t,new Map),er.get(t).set(e,rr(t.children[e])),e}(e);for(let o=0;o<n.length;o++)if(cr(t,n[o])){const n=er.has(e)&&er.get(e).get(o);return n&&!ir(lr(t),n)?{index:r,isProximityBased:!1}:{index:o,isProximityBased:!1}}let o,s=Number.MAX_VALUE;for(let e=0;e<n.length;e++){const r=(i=t,l=n[e],c=void 0,a=void 0,c=lr(i),a=lr(l),Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)));r<s&&(s=r,o=e)}var i,l,c,a;return{index:o,isProximityBased:!0}}function pr(){let t;function e(){t={directionObj:void 0,stepPx:0}}function n(e){const{directionObj:r,stepPx:o}=t;r&&(e.scrollBy(r.x*o,r.y*o),window.requestAnimationFrame((()=>n(e))))}function r(t){return 25-t}return e(),{scrollIfNeeded:function(o,s){if(!s)return!1;const i=function(t,e){const n=or(e);return ir(t,n)?{top:t.y-n.top,bottom:n.bottom-t.y,left:t.x-n.left,right:Math.min(n.right,document.documentElement.clientWidth)-t.x}:null}(o,s);if(null===i)return e(),!1;const l=!!t.directionObj;let[c,a]=[!1,!1];return s.scrollHeight>s.clientHeight&&(i.bottom<25?(c=!0,t.directionObj={x:0,y:1},t.stepPx=r(i.bottom)):i.top<25&&(c=!0,t.directionObj={x:0,y:-1},t.stepPx=r(i.top)),!l&&c)||s.scrollWidth>s.clientWidth&&(i.right<25?(a=!0,t.directionObj={x:1,y:0},t.stepPx=r(i.right)):i.left<25&&(a=!0,t.directionObj={x:-1,y:0},t.stepPx=r(i.left)),!l&&a)?(n(s),!0):(e(),!1)},resetScrolling:e}}function fr(t){return JSON.stringify(t,null,2)}function hr(t){if(!t)throw new Error("cannot get depth of a falsy node");return mr(t,0)}function mr(t,e=0){return t.parentElement?mr(t.parentElement,e+1):e-1}ar();const{scrollIfNeeded:gr,resetScrolling:vr}=pr();let br,$r;function yr(t){const e=t.touches?t.touches[0]:t;$r={x:e.clientX,y:e.clientY}}const{scrollIfNeeded:wr,resetScrolling:xr}=pr();let kr;function Er(){$r&&wr($r,document.documentElement)&&ar(),kr=window.setTimeout(Er,300)}function Sr(t){return`${t} 0.2s ease`}function Tr(t,e,n,r,o){const s=e.getBoundingClientRect(),i=t.getBoundingClientRect(),l=s.width-i.width,c=s.height-i.height;if(l||c){const e={left:(n-i.left)/i.width,top:(r-i.top)/i.height};t.style.height=`${s.height}px`,t.style.width=`${s.width}px`,t.style.left=parseFloat(t.style.left)-e.left*l+"px",t.style.top=parseFloat(t.style.top)-e.top*c+"px"}Cr(e,t),o()}function Cr(t,e){const n=window.getComputedStyle(t);Array.from(n).filter((t=>t.startsWith("background")||t.startsWith("padding")||t.startsWith("font")||t.startsWith("text")||t.startsWith("align")||t.startsWith("justify")||t.startsWith("display")||t.startsWith("flex")||t.startsWith("border")||"opacity"===t||"color"===t||"list-style-type"===t)).forEach((t=>e.style.setProperty(t,n.getPropertyValue(t),n.getPropertyPriority(t))))}function Dr(t,e){t.draggable=!1,t.ondragstart=()=>!1,e?(t.style.userSelect="",t.style.WebkitUserSelect="",t.style.cursor=""):(t.style.userSelect="none",t.style.WebkitUserSelect="none",t.style.cursor="grab")}function Or(t){t.style.display="none",t.style.position="fixed",t.style.zIndex="-5"}function Lr(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const r=e(t);Object.keys(r).forEach((e=>{t.style[e]=r[e]})),n(t).forEach((e=>t.classList.add(e)))}))}function Ar(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const r=e(t);Object.keys(r).forEach((e=>{t.style[e]=""})),n(t).forEach((e=>t.classList.contains(e)&&t.classList.remove(e)))}))}const Fr={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let Nr,Rr,_r,Mr,jr,Pr,Ur,Ir,Hr,zr,Br,qr=!1,Wr=!1,Gr=!1,Xr=[];const Yr=new Map,Kr=new Map,Vr=new WeakMap;function Zr(t,e){Yr.get(e).delete(t),Qn(),0===Yr.get(e).size&&Yr.delete(e)}function Jr(){window.addEventListener("mousemove",yr),window.addEventListener("touchmove",yr),Er();const t=Yr.get(Mr);for(const e of t)e.addEventListener(Rn,to),e.addEventListener(_n,eo),e.addEventListener(Mn,no);window.addEventListener(jn,oo);const e=Math.max(100,...Array.from(t.keys()).map((t=>Kr.get(t).dropAnimationDurationMs)));!function(t,e,n=200){let r,o,s,i=!1;const l=Array.from(e).sort(((t,e)=>hr(e)-hr(t)));!function e(){const c=lr(t),a=gr(c,r);if(!a&&s&&Math.abs(s.x-c.x)<10&&Math.abs(s.y-c.y)<10)return void(br=window.setTimeout(e,n));if(function(t){const e=or(t);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}(t))return void function(t){window.dispatchEvent(new CustomEvent(jn,{detail:{draggedEl:t}}))}(t);s=c;let u=!1;for(const e of l){a&&ur(r);const n=dr(t,e);if(null===n)continue;const{index:s}=n;u=!0,e!==r?(r&&Hn(r,t,e),In(e,n,t),r=e):s!==o&&(zn(e,n,t),o=s);break}!u&&i&&r?(function(t,e){t.dispatchEvent(new CustomEvent(_n,{detail:{draggedEl:e,type:Un}}))}(r,t),r=void 0,o=void 0,i=!1):i=!0,br=window.setTimeout(e,n)}()}(Rr,t,1.07*e)}function Qr(t){return t.findIndex((t=>!!t.isDndShadowItem&&t.id!==Kn))}function to(t){let{items:e,dropFromOthersDisabled:n}=Kr.get(t.currentTarget);if(n&&t.currentTarget!==jr)return;if(Gr=!1,e=e.filter((t=>t.id!==Ur.id)),jr!==t.currentTarget){const t=Kr.get(jr).items.filter((t=>!t.isDndShadowItem));Nn(jr,t,{trigger:"dragEnteredAnother",id:_r.id,source:Gn})}else{const t=function(t){return t.findIndex((t=>t.id===Kn))}(e);-1!==t&&e.splice(t,1)}const{index:r,isProximityBased:o}=t.detail.indexObj,s=o&&r===t.currentTarget.children.length-1?r+1:r;Ir=t.currentTarget,e.splice(s,0,Ur),Nn(t.currentTarget,e,{trigger:"draggedEntered",id:_r.id,source:Gn})}function eo(t){if(!qr)return;const{items:e,dropFromOthersDisabled:n}=Kr.get(t.currentTarget);if(n&&t.currentTarget!==jr&&t.currentTarget!==Ir)return;const r=Qr(e),o=e.splice(r,1)[0];Ir=void 0;const{type:s,theOtherDz:i}=t.detail;if(s===Un||s===Pn&&i!==jr&&Kr.get(i).dropFromOthersDisabled){Gr=!0,Ir=jr;const t=Kr.get(jr).items;t.splice(Pr,0,o),Nn(jr,t,{trigger:"draggedLeftAll",id:_r.id,source:Gn})}Nn(t.currentTarget,e,{trigger:"draggedLeft",id:_r.id,source:Gn})}function no(t){const{items:e,dropFromOthersDisabled:n}=Kr.get(t.currentTarget);if(n&&t.currentTarget!==jr)return;Gr=!1;const{index:r}=t.detail.indexObj,o=Qr(e);e.splice(o,1),e.splice(r,0,Ur),Nn(t.currentTarget,e,{trigger:"draggedOverIndex",id:_r.id,source:Gn})}function ro(t){t.preventDefault();const e=t.touches?t.touches[0]:t;zr={x:e.clientX,y:e.clientY},Rr.style.transform=`translate3d(${zr.x-Hr.x}px, ${zr.y-Hr.y}px, 0)`}function oo(){Wr=!0,window.removeEventListener("mousemove",ro),window.removeEventListener("touchmove",ro),window.removeEventListener("mouseup",oo),window.removeEventListener("touchend",oo),function(){window.removeEventListener("mousemove",yr),window.removeEventListener("touchmove",yr),$r=void 0,window.clearTimeout(kr),xr();const t=Yr.get(Mr);for(const e of t)e.removeEventListener(Rn,to),e.removeEventListener(_n,eo),e.removeEventListener(Mn,no);window.removeEventListener(jn,oo),clearTimeout(br),vr(),ar()}(),function(t){t.style.cursor="grab"}(Rr),Ir||(Ir=jr);let{items:t,type:e}=Kr.get(Ir);Ar(Yr.get(e),(t=>Kr.get(t).dropTargetStyle),(t=>Kr.get(t).dropTargetClasses));let n=Qr(t);-1===n&&(n=Pr),t=t.map((t=>t.isDndShadowItem?_r:t)),function(t,e){const n=nr(Ir.children[t]),r=n.left-parseFloat(Rr.style.left),o=n.top-parseFloat(Rr.style.top),{dropAnimationDurationMs:s}=Kr.get(Ir),i=`transform ${s}ms ease`;Rr.style.transition=Rr.style.transition?Rr.style.transition+","+i:i,Rr.style.transform=`translate3d(${r}px, ${o}px, 0)`,window.setTimeout(e,s)}(n,(function(){var e;Br(),Fn(Ir,t,{trigger:Gr?"droppedOutsideOfAny":qn,id:_r.id,source:Gn}),Ir!==jr&&Fn(jr,Kr.get(jr).items,{trigger:Wn,id:_r.id,source:Gn}),(e=Ir.children[n]).style.visibility="",e.removeAttribute(Yn),Rr.remove(),Nr.remove(),Xr.length&&(Xr.forEach((({dz:t,destroy:e})=>{e(),t.remove()})),Xr=[]),Rr=void 0,Nr=void 0,_r=void 0,Mr=void 0,jr=void 0,Pr=void 0,Ur=void 0,Ir=void 0,Hr=void 0,zr=void 0,qr=!1,Wr=!1,Br=void 0,Gr=!1}))}const so={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},io={[so.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[so.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"};let lo;function co(){lo||(lo=document.createElement("div"),lo.id="dnd-action-aria-alert",lo.style.position="fixed",lo.style.bottom="0",lo.style.left="0",lo.style.zIndex="-5",lo.style.opacity="0",lo.style.height="0",lo.style.width="0",lo.setAttribute("role","alert"),document.body.prepend(lo),Object.entries(io).forEach((([t,e])=>document.body.prepend(function(t,e){const n=document.createElement("div");return n.id=t,n.innerHTML=`<p>${e}</p>`,n.style.display="none",n.style.position="fixed",n.style.zIndex="-5",n}(t,e)))))}function ao(t){if(tr)return;lo||co(),lo.innerHTML="";const e=document.createTextNode(t);lo.appendChild(e),lo.style.display="none",lo.style.display="inline"}const uo={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let po,fo,ho,mo,go=!1,vo="",bo="";const $o=new WeakSet,yo=new WeakMap,wo=new WeakMap,xo=new Map,ko=new Map,Eo=new Map;let So;function To(t,e){fo===t&&Ao(),Eo.get(e).delete(t),Qn(),0===Eo.get(e).size&&Eo.delete(e),0===Eo.size&&(window.removeEventListener("keydown",Co),window.removeEventListener("click",Do),So=void 0,!tr&&lo&&(Object.keys(io).forEach((t=>document.getElementById(t)?.remove())),lo.remove(),lo=void 0))}function Co(t){go&&"Escape"===t.key&&Ao()}function Do(){go&&($o.has(document.activeElement)||Ao())}function Oo(t){if(!go)return;const e=t.currentTarget;if(e===fo)return;vo=e.getAttribute("aria-label")||"";const{items:n}=ko.get(fo),r=n.find((t=>t.id===mo)),o=n.indexOf(r),s=n.splice(o,1)[0],{items:i,autoAriaDisabled:l}=ko.get(e);e.getBoundingClientRect().top<fo.getBoundingClientRect().top||e.getBoundingClientRect().left<fo.getBoundingClientRect().left?(i.push(s),l||ao(`Moved item ${bo} to the end of the list ${vo}`)):(i.unshift(s),l||ao(`Moved item ${bo} to the beginning of the list ${vo}`)),Fn(fo,n,{trigger:Wn,id:mo,source:Xn}),Fn(e,i,{trigger:qn,id:mo,source:Xn}),fo=e}function Lo(){xo.forEach((({update:t},e)=>t(ko.get(e))))}function Ao(t=!0){ko.get(fo).autoAriaDisabled||ao(`Stopped dragging item ${bo}`),$o.has(document.activeElement)&&document.activeElement.blur(),t&&Nn(fo,ko.get(fo).items,{trigger:"dragStopped",id:mo,source:Xn}),Ar(Eo.get(po),(t=>ko.get(t).dropTargetStyle),(t=>ko.get(t).dropTargetClasses)),ho=null,mo=null,bo="",po=null,fo=null,vo="",go=!1,Lo()}function Fo(t,e){const n={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:uo,dropTargetClasses:[],autoAriaDisabled:!1};function r(t,e,n){t.length<=1||t.splice(n,1,t.splice(e,1,t[n])[0])}function o(e){switch(e.key){case"Enter":case" ":if((void 0!==e.target.disabled||e.target.href||e.target.isContentEditable)&&!$o.has(e.target))return;e.preventDefault(),e.stopPropagation(),go?Ao():s(e);break;case"ArrowDown":case"ArrowRight":{if(!go)return;e.preventDefault(),e.stopPropagation();const{items:o}=ko.get(t),s=Array.from(t.children),i=s.indexOf(e.currentTarget);i<s.length-1&&(n.autoAriaDisabled||ao(`Moved item ${bo} to position ${i+2} in the list ${vo}`),r(o,i,i+1),Fn(t,o,{trigger:qn,id:mo,source:Xn}));break}case"ArrowUp":case"ArrowLeft":{if(!go)return;e.preventDefault(),e.stopPropagation();const{items:o}=ko.get(t),s=Array.from(t.children).indexOf(e.currentTarget);s>0&&(n.autoAriaDisabled||ao(`Moved item ${bo} to position ${s} in the list ${vo}`),r(o,s,s-1),Fn(t,o,{trigger:qn,id:mo,source:Xn}));break}}}function s(e){(function(e){const{items:n}=ko.get(t),r=Array.from(t.children),o=r.indexOf(e);ho=e,ho.tabIndex=0,mo=n[o].id,bo=r[o].getAttribute("aria-label")||""})(e.currentTarget),fo=t,po=n.type,go=!0;const r=Array.from(Eo.get(n.type)).filter((t=>t===fo||!ko.get(t).dropFromOthersDisabled));if(Lr(r,(t=>ko.get(t).dropTargetStyle),(t=>ko.get(t).dropTargetClasses)),!n.autoAriaDisabled){let t=`Started dragging item ${bo}. Use the arrow keys to move it within its list ${vo}`;r.length>1&&(t+=", or tab to another list in order to move the item into it"),ao(t)}Nn(t,ko.get(t).items,{trigger:Bn,id:mo,source:Xn}),Lo()}function i(t){go&&t.currentTarget!==ho&&(t.stopPropagation(),Ao(!1),s(t))}function l({items:e=[],type:r="--any--",dragDisabled:s=!1,zoneTabIndex:l=0,dropFromOthersDisabled:c=!1,dropTargetStyle:a=uo,dropTargetClasses:u=[],autoAriaDisabled:d=!1}){var p,f;n.items=[...e],n.dragDisabled=s,n.dropFromOthersDisabled=c,n.zoneTabIndex=l,n.dropTargetStyle=a,n.dropTargetClasses=u,n.autoAriaDisabled=d,n.type&&r!==n.type&&To(t,n.type),n.type=r,p=t,f=r,0===Eo.size&&(So=tr?null:("complete"===document.readyState?co():window.addEventListener("DOMContentLoaded",co),{...so}),window.addEventListener("keydown",Co),window.addEventListener("click",Do)),Eo.has(f)||Eo.set(f,new Set),Eo.get(f).has(p)||(Eo.get(f).add(p),Jn()),d||(t.setAttribute("aria-disabled",s),t.setAttribute("role","list"),t.setAttribute("aria-describedby",s?So.DND_ZONE_DRAG_DISABLED:So.DND_ZONE_ACTIVE)),ko.set(t,n),t.tabIndex=go?t===fo||ho.contains(t)||n.dropFromOthersDisabled||fo&&n.type!==ko.get(fo).type?-1:0:n.zoneTabIndex,t.addEventListener("focus",Oo);for(let e=0;e<t.children.length;e++){const r=t.children[e];$o.add(r),r.tabIndex=go?-1:0,d||r.setAttribute("role","listitem"),r.removeEventListener("keydown",yo.get(r)),r.removeEventListener("click",wo.get(r)),s||(r.addEventListener("keydown",o),yo.set(r,o),r.addEventListener("click",i),wo.set(r,i)),go&&n.items[e].id===mo&&(ho=r,ho.tabIndex=0,r.focus())}}l(e);const c={update:t=>{l(t)},destroy:()=>{To(t,n.type),ko.delete(t),xo.delete(t)}};return xo.set(t,c),c}function No(t,e){Ro(e);const n=function(t,e){let n=!1;const r={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:Fr,dropTargetClasses:[],transformDraggedElement:()=>{},centreDraggedOnCursor:!1};let o=new Map;function s(){window.removeEventListener("mousemove",l),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",i),window.removeEventListener("touchend",i)}function i(){s(),Nr=void 0,Hr=void 0,zr=void 0}function l(t){t.preventDefault();const e=t.touches?t.touches[0]:t;zr={x:e.clientX,y:e.clientY},(Math.abs(zr.x-Hr.x)>=3||Math.abs(zr.y-Hr.y)>=3)&&(s(),function(){qr=!0;const t=o.get(Nr);Pr=t,jr=Nr.parentElement;const e=jr.getRootNode(),n=e.body||e,{items:s,type:i,centreDraggedOnCursor:l}=r;_r={...s[t]},Mr=i,Ur={..._r,isDndShadowItem:!0};const c={...Ur,[Vn]:Kn};Rr=function(t,e){const n=t.getBoundingClientRect(),r=function(t){const e=t.cloneNode(!0),n=[],r="SELECT"===t.tagName,o=r?[t]:[...t.querySelectorAll("select")];for(const t of o)n.push(t.value);if(o.length<=0)return e;const s=r?[e]:[...e.querySelectorAll("select")];for(let t=0;t<s.length;t++){const e=s[t],r=n[t],o=e.querySelector(`option[value="${r}"`);o&&o.setAttribute("selected",!0)}return e}(t);Cr(t,r),r.id="dnd-action-dragged-el",r.style.position="fixed";let o=n.top,s=n.left;if(r.style.top=`${o}px`,r.style.left=`${s}px`,e){const t=sr(n);o-=t.y-e.y,s-=t.x-e.x,window.setTimeout((()=>{r.style.top=`${o}px`,r.style.left=`${s}px`}),0)}return r.style.margin="0",r.style.boxSizing="border-box",r.style.height=`${n.height}px`,r.style.width=`${n.width}px`,r.style.transition=`${Sr("top")}, ${Sr("left")}, ${Sr("background-color")}, ${Sr("opacity")}, ${Sr("color")} `,window.setTimeout((()=>r.style.transition+=`, ${Sr("width")}, ${Sr("height")}`),0),r.style.zIndex="9999",r.style.cursor="grabbing",r}(Nr,l&&zr),window.requestAnimationFrame((function t(){Rr.parentElement?window.requestAnimationFrame(t):(n.appendChild(Rr),Rr.focus(),Jr(),Or(Nr),n.appendChild(Nr))})),Lr(Array.from(Yr.get(r.type)).filter((t=>t===jr||!Kr.get(t).dropFromOthersDisabled)),(t=>Kr.get(t).dropTargetStyle),(t=>Kr.get(t).dropTargetClasses)),s.splice(t,1,c),Br=function(t){const e=t.style.minHeight;t.style.minHeight=window.getComputedStyle(t).getPropertyValue("height");const n=t.style.minWidth;return t.style.minWidth=window.getComputedStyle(t).getPropertyValue("width"),function(){t.style.minHeight=e,t.style.minWidth=n}}(jr),Nn(jr,s,{trigger:Bn,id:_r.id,source:Gn}),window.addEventListener("mousemove",ro,{passive:!1}),window.addEventListener("touchmove",ro,{passive:!1,capture:!1}),window.addEventListener("mouseup",oo,{passive:!1}),window.addEventListener("touchend",oo,{passive:!1})}())}function c(t){if(t.target!==t.currentTarget&&(void 0!==t.target.value||t.target.isContentEditable))return;if(t.button)return;if(qr)return;t.stopPropagation();const e=t.touches?t.touches[0]:t;Hr={x:e.clientX,y:e.clientY},zr={...Hr},Nr=t.currentTarget,window.addEventListener("mousemove",l,{passive:!1}),window.addEventListener("touchmove",l,{passive:!1,capture:!1}),window.addEventListener("mouseup",i,{passive:!1}),window.addEventListener("touchend",i,{passive:!1})}function a({items:e,flipDurationMs:s=0,type:i="--any--",dragDisabled:l=!1,morphDisabled:a=!1,dropFromOthersDisabled:u=!1,dropTargetStyle:d=Fr,dropTargetClasses:p=[],transformDraggedElement:f=(()=>{}),centreDraggedOnCursor:h=!1}){var m,g;function v(t,e){return Kr.get(t)?Kr.get(t)[e]:r[e]}r.dropAnimationDurationMs=s,r.type&&i!==r.type&&Zr(t,r.type),r.type=i,m=t,g=i,Yr.has(g)||Yr.set(g,new Set),Yr.get(g).has(m)||(Yr.get(g).add(m),Jn()),r.items=[...e],r.dragDisabled=l,r.morphDisabled=a,r.transformDraggedElement=f,r.centreDraggedOnCursor=h,!n||!qr||Wr||function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!{}.hasOwnProperty.call(e,n)||e[n]!==t[n])return!1;return!0}(d,r.dropTargetStyle)&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(p,r.dropTargetClasses)||(Ar([t],(()=>r.dropTargetStyle),(()=>p)),Lr([t],(()=>d),(()=>p))),r.dropTargetStyle=d,r.dropTargetClasses=[...p],n&&qr&&r.dropFromOthersDisabled!==u&&(u?Ar([t],(t=>v(t,"dropTargetStyle")),(t=>v(t,"dropTargetClasses"))):Lr([t],(t=>v(t,"dropTargetStyle")),(t=>v(t,"dropTargetClasses")))),r.dropFromOthersDisabled=u,Kr.set(t,r);const b=Qr(r.items);for(let e=0;e<t.children.length;e++){const s=t.children[e];Dr(s,l),e!==b?(s.removeEventListener("mousedown",Vr.get(s)),s.removeEventListener("touchstart",Vr.get(s)),l||(s.addEventListener("mousedown",c),s.addEventListener("touchstart",c),Vr.set(s,c)),o.set(s,e),n||(n=!0)):(a||Tr(Rr,s,zr.x,zr.y,(()=>r.transformDraggedElement(Rr,_r,e))),($=s).style.visibility="hidden",$.setAttribute(Yn,"true"))}var $}return a(e),{update:t=>{a(t)},destroy:()=>{function e(){Zr(t,Kr.get(t).type),Kr.delete(t)}var n,r;qr?(n=t,r=e,Xr.push({dz:n,destroy:r}),window.requestAnimationFrame((()=>{Or(n),document.body.appendChild(n)}))):e()}}}(t,e),r=Fo(t,e);return{update:t=>{Ro(t),n.update(t),r.update(t)},destroy:()=>{n.destroy(),r.destroy()}}}function Ro(t){const{items:e,flipDurationMs:n,type:r,dragDisabled:o,morphDisabled:s,dropFromOthersDisabled:i,zoneTabIndex:l,dropTargetStyle:c,dropTargetClasses:a,transformDraggedElement:u,autoAriaDisabled:d,centreDraggedOnCursor:p,...f}=t;if(Object.keys(f).length>0&&console.warn("dndzone will ignore unknown options",f),!e)throw new Error("no 'items' key provided to dndzone");const h=e.find((t=>!{}.hasOwnProperty.call(t,Vn)));if(h)throw new Error(`missing 'id' property for item ${fr(h)}`);if(a&&!Array.isArray(a))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof a}, ${fr(a)}`);if(l&&(m=l,isNaN(m)||(0|(g=parseFloat(m)))!==g))throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof l}, ${fr(l)}`);var m,g}function _o(t,{delay:n=0,duration:r=400,easing:o=e}={}){const s=+getComputedStyle(t).opacity;return{delay:n,duration:r,easing:o,css:t=>"opacity: "+t*s}}function Mo(t,{delay:e=0,duration:n=400,easing:r=ke,x:o=0,y:s=0,opacity:i=0}={}){const l=getComputedStyle(t),c=+l.opacity,a="none"===l.transform?"":l.transform,u=c*(1-i);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${a} translate(${(1-t)*o}px, ${(1-t)*s}px);\n\t\t\topacity: ${c-u*e}`}}const jo=["Activate","AddUndo","BeforeAddUndo","BeforeExecCommand","BeforeGetContent","BeforeRenderUI","BeforeSetContent","BeforePaste","Blur","Change","ClearUndos","Click","ContextMenu","Copy","Cut","Dblclick","Deactivate","Dirty","Drag","DragDrop","DragEnd","DragGesture","DragOver","Drop","ExecCommand","Focus","FocusIn","FocusOut","GetContent","Hide","Init","KeyDown","KeyPress","KeyUp","LoadContent","MouseDown","MouseEnter","MouseLeave","MouseMove","MouseOut","MouseOver","MouseUp","NodeChange","ObjectResizeStart","ObjectResized","ObjectSelected","Paste","PostProcess","PostRender","PreProcess","ProgressState","Redo","Remove","Reset","ResizeEditor","SaveContent","SelectionChange","SetAttrib","SetContent","Show","Submit","Undo","VisualAid"];function Po(t){let e;return{c(){var n,r;e=D("textarea"),M(e,"id",t[0]),n=e,r="visibility",null==="hidden"?n.style.removeProperty(r):n.style.setProperty(r,"hidden","")},m(n,r){S(n,e,r),t[18](e)},p(t,n){1&n&&M(e,"id",t[0])},d(n){n&&T(e),t[18](null)}}}function Uo(t){let e;return{c(){e=D("div"),M(e,"id",t[0])},m(n,r){S(n,e,r),t[17](e)},p(t,n){1&n&&M(e,"id",t[0])},d(n){n&&T(e),t[17](null)}}}function Io(e){let n;function r(t,e){return t[1]?Uo:Po}let o=r(e),s=o(e);return{c(){n=D("div"),s.c(),M(n,"class",e[2])},m(t,r){S(t,n,r),s.m(n,null),e[19](n)},p(t,[e]){o===(o=r(t))&&s?s.p(t,e):(s.d(1),s=o(t),s&&(s.c(),s.m(n,null))),4&e&&M(n,"class",t[2])},i:t,o:t,d(t){t&&T(n),s.d(),e[19](null)}}}const Ho=t=>t+"_"+Math.floor(1e9*Math.random())+String(Date.now());let zo=(()=>{let t={listeners:[],scriptId:Ho("tiny-script"),scriptLoaded:!1,injected:!1};return{load:(e,n,r)=>{t.scriptLoaded?r():(t.listeners.push(r),t.injected||((e,n,r,o)=>{t.injected=!0;const s=n.createElement("script");s.referrerPolicy="origin",s.type="application/javascript",s.src=r,s.onload=()=>{t.listeners.forEach((t=>t())),t.scriptLoaded=!0},n.head&&n.head.appendChild(s)})(t.scriptId,e,n))}}})();function Bo(t,e,n){var r;let o,s,i,{id:c=Ho("tinymce-svelte")}=e,{inline:a}=e,{disabled:u=!1}=e,{apiKey:d="no-api-key"}=e,{channel:p="6"}=e,{scriptSrc:f}=e,{conf:h={}}=e,{modelEvents:m="change input undo redo"}=e,{value:g=""}=e,{text:v=""}=e,{cssClass:b="tinymce-wrapper"}=e,$="",y=u;const w=function(){const t=G();return(e,n,{cancelable:r=!1}={})=>{const o=t.$$.callbacks[e];if(o){const s=I(e,n,{cancelable:r});return o.slice().forEach((e=>{e.call(t,s)})),!s.defaultPrevented}return!0}}(),x=()=>{const t="undefined"!=typeof window?window:l.g;return t&&t.tinymce?t.tinymce:null},k=()=>{const t=Object.assign(Object.assign({},h),{target:s,inline:void 0!==a?a:void 0!==h.inline&&h.inline,readonly:u,setup:t=>{n(14,i=t),t.on("init",(()=>{t.setContent(g),t.on(m,(()=>{n(15,$=t.getContent()),$!==g&&(n(5,g=$),n(6,v=t.getContent({format:"text"})))}))})),((t,e)=>{jo.forEach((n=>{t.on(n,(r=>{e(n.toLowerCase(),{eventName:n,event:r,editor:t})}))}))})(t,w),"function"==typeof h.setup&&h.setup(t)}});n(4,s.style.visibility="",s),x().init(t)};return X((()=>{if(null!==x())setTimeout(k,0);else{const t=f||`https://cdn.tiny.cloud/1/${d}/tinymce/${p}/tinymce.min.js`;zo.load(o.ownerDocument,t,(()=>{k()}))}})),Y((()=>{var t;i&&(null===(t=x())||void 0===t||t.remove(i))})),t.$$set=t=>{"id"in t&&n(0,c=t.id),"inline"in t&&n(1,a=t.inline),"disabled"in t&&n(7,u=t.disabled),"apiKey"in t&&n(8,d=t.apiKey),"channel"in t&&n(9,p=t.channel),"scriptSrc"in t&&n(10,f=t.scriptSrc),"conf"in t&&n(11,h=t.conf),"modelEvents"in t&&n(12,m=t.modelEvents),"value"in t&&n(5,g=t.value),"text"in t&&n(6,v=t.text),"cssClass"in t&&n(2,b=t.cssClass)},t.$$.update=()=>{123040&t.$$.dirty&&(i&&$!==g&&(i.setContent(g),n(6,v=i.getContent({format:"text"}))),i&&u!==y&&(n(16,y=u),"function"==typeof(null===n(13,r=i.mode)||void 0===r?void 0:r.set)?i.mode.set(u?"readonly":"design"):i.setMode(u?"readonly":"design")))},[c,a,b,o,s,g,v,u,d,p,f,h,m,r,i,$,y,function(t){Z[t?"unshift":"push"]((()=>{s=t,n(4,s)}))},function(t){Z[t?"unshift":"push"]((()=>{s=t,n(4,s)}))},function(t){Z[t?"unshift":"push"]((()=>{o=t,n(3,o)}))}]}const qo=class extends Ot{constructor(t){super(),Dt(this,t,Bo,Io,i,{id:0,inline:1,disabled:7,apiKey:8,channel:9,scriptSrc:10,conf:11,modelEvents:12,value:5,text:6,cssClass:2})}};function Wo(e){let n,r,o;return{c(){n=O("svg"),r=O("g"),o=O("path"),M(o,"d","M38,52a2,2,0,0,1-1.41-.59l-24-24a2,2,0,0,1,0-2.82l24-24a2,2,0,0,1,2.82,0,2,2,0,0,1,0,2.82L16.83,26,39.41,48.59A2,2,0,0,1,38,52Z"),M(n,"version","1.1"),M(n,"xmlns","http://www.w3.org/2000/svg"),M(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),M(n,"x","0px"),M(n,"y","0px"),M(n,"viewBox","0 0 52 52"),M(n,"xml:space","preserve")},m(t,e){S(t,n,e),x(n,r),x(r,o)},p:t,i:t,o:t,d(t){t&&T(n)}}}const Go=class extends Ot{constructor(t){super(),Dt(this,t,null,Wo,i,{})}};function Xo(e){let n,r;return{c(){n=O("svg"),r=O("polygon"),M(r,"points","0,490 490,490 245,0"),M(n,"version","1.1"),M(n,"xmlns","http://www.w3.org/2000/svg"),M(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),M(n,"x","0px"),M(n,"y","0px"),M(n,"viewBox","0 0 490 490"),M(n,"xml:space","preserve")},m(t,e){S(t,n,e),x(n,r)},p:t,i:t,o:t,d(t){t&&T(n)}}}const Yo=class extends Ot{constructor(t){super(),Dt(this,t,null,Xo,i,{})}};function Ko(t){let e,n,r,i,l,c,a,u,d,p,f,h,m;return r=new Yo({}),a=new Yo({}),{c(){e=D("div"),n=D("a"),St(r.$$.fragment),i=L(" move up"),l=A(),c=D("a"),St(a.$$.fragment),u=L(" move down"),d=A(),p=D("a"),p.textContent="remove",M(n,"href","#up"),M(n,"class","small up svelte-1ahjj8t"),U(n,"control-disabled",!t[0]),M(c,"href","#dowm"),M(c,"class","small down svelte-1ahjj8t"),U(c,"control-disabled",!t[1]),M(p,"href","#remove"),M(p,"class","small remove svelte-1ahjj8t"),M(e,"class","controls svelte-1ahjj8t")},m(o,g){S(o,e,g),x(e,n),Tt(r,n,null),x(n,i),x(e,l),x(e,c),Tt(a,c,null),x(c,u),x(e,d),x(e,p),f=!0,h||(m=[N(n,"click",_(R((function(){s(t[0])&&t[0].apply(this,arguments)})))),N(c,"click",_(R((function(){s(t[1])&&t[1].apply(this,arguments)})))),N(p,"click",_(R((function(){s(t[2])&&t[2].apply(this,arguments)}))))],h=!0)},p(e,[r]){t=e,1&r&&U(n,"control-disabled",!t[0]),2&r&&U(c,"control-disabled",!t[1])},i(t){f||(ht(r.$$.fragment,t),ht(a.$$.fragment,t),f=!0)},o(t){mt(r.$$.fragment,t),mt(a.$$.fragment,t),f=!1},d(t){t&&T(e),Ct(r),Ct(a),h=!1,o(m)}}}function Vo(t,e,n){let{moveUp:r}=e,{moveDown:o}=e,{remove:s}=e;return t.$$set=t=>{"moveUp"in t&&n(0,r=t.moveUp),"moveDown"in t&&n(1,o=t.moveDown),"remove"in t&&n(2,s=t.remove)},[r,o,s]}const Zo=class extends Ot{constructor(t){super(),Dt(this,t,Vo,Ko,i,{moveUp:0,moveDown:1,remove:2})}};function Jo(t){let e,n,r,s,i,l;return{c(){e=D("div"),n=D("span"),n.textContent="URL",r=A(),s=D("span"),M(n,"class","label svelte-13pfiuq"),M(s,"class","url svelte-13pfiuq"),M(s,"aria-label","URL"),M(s,"contenteditable",""),void 0===t[3]&&nt((()=>t[13].call(s))),M(e,"class","field svelte-13pfiuq")},m(o,c){S(o,e,c),x(e,n),x(e,r),x(e,s),void 0!==t[3]&&(s.innerHTML=t[3]),i||(l=[N(s,"input",t[13]),N(s,"keydown",t[10])],i=!0)},p(t,e){8&e&&t[3]!==s.innerHTML&&(s.innerHTML=t[3])},d(t){t&&T(e),i=!1,o(l)}}}function Qo(e){let n,r,o;return{c(){n=D("textarea"),n.disabled=e[2],M(n,"class","svelte-13pfiuq")},m(t,s){S(t,n,s),P(n,e[1]),r||(o=N(n,"input",e[15]),r=!0)},p(t,e){4&e&&(n.disabled=t[2]),2&e&&P(n,t[1])},i:t,o:t,d(t){t&&T(n),r=!1,o()}}}function ts(t){let e,n,r;function o(e){t[14](e)}let s={disabled:t[2],apiKey:"okcf1pz4foebbixgcdydveaavknj41e62etldhxguuyug0v3",conf:t[11]};return void 0!==t[1]&&(s.value=t[1]),e=new qo({props:s}),Z.push((()=>Et(e,"value",o))),{c(){St(e.$$.fragment)},m(t,n){Tt(e,t,n),r=!0},p(t,r){const o={};4&r&&(o.disabled=t[2]),!n&&2&r&&(n=!0,o.value=t[1],rt((()=>n=!1))),e.$set(o)},i(t){r||(ht(e.$$.fragment,t),r=!0)},o(t){mt(e.$$.fragment,t),r=!1},d(t){Ct(e,t)}}}function es(t){let e,n,r,o,s;return{c(){e=D("label"),n=D("input"),r=L(" Fetch contents"),M(n,"type","checkbox"),M(n,"class","svelte-13pfiuq"),M(e,"class","svelte-13pfiuq")},m(i,l){S(i,e,l),x(e,n),n.checked=t[2],x(e,r),o||(s=N(n,"change",t[16]),o=!0)},p(t,e){4&e&&(n.checked=t[2])},d(t){t&&T(e),o=!1,s()}}}function ns(t){let e,n,r,i,l,c,a,u,d,p,f,h,m,g,v,b,$,y,w,k,E,C;r=new Go({});let O=void 0!==t[3]&&Jo(t);const F=[ts,Qo],_=[];function j(t,e){return t[9].useTiny?0:1}m=j(t),g=_[m]=F[m](t);let P=t[4]&&es(t);return w=new Zo({props:{moveUp:t[6],moveDown:t[7],remove:t[8]}}),{c(){e=D("h3"),n=D("a"),St(r.$$.fragment),i=L(" back"),l=A(),c=D("div"),a=D("div"),u=D("span"),u.textContent="Title",d=A(),p=D("span"),f=A(),O&&O.c(),h=A(),g.c(),v=A(),P&&P.c(),b=A(),$=D("span"),y=A(),St(w.$$.fragment),M(n,"href","#home"),M(n,"class","homelink svelte-13pfiuq"),M(e,"class","back svelte-13pfiuq"),M(u,"class","label svelte-13pfiuq"),M(p,"class","title svelte-13pfiuq"),M(p,"aria-label","Title"),M(p,"contenteditable",""),void 0===t[0]&&nt((()=>t[12].call(p))),M(a,"class","field svelte-13pfiuq"),M(c,"class","chapter edit svelte-13pfiuq")},m(o,g){S(o,e,g),x(e,n),Tt(r,n,null),x(n,i),S(o,l,g),S(o,c,g),x(c,a),x(a,u),x(a,d),x(a,p),void 0!==t[0]&&(p.innerHTML=t[0]),x(c,f),O&&O.m(c,null),x(c,h),_[m].m(c,null),x(c,v),P&&P.m(c,null),S(o,b,g),S(o,$,g),S(o,y,g),Tt(w,o,g),k=!0,E||(C=[N(n,"click",R((function(){s(t[5])&&t[5].apply(this,arguments)}))),N(p,"input",t[12]),N(p,"keydown",t[10])],E=!0)},p(e,n){t=e,1&n&&t[0]!==p.innerHTML&&(p.innerHTML=t[0]),void 0!==t[3]?O?O.p(t,n):(O=Jo(t),O.c(),O.m(c,h)):O&&(O.d(1),O=null);let r=m;m=j(t),m===r?_[m].p(t,n):(pt(),mt(_[r],1,1,(()=>{_[r]=null})),ft(),g=_[m],g?g.p(t,n):(g=_[m]=F[m](t),g.c()),ht(g,1),g.m(c,v)),t[4]?P?P.p(t,n):(P=es(t),P.c(),P.m(c,null)):P&&(P.d(1),P=null);const o={};64&n&&(o.moveUp=t[6]),128&n&&(o.moveDown=t[7]),256&n&&(o.remove=t[8]),w.$set(o)},i(t){k||(ht(r.$$.fragment,t),ht(g),ht(w.$$.fragment,t),k=!0)},o(t){mt(r.$$.fragment,t),mt(g),mt(w.$$.fragment,t),k=!1},d(t){t&&T(e),Ct(r),t&&T(l),t&&T(c),O&&O.d(),_[m].d(),P&&P.d(),t&&T(b),t&&T($),t&&T(y),Ct(w,t),E=!1,o(C)}}}function rs(t){let e,n;return e=new Ft({props:{onSubmit:t[5],$$slots:{default:[ns]},$$scope:{ctx:t}}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,[n]){const r={};32&n&&(r.onSubmit=t[5]),132095&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function os(t,e,n){let r;a(t,Bt,(t=>n(9,r=t)));let{title:o}=e,{content:s}=e,{needsFetching:i}=e,{url:l}=e,{canFetch:c=!1}=e,{close:u}=e,{moveUp:d}=e,{moveDown:p}=e,{remove:f}=e;return i=null==i||i,s=null!=s?s:"",t.$$set=t=>{"title"in t&&n(0,o=t.title),"content"in t&&n(1,s=t.content),"needsFetching"in t&&n(2,i=t.needsFetching),"url"in t&&n(3,l=t.url),"canFetch"in t&&n(4,c=t.canFetch),"close"in t&&n(5,u=t.close),"moveUp"in t&&n(6,d=t.moveUp),"moveDown"in t&&n(7,p=t.moveDown),"remove"in t&&n(8,f=t.remove)},t.$$.update=()=>{1&t.$$.dirty&&n(0,o=o.replace(/<[^>]*>/g,""))},[o,s,i,l,c,u,d,p,f,r,t=>{"Enter"!==t.key&&13!==t.keyCode||t.preventDefault()},{plugins:"code",toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | code"},function(){o=this.innerHTML,n(0,o)},function(){l=this.innerHTML,n(3,l)},function(t){s=t,n(1,s)},function(){s=this.value,n(1,s)},function(){i=this.checked,n(2,i)}]}const ss=class extends Ot{constructor(t){super(),Dt(this,t,os,rs,i,{title:0,content:1,needsFetching:2,url:3,canFetch:4,close:5,moveUp:6,moveDown:7,remove:8})}};function is(t){let e,n;return{c(){e=D("span"),n=L(t[5]),M(e,"class","content svelte-1ltngm7")},m(t,r){S(t,e,r),x(e,n)},p(t,e){32&e&&j(n,t[5])},d(t){t&&T(e)}}}function ls(t){let e,n,r,i,l,c,a,u,d,p,f,h=!t[6]&&is(t);return u=new Zo({props:{moveUp:t[2],moveDown:t[3],remove:t[4]}}),{c(){e=D("div"),n=D("div"),r=D("span"),i=L(t[0]),l=A(),h&&h.c(),c=A(),a=D("div"),St(u.$$.fragment),M(r,"class","title svelte-1ltngm7"),M(r,"aria-label","Title"),M(n,"class","preview svelte-1ltngm7"),U(n,"empty",t[6]),M(a,"class","more svelte-1ltngm7"),M(e,"class","chapter svelte-1ltngm7"),M(e,"tabindex","0"),M(e,"title",t[0])},m(o,m){S(o,e,m),x(e,n),x(n,r),x(r,i),x(n,l),h&&h.m(n,null),x(e,c),x(e,a),Tt(u,a,null),d=!0,p||(f=[N(e,"click",(function(){s(t[1])&&t[1].apply(this,arguments)})),N(e,"contextmenu",R(t[8]))],p=!0)},p(r,[o]){t=r,(!d||1&o)&&j(i,t[0]),t[6]?h&&(h.d(1),h=null):h?h.p(t,o):(h=is(t),h.c(),h.m(n,null)),64&o&&U(n,"empty",t[6]);const s={};4&o&&(s.moveUp=t[2]),8&o&&(s.moveDown=t[3]),16&o&&(s.remove=t[4]),u.$set(s),(!d||1&o)&&M(e,"title",t[0])},i(t){d||(ht(u.$$.fragment,t),d=!0)},o(t){mt(u.$$.fragment,t),d=!1},d(t){t&&T(e),h&&h.d(),Ct(u),p=!1,o(f)}}}function cs(t,e,n){let r,{title:o}=e,{content:s}=e,{select:i}=e,{moveUp:l}=e,{moveDown:c}=e,{remove:a}=e;s=null!=s?s:"";let u="";return t.$$set=t=>{"title"in t&&n(0,o=t.title),"content"in t&&n(7,s=t.content),"select"in t&&n(1,i=t.select),"moveUp"in t&&n(2,l=t.moveUp),"moveDown"in t&&n(3,c=t.moveDown),"remove"in t&&n(4,a=t.remove)},t.$$.update=()=>{128&t.$$.dirty&&n(6,r=!s||!s.trim().length),128&t.$$.dirty&&setTimeout((()=>n(5,u=Te(s||""))),0)},[o,i,l,c,a,u,r,s,function(e){K.call(this,t,e)}]}const as=class extends Ot{constructor(t){super(),Dt(this,t,cs,ls,i,{title:0,content:7,select:1,moveUp:2,moveDown:3,remove:4})}};function us(t){let e,n,r;return{c(){e=D("span"),M(e,"class","edit svelte-1pemcjw"),M(e,"contenteditable",""),void 0===t[0]&&nt((()=>t[7].call(e)))},m(o,s){S(o,e,s),void 0!==t[0]&&(e.innerHTML=t[0]),n||(r=N(e,"input",t[7]),n=!0)},p(t,n){1&n&&t[0]!==e.innerHTML&&(e.innerHTML=t[0])},d(t){t&&T(e),n=!1,r()}}}function ds(t){let e,n,r,o=Te(t[0])+"";return{c(){e=D("a"),n=L(o),M(e,"href",r=Se(t[3])),M(e,"target","_blank")},m(t,r){S(t,e,r),x(e,n)},p(t,s){1&s&&o!==(o=Te(t[0])+"")&&j(n,o),8&s&&r!==(r=Se(t[3]))&&M(e,"href",r)},d(t){t&&T(e)}}}function ps(t){let e,n,r;return{c(){e=D("span"),M(e,"class","edit svelte-1pemcjw"),M(e,"contenteditable",""),void 0===t[1]&&nt((()=>t[8].call(e)))},m(o,s){S(o,e,s),void 0!==t[1]&&(e.innerHTML=t[1]),n||(r=N(e,"input",t[8]),n=!0)},p(t,n){2&n&&t[1]!==e.innerHTML&&(e.innerHTML=t[1])},d(t){t&&T(e),n=!1,r()}}}function fs(t){let e,n=Te(t[1])+"";return{c(){e=L(n)},m(t,n){S(t,e,n)},p(t,r){2&r&&n!==(n=Te(t[1])+"")&&j(e,n)},d(t){t&&T(e)}}}function hs(t){let e,n,r,o;const s=t[6].default,i=u(s,t,t[9],null);return{c(){e=D("h3"),e.textContent="Chapters",n=A(),r=D("div"),i&&i.c()},m(t,s){S(t,e,s),S(t,n,s),S(t,r,s),i&&i.m(r,null),o=!0},p(t,e){i&&i.p&&(!o||512&e)&&f(i,s,t,t[9],o?p(s,t[9],e,null):h(t[9]),null)},i(t){o||(ht(i,t),o=!0)},o(t){mt(i,t),o=!1},d(t){t&&T(e),t&&T(n),t&&T(r),i&&i.d(t)}}}function ms(t){let e,n,r,o,s,i,l,c,a,u;function d(t,e){return t[2]?us:ds}let p=d(t),f=p(t);function h(t,e){return t[2]?ps:fs}let m=h(t),g=m(t),v=t[5].default&&hs(t);return{c(){e=D("h3"),e.textContent="Title",n=A(),r=D("p"),f.c(),o=A(),s=D("h3"),s.textContent="Author",i=A(),l=D("p"),g.c(),c=A(),v&&v.c(),a=F()},m(t,d){S(t,e,d),S(t,n,d),S(t,r,d),f.m(r,null),S(t,o,d),S(t,s,d),S(t,i,d),S(t,l,d),g.m(l,null),S(t,c,d),v&&v.m(t,d),S(t,a,d),u=!0},p(t,e){p===(p=d(t))&&f?f.p(t,e):(f.d(1),f=p(t),f&&(f.c(),f.m(r,null))),m===(m=h(t))&&g?g.p(t,e):(g.d(1),g=m(t),g&&(g.c(),g.m(l,null))),t[5].default?v?(v.p(t,e),32&e&&ht(v,1)):(v=hs(t),v.c(),ht(v,1),v.m(a.parentNode,a)):v&&(pt(),mt(v,1,1,(()=>{v=null})),ft())},i(t){u||(ht(v),u=!0)},o(t){mt(v),u=!1},d(t){t&&T(e),t&&T(n),t&&T(r),f.d(),t&&T(o),t&&T(s),t&&T(i),t&&T(l),g.d(),t&&T(c),v&&v.d(t),t&&T(a)}}}function gs(t){let e,n;return e=new Ft({props:{onSubmit:t[4],$$slots:{default:[ms]},$$scope:{ctx:t}}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,[n]){const r={};16&n&&(r.onSubmit=t[4]),559&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function vs(t,e,n){let{$$slots:r={},$$scope:o}=e;const s=function(t){const e={};for(const n in t)e[n]=!0;return e}(r);let{edit:i=!1}=e,{title:l}=e,{author:c}=e,{url:a=""}=e,{onSubmit:u}=e;return t.$$set=t=>{"edit"in t&&n(2,i=t.edit),"title"in t&&n(0,l=t.title),"author"in t&&n(1,c=t.author),"url"in t&&n(3,a=t.url),"onSubmit"in t&&n(4,u=t.onSubmit),"$$scope"in t&&n(9,o=t.$$scope)},[l,c,i,a,u,s,r,function(){l=this.innerHTML,n(0,l)},function(){c=this.innerHTML,n(1,c)},o]}const bs=class extends Ot{constructor(t){super(),Dt(this,t,vs,gs,i,{edit:2,title:0,author:1,url:3,onSubmit:4})}};function $s(t,e,n){const r=t.slice();return r[34]=e[n],r}function ys(t,e,n){const r=t.slice();return r[37]=e[n],r[39]=n,r}function ws(t,e){let n,r,o;function s(){return e[17](e[39])}return r=new as({props:{title:e[37].title,content:e[37].content,select:s,moveUp:(e[2]>0||e[39]>0)&&e[12].bind(null,e[11](e[39])),moveDown:(e[2]<e[3]||e[39]<e[6].length-1)&&e[13].bind(null,e[11](e[39])),remove:e[14].bind(null,e[11](e[39]))}}),{key:t,first:null,c(){n=F(),St(r.$$.fragment),this.first=n},m(t,e){S(t,n,e),Tt(r,t,e),o=!0},p(t,n){e=t;const o={};64&n[0]&&(o.title=e[37].title),64&n[0]&&(o.content=e[37].content),80&n[0]&&(o.select=s),68&n[0]&&(o.moveUp=(e[2]>0||e[39]>0)&&e[12].bind(null,e[11](e[39]))),76&n[0]&&(o.moveDown=(e[2]<e[3]||e[39]<e[6].length-1)&&e[13].bind(null,e[11](e[39]))),64&n[0]&&(o.remove=e[14].bind(null,e[11](e[39]))),r.$set(o)},i(t){o||(ht(r.$$.fragment,t),o=!0)},o(t){mt(r.$$.fragment,t),o=!1},d(t){t&&T(n),Ct(r,t)}}}function xs(t){let e,n,r,o,i,l,c=t[5].pre+"";return{c(){e=D("a"),n=L(c),o=L("\n          ."),M(e,"class","small svelte-17sum1b"),M(e,"href",r=`#page ${t[5].pre}`),M(e,"role","navigation")},m(r,c){S(r,e,c),x(e,n),S(r,o,c),i||(l=N(e,"click",R((function(){s(t[15].bind(null,t[5].pre-1))&&t[15].bind(null,t[5].pre-1).apply(this,arguments)}))),i=!0)},p(o,s){t=o,32&s[0]&&c!==(c=t[5].pre+"")&&j(n,c),32&s[0]&&r!==(r=`#page ${t[5].pre}`)&&M(e,"href",r)},d(t){t&&T(e),t&&T(o),i=!1,l()}}}function ks(t){let e,n,r,o,i,l=t[34]+1+"";return{c(){e=D("a"),n=L(l),M(e,"class","small svelte-17sum1b"),M(e,"href",r=`#page ${t[34]+1}`),M(e,"role","navigation"),U(e,"current",t[34]==t[2])},m(r,l){S(r,e,l),x(e,n),o||(i=N(e,"click",R((function(){s(t[15].bind(null,t[34]))&&t[15].bind(null,t[34]).apply(this,arguments)}))),o=!0)},p(o,s){t=o,32&s[0]&&l!==(l=t[34]+1+"")&&j(n,l),32&s[0]&&r!==(r=`#page ${t[34]+1}`)&&M(e,"href",r),36&s[0]&&U(e,"current",t[34]==t[2])},d(t){t&&T(e),o=!1,i()}}}function Es(t){let e,n,r,o,i,l,c=t[5].post+"";return{c(){e=L(".\n          "),n=D("a"),r=L(c),M(n,"class","small svelte-17sum1b"),M(n,"href",o=`#page ${t[5].post}`),M(n,"role","navigation")},m(o,c){S(o,e,c),S(o,n,c),x(n,r),i||(l=N(n,"click",R((function(){s(t[15].bind(null,t[5].post-1))&&t[15].bind(null,t[5].post-1).apply(this,arguments)}))),i=!0)},p(e,s){t=e,32&s[0]&&c!==(c=t[5].post+"")&&j(r,c),32&s[0]&&o!==(o=`#page ${t[5].post}`)&&M(n,"href",o)},d(t){t&&T(e),t&&T(n),i=!1,l()}}}function Ss(t){let e,n,r,i,l,c,a,u,d,p,f,h,g,v,b,$,y,w=[],k=new Map,E=t[6];const O=t=>t[37].id;for(let e=0;e<E.length;e+=1){let n=ys(t,E,e),r=O(n);k.set(r,w[e]=ws(r,n))}let F=null!==t[5].pre&&xs(t),_=t[5].pages,j=[];for(let e=0;e<_.length;e+=1)j[e]=ks($s(t,_,e));let P=null!==t[5].post&&Es(t);return{c(){e=D("div");for(let t=0;t<w.length;t+=1)w[t].c();r=A(),i=D("nav"),l=D("a"),c=L("Previous"),u=L("\n        ::\n        "),F&&F.c(),d=A();for(let t=0;t<j.length;t+=1)j[t].c();p=A(),P&&P.c(),f=L("\n        ::\n        "),h=D("a"),g=L("Next"),M(e,"class","chapters svelte-17sum1b"),M(l,"class","small svelte-17sum1b"),M(l,"href","#prevous"),M(l,"role","navigation"),M(l,"disabled",a=t[2]<=0),M(h,"class","small svelte-17sum1b"),M(h,"href","#next"),M(h,"role","navigation"),M(h,"disabled",v=t[2]>=t[3]),M(i,"class","svelte-17sum1b")},m(o,a){S(o,e,a);for(let t=0;t<w.length;t+=1)w[t].m(e,null);S(o,r,a),S(o,i,a),x(i,l),x(l,c),x(i,u),F&&F.m(i,null),x(i,d);for(let t=0;t<j.length;t+=1)j[t].m(i,null);x(i,p),P&&P.m(i,null),x(i,f),x(i,h),x(h,g),b=!0,$||(y=[m(n=No.call(null,e,{items:t[6],flipDurationMs:Os})),N(e,"consider",t[16]),N(e,"finalize",t[16]),N(l,"click",R((function(){s(t[15].bind(null,t[2]-1))&&t[15].bind(null,t[2]-1).apply(this,arguments)}))),N(h,"click",R((function(){s(t[15].bind(null,t[2]+1))&&t[15].bind(null,t[2]+1).apply(this,arguments)})))],$=!0)},p(r,o){if(t=r,30812&o[0]&&(E=t[6],pt(),w=xt(w,o,O,1,t,E,k,e,wt,ws,null,ys),ft()),n&&s(n.update)&&64&o[0]&&n.update.call(null,{items:t[6],flipDurationMs:Os}),(!b||4&o[0]&&a!==(a=t[2]<=0))&&M(l,"disabled",a),null!==t[5].pre?F?F.p(t,o):(F=xs(t),F.c(),F.m(i,d)):F&&(F.d(1),F=null),32804&o[0]){let e;for(_=t[5].pages,e=0;e<_.length;e+=1){const n=$s(t,_,e);j[e]?j[e].p(n,o):(j[e]=ks(n),j[e].c(),j[e].m(i,p))}for(;e<j.length;e+=1)j[e].d(1);j.length=_.length}null!==t[5].post?P?P.p(t,o):(P=Es(t),P.c(),P.m(i,f)):P&&(P.d(1),P=null),(!b||12&o[0]&&v!==(v=t[2]>=t[3]))&&M(h,"disabled",v)},i(t){if(!b){for(let t=0;t<E.length;t+=1)ht(w[t]);b=!0}},o(t){for(let t=0;t<w.length;t+=1)mt(w[t]);b=!1},d(t){t&&T(e);for(let t=0;t<w.length;t+=1)w[t].d();t&&T(r),t&&T(i),F&&F.d(),C(j,t),P&&P.d(),$=!1,o(y)}}}function Ts(t){let e,n,r,s,i,l,c,a,u,d;function p(e){t[22](e)}function f(e){t[23](e)}function h(e){t[24](e)}function m(e){t[25](e)}let g={canFetch:!!t[7].apiUrl,close:t[21],moveUp:(t[2]>0||t[4]>0)&&t[12].bind(null,t[4]),moveDown:(t[2]<t[3]||t[4]<t[6].length-1)&&t[13].bind(null,t[4]),remove:t[14].bind(null,t[4])};return void 0!==t[7].title&&(g.title=t[7].title),void 0!==t[7].content&&(g.content=t[7].content),void 0!==t[7].needsFetching&&(g.needsFetching=t[7].needsFetching),void 0!==t[7].displayUrl&&(g.url=t[7].displayUrl),n=new ss({props:g}),Z.push((()=>Et(n,"title",p))),Z.push((()=>Et(n,"content",f))),Z.push((()=>Et(n,"needsFetching",h))),Z.push((()=>Et(n,"url",m))),{c(){e=D("div"),St(n.$$.fragment),M(e,"class","svelte-17sum1b"),U(e,"float",t[9])},m(r,o){S(r,e,o),Tt(n,e,null),a=!0,u||(d=[N(e,"introend",t[26]),N(e,"outrostart",t[27]),N(e,"outroend",t[28])],u=!0)},p(t,o){const c={};128&o[0]&&(c.canFetch=!!t[7].apiUrl),16&o[0]&&(c.close=t[21]),20&o[0]&&(c.moveUp=(t[2]>0||t[4]>0)&&t[12].bind(null,t[4])),92&o[0]&&(c.moveDown=(t[2]<t[3]||t[4]<t[6].length-1)&&t[13].bind(null,t[4])),16&o[0]&&(c.remove=t[14].bind(null,t[4])),!r&&128&o[0]&&(r=!0,c.title=t[7].title,rt((()=>r=!1))),!s&&128&o[0]&&(s=!0,c.content=t[7].content,rt((()=>s=!1))),!i&&128&o[0]&&(i=!0,c.needsFetching=t[7].needsFetching,rt((()=>i=!1))),!l&&128&o[0]&&(l=!0,c.url=t[7].displayUrl,rt((()=>l=!1))),n.$set(c),512&o[0]&&U(e,"float",t[9])},i(t){a||(ht(n.$$.fragment,t),t&&nt((()=>{c||(c=vt(e,Mo,{x:50,duration:200},!0)),c.run(1)})),a=!0)},o(t){mt(n.$$.fragment,t),t&&(c||(c=vt(e,Mo,{x:50,duration:200},!1)),c.run(0)),a=!1},d(t){t&&T(e),Ct(n),t&&c&&c.end(),u=!1,o(d)}}}function Cs(t){let e,n,r,s,i,l,c,a,u,d,p,f,h,m;function g(e){t[19](e)}function v(e){t[20](e)}let b={edit:!0,onSubmit:t[18],$$slots:{default:[Ss]},$$scope:{ctx:t}};void 0!==t[1].title&&(b.title=t[1].title),void 0!==t[1].author&&(b.author=t[1].author),s=new bs({props:b}),Z.push((()=>Et(s,"title",g))),Z.push((()=>Et(s,"author",v)));let $=t[4]>=0&&Ts(t);return{c(){e=L("You are editing:\n\n"),n=D("div"),r=D("div"),St(s.$$.fragment),c=A(),$&&$.c(),a=A(),u=D("button"),u.textContent="Save",d=A(),p=D("a"),p.textContent="Cancel",M(r,"class","svelte-17sum1b"),U(r,"hide",t[8]),M(n,"class","list svelte-17sum1b"),M(u,"type","submit"),M(p,"href","#cancel"),M(p,"class","small")},m(o,i){S(o,e,i),S(o,n,i),x(n,r),Tt(s,r,null),x(n,c),$&&$.m(n,null),S(o,a,i),S(o,u,i),S(o,d,i),S(o,p,i),f=!0,h||(m=[N(u,"click",t[29]),N(p,"click",R(t[30]))],h=!0)},p(t,e){const o={};3&e[0]&&(o.onSubmit=t[18]),124&e[0]|512&e[1]&&(o.$$scope={dirty:e,ctx:t}),!i&&2&e[0]&&(i=!0,o.title=t[1].title,rt((()=>i=!1))),!l&&2&e[0]&&(l=!0,o.author=t[1].author,rt((()=>l=!1))),s.$set(o),256&e[0]&&U(r,"hide",t[8]),t[4]>=0?$?($.p(t,e),16&e[0]&&ht($,1)):($=Ts(t),$.c(),ht($,1),$.m(n,null)):$&&(pt(),mt($,1,1,(()=>{$=null})),ft())},i(t){f||(ht(s.$$.fragment,t),ht($),f=!0)},o(t){mt(s.$$.fragment,t),mt($),f=!1},d(t){t&&T(e),t&&T(n),Ct(s),$&&$.d(),t&&T(a),t&&T(u),t&&T(d),t&&T(p),h=!1,o(m)}}}const Ds=50,Os=200;function Ls(t,e,n){let{stage:r}=e;const o=Ce(r.bookData),s=Ce(r.bookData);let i,l,c,a,u=0,d=-1;const p=t=>t+Ds*u;let f={pre:null,pages:[],post:null},h=!1,m=!0;return t.$$set=t=>{"stage"in t&&n(0,r=t.stage)},t.$$.update=()=>{2&t.$$.dirty[0]&&n(3,l=Math.ceil(s.chapters.length/Ds-1)),6&t.$$.dirty[0]&&n(6,c=s.chapters.slice(u*Ds,(u+1)*Ds)),18&t.$$.dirty[0]&&n(7,a=d>=0?s.chapters[d]:void 0),44&t.$$.dirty[0]&&(n(5,f.pages=((t,e)=>{const n=new Array(e-t+1);for(let r=t;r<=e;r++)n[r-t]=r;return n})(Math.max(0,u-3),Math.min(l,u+3)),f),n(5,f.pre=0!==f.pages[0]?1:null,f),n(5,f.post=f.pages[f.pages.length-1]!==l?l+1:null,f))},[r,s,u,l,d,f,c,a,h,m,o,p,t=>{t<1||(t===d&&n(4,--d),s.chapters.splice(t-1,2,s.chapters[t],s.chapters[t-1]),n(1,s))},t=>{t>=s.chapters.length||(t===d&&n(4,++d),s.chapters.splice(t,2,s.chapters[t+1],s.chapters[t]),n(1,s))},t=>{n(4,d=-1),s.chapters.splice(t,1),n(1,s)},t=>{if(u==t){const e=prompt("New page:",""+(u+1)),n=+e;null!==e&&!isNaN(n)&&n>0&&n<=l+1&&(t=n-1)}i=Math.sign(t-u),n(2,u=t)},t=>{(t=>{s.chapters.splice(u*Ds,Ds,...t.detail.items),n(1,s)})(t)},t=>n(4,d=p(t)),()=>r.next(s),function(e){t.$$.not_equal(s.title,e)&&(s.title=e,n(1,s))},function(e){t.$$.not_equal(s.author,e)&&(s.author=e,n(1,s))},()=>n(4,d=-1),function(e){t.$$.not_equal(a.title,e)&&(a.title=e,n(7,a),n(4,d),n(1,s))},function(e){t.$$.not_equal(a.content,e)&&(a.content=e,n(7,a),n(4,d),n(1,s))},function(e){t.$$.not_equal(a.needsFetching,e)&&(a.needsFetching=e,n(7,a),n(4,d),n(1,s))},function(e){t.$$.not_equal(a.displayUrl,e)&&(a.displayUrl=e,n(7,a),n(4,d),n(1,s))},()=>{n(8,h=!0),n(9,m=!1)},()=>{n(9,m=!0)},()=>{n(8,h=!1)},()=>r.next(s),()=>r.next(o)]}const As=class extends Ot{constructor(t){super(),Dt(this,t,Ls,Cs,i,{stage:0},null,[-1,-1])}};function Fs(t,e,n){const r=t.slice();return r[15]=e[n],r}function Ns(t){let e,n,r,o;return e=new $e({props:{error:t[18],retry:t[12]}}),r=new fe({props:{backToSearch:t[2]}}),{c(){St(e.$$.fragment),n=A(),St(r.$$.fragment)},m(t,s){Tt(e,t,s),S(t,n,s),Tt(r,t,s),o=!0},p(t,n){const o={};16&n&&(o.error=t[18]),16&n&&(o.retry=t[12]),e.$set(o);const s={};4&n&&(s.backToSearch=t[2]),r.$set(s)},i(t){o||(ht(e.$$.fragment,t),ht(r.$$.fragment,t),o=!0)},o(t){mt(e.$$.fragment,t),mt(r.$$.fragment,t),o=!1},d(t){Ct(e,t),t&&T(n),Ct(r,t)}}}function Rs(t){let e,n,r,o,s,i,l,c,a,u,d,p;function f(t,e){return 16&e&&(s=null),null==s&&(s=!!t[14].chapters.find(Gs)),s?zs:Hs}r=new bs({props:{title:t[14].title,author:t[14].author,url:t[1].url,$$slots:{default:[Is]},$$scope:{ctx:t}}});let h=f(t,-1),m=h(t);function g(){return t[11](t[14])}return a=new fe({props:{backToSearch:t[2]}}),{c(){e=L("Got the following series:\n\n  "),n=D("div"),St(r.$$.fragment),o=A(),m.c(),i=A(),l=D("button"),l.textContent="Edit book",c=A(),St(a.$$.fragment),M(n,"class","list svelte-1hsynpq")},m(t,s){S(t,e,s),S(t,n,s),Tt(r,n,null),S(t,o,s),m.m(t,s),S(t,i,s),S(t,l,s),S(t,c,s),Tt(a,t,s),u=!0,d||(p=N(l,"click",g),d=!0)},p(e,n){t=e;const o={};16&n&&(o.title=t[14].title),16&n&&(o.author=t[14].author),2&n&&(o.url=t[1].url),524313&n&&(o.$$scope={dirty:n,ctx:t}),r.$set(o),h===(h=f(t,n))&&m?m.p(t,n):(m.d(1),m=h(t),m&&(m.c(),m.m(i.parentNode,i)));const s={};4&n&&(s.backToSearch=t[2]),a.$set(s)},i(t){u||(ht(r.$$.fragment,t),ht(a.$$.fragment,t),u=!0)},o(t){mt(r.$$.fragment,t),mt(a.$$.fragment,t),u=!1},d(t){t&&T(e),t&&T(n),Ct(r),t&&T(o),m.d(t),t&&T(i),t&&T(l),t&&T(c),Ct(a,t),d=!1,p()}}}function _s(t){let e;return{c(){e=L("hide")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function Ms(t){let e;return{c(){e=L("show")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function js(t){let e,n,r,o,s,i,l=t[0].newChapters+"";return{c(){e=D("span"),n=L("Found "),r=L(l),o=L(" new")},m(l,c){S(l,e,c),x(e,n),x(e,r),x(e,o),s||(i=N(e,"click",t[8]),s=!0)},p(t,e){1&e&&l!==(l=t[0].newChapters+"")&&j(r,l)},d(t){t&&T(e),s=!1,i()}}}function Ps(t){let e,n,r,o=[],s=new Map,i=t[14].chapters;const l=t=>t[15].id;for(let e=0;e<i.length;e+=1){let n=Fs(t,i,e),r=l(n);s.set(r,o[e]=Us(r,n))}return{c(){e=D("div");for(let t=0;t<o.length;t+=1)o[t].c();M(e,"class","chapter-list svelte-1hsynpq")},m(t,n){S(t,e,n);for(let t=0;t<o.length;t+=1)o[t].m(e,null);r=!0},p(t,n){16&n&&(i=t[14].chapters,o=xt(o,n,l,1,t,i,s,e,yt,Us,null,Fs))},i(t){r||(nt((()=>{n||(n=vt(e,Oe,{},!0)),n.run(1)})),r=!0)},o(t){n||(n=vt(e,Oe,{},!1)),n.run(0),r=!1},d(t){t&&T(e);for(let t=0;t<o.length;t+=1)o[t].d();t&&n&&n.end()}}}function Us(t,e){let n,r,o,s=Te(e[15].title)+"";return{key:t,first:null,c(){n=D("a"),r=L(s),M(n,"href",o=e[15].displayUrl),M(n,"target","_blank"),M(n,"class","small"),this.first=n},m(t,e){S(t,n,e),x(n,r)},p(t,i){e=t,16&i&&s!==(s=Te(e[15].title)+"")&&j(r,s),16&i&&o!==(o=e[15].displayUrl)&&M(n,"href",o)},d(t){t&&T(n)}}}function Is(t){let e,n,r,s,i,l,c,a,u,d,p,f,h,m,g,v=t[14].chapters.length+"";function b(t,e){return t[3]?_s:Ms}let $=b(t),y=$(t);function w(){return t[7](t[14])}let k="number"==typeof t[0].newChapters&&js(t),E=t[3]&&Ps(t);return{c(){e=D("p"),n=L("Found "),r=L(v),s=A(),i=D("a"),y.c(),l=A(),c=D("span"),a=A(),u=D("button"),u.textContent="Find more",d=A(),k&&k.c(),p=A(),E&&E.c(),f=F(),M(i,"href","#show"),M(i,"class","small"),M(c,"class","spacer svelte-1hsynpq"),M(e,"class","no-margin svelte-1hsynpq")},m(o,v){S(o,e,v),x(e,n),x(e,r),x(e,s),x(e,i),y.m(i,null),x(e,l),x(e,c),x(e,a),x(e,u),x(e,d),k&&k.m(e,null),S(o,p,v),E&&E.m(o,v),S(o,f,v),h=!0,m||(g=[N(i,"click",R(t[6])),N(u,"click",w)],m=!0)},p(n,o){t=n,(!h||16&o)&&v!==(v=t[14].chapters.length+"")&&j(r,v),$!==($=b(t))&&(y.d(1),y=$(t),y&&(y.c(),y.m(i,null))),"number"==typeof t[0].newChapters?k?k.p(t,o):(k=js(t),k.c(),k.m(e,null)):k&&(k.d(1),k=null),t[3]?E?(E.p(t,o),8&o&&ht(E,1)):(E=Ps(t),E.c(),ht(E,1),E.m(f.parentNode,f)):E&&(pt(),mt(E,1,1,(()=>{E=null})),ft())},i(t){h||(ht(E),h=!0)},o(t){mt(E),h=!1},d(t){t&&T(e),y.d(),k&&k.d(),t&&T(p),E&&E.d(t),t&&T(f),m=!1,o(g)}}}function Hs(t){let e,n,r;function o(){return t[10](t[14])}return{c(){e=D("button"),e.textContent="Generate EPUB"},m(t,s){S(t,e,s),n||(r=N(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&T(e),n=!1,r()}}}function zs(t){let e,n,r;function o(){return t[9](t[14])}return{c(){e=D("button"),e.textContent="Fetch chapter contents"},m(t,s){S(t,e,s),n||(r=N(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&T(e),n=!1,r()}}}function Bs(t){let e,n;return e=new xe({props:{$$slots:{default:[qs]},$$scope:{ctx:t}}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};524288&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function qs(t){let e;return{c(){e=L("Please wait, fetching data...")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function Ws(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:Bs,then:Rs,catch:Ns,value:14,error:18,blocks:[,,,]};return bt(n=t[4],o),{c(){e=F(),o.block.c()},m(t,n){S(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,16&r&&n!==(n=t[4])&&bt(n,o)||$t(o,t,r)},i(t){r||(ht(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)mt(o.blocks[t]);r=!1},d(t){t&&T(e),o.block.d(t),o.token=null,o=null}}}const Gs=t=>!1!==t.needsFetching;function Xs(t,e,n){let r;a(t,Bt,(t=>n(13,r=t)));let{stage:o}=e,{series:s}=e,{backToSearch:i}=e,l=!1;const c=()=>o.bookData?Promise.resolve(Ce(o.bookData)):(async t=>{var e;const n=await We(t.url),r=await n.json();if(!n.ok)throw r.message;const o=((t,e)=>{switch(t){case Qe.HFY_SERIES:return(({data:{content_md:t,content_html:e}})=>{var n,r,o;const s=(new DOMParser).parseFromString(Te(e),"text/html").querySelectorAll("a[href]");return{author:null===(n=t.match(/\[\*\*(?:Author\s*[-:]\s*)?([^*\]]+)\*\*\]|A Story By \[(?:\*\*)?([^\]]+?)(?:\*\*)?\]/i).slice(1).find(Boolean))||void 0===n?void 0:n.trim(),title:null===(o=null===(r=t.match(/##?\s*\*\*(.+)\*\*/))||void 0===r?void 0:r[1])||void 0===o?void 0:o.trim(),chapters:Array.from(s).filter((t=>t.getAttribute("href").match(Xe))).map((t=>{const e=t.getAttribute("href").startsWith("http")?t.getAttribute("href"):`https://www.reddit.com${t.getAttribute("href")}`;return{id:Ge(),title:t.textContent.trim(),apiUrl:Ee(e),displayUrl:e}}))}})(e);case Qe.POST:return(t=>({author:t[0].data.children[0].data.author,title:t[0].data.children[0].data.title,chapters:[Je(t)]}))(e)}throw new Error(`Getting data from source type \`${Qe[t]}\` not supported, this should never happen`)})(t.type,r);if(!(null===(e=null==o?void 0:o.chapters)||void 0===e?void 0:e.length))throw new Error("No chapters found");return o})(s).then((t=>n(0,o.bookData=Object.assign(Object.assign({},t),{chapters:an(r,t.chapters)}),o)));let u=c();return t.$$set=t=>{"stage"in t&&n(0,o=t.stage),"series"in t&&n(1,s=t.series),"backToSearch"in t&&n(2,i=t.backToSearch)},[o,s,i,l,u,c,()=>n(3,l=!l),t=>o.findMore(t),()=>n(0,o.newChapters=void 0,o),t=>o.downloadAll(t),t=>o.next(t),t=>o.edit(t),()=>n(4,u=c())]}const Ys=class extends Ot{constructor(t){super(),Dt(this,t,Xs,Ws,i,{stage:0,series:1,backToSearch:2})}};function Ks(t,e,n){const r=t.slice();return r[7]=e[n],r}function Vs(t){let e,n;return e=new $e({props:{error:t[10],retry:t[5]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[10]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function Zs(e){let n,r,o,s,i,l,c,a,u=e[6],d=[];for(let t=0;t<u.length;t+=1)d[t]=Qs(Ks(e,u,t));return{c(){n=D("p"),r=L("The search for '"),o=L(e[1]),s=L("' returned these results:"),i=A(),l=D("ul");for(let t=0;t<d.length;t+=1)d[t].c();c=A(),a=D("p"),a.textContent="Please select one.",M(a,"class","small")},m(t,e){S(t,n,e),x(n,r),x(n,o),x(n,s),S(t,i,e),S(t,l,e);for(let t=0;t<d.length;t+=1)d[t].m(l,null);S(t,c,e),S(t,a,e)},p(t,e){if(2&e&&j(o,t[1]),5&e){let n;for(u=t[6],n=0;n<u.length;n+=1){const r=Ks(t,u,n);d[n]?d[n].p(r,e):(d[n]=Qs(r),d[n].c(),d[n].m(l,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=u.length}},i:t,o:t,d(t){t&&T(n),t&&T(i),t&&T(l),C(d,t),t&&T(c),t&&T(a)}}}function Js(t){let e,n,r,o,s=t[7].author+"";return{c(){e=L("["),n=D("i"),r=L(s),o=L("]")},m(t,s){S(t,e,s),S(t,n,s),x(n,r),S(t,o,s)},p(t,e){4&e&&s!==(s=t[7].author+"")&&j(r,s)},d(t){t&&T(e),t&&T(n),t&&T(o)}}}function Qs(t){let e,n,r,o,s,i,l,c,a=t[7].title+"";function u(){return t[4](t[7])}let d=t[7].author&&Js(t);return{c(){e=D("li"),n=D("a"),r=L(a),s=A(),d&&d.c(),i=A(),M(n,"href",o=Se(t[7].url))},m(t,o){S(t,e,o),x(e,n),x(n,r),x(e,s),d&&d.m(e,null),x(e,i),l||(c=N(n,"click",R(u)),l=!0)},p(s,l){t=s,4&l&&a!==(a=t[7].title+"")&&j(r,a),4&l&&o!==(o=Se(t[7].url))&&M(n,"href",o),t[7].author?d?d.p(t,l):(d=Js(t),d.c(),d.m(e,i)):d&&(d.d(1),d=null)},d(t){t&&T(e),d&&d.d(),l=!1,c()}}}function ti(t){let e,n;return e=new xe({props:{$$slots:{default:[ei]},$$scope:{ctx:t}}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};2048&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function ei(t){let e;return{c(){e=L("Please wait, fetching results...")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function ni(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:ti,then:Zs,catch:Vs,value:6,error:10,blocks:[,,,]};return bt(n=t[2],o),{c(){e=F(),o.block.c()},m(t,n){S(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&bt(n,o)||$t(o,t,r)},i(t){r||(ht(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)mt(o.blocks[t]);r=!1},d(t){t&&T(e),o.block.d(t),o.token=null,o=null}}}function ri(t,e,n){let{stage:r}=e,{search:o}=e;const s=()=>Ve(o).then((t=>{if(!t.length)throw new Error(`No series matched input \`${o}\``);return t}));let i=s();return t.$$set=t=>{"stage"in t&&n(0,r=t.stage),"search"in t&&n(1,o=t.search)},[r,o,i,s,t=>r.next({url:t.url,type:Qe.HFY_SERIES}),()=>n(2,i=s())]}const oi=class extends Ot{constructor(t){super(),Dt(this,t,ri,ni,i,{stage:0,search:1})}};function si(t,e,n){const r=t.slice();return r[4]=e[n],r}function ii(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:ui,then:ci,catch:li,value:12};return bt(n=t[6](t[4],t[0]),r),{c(){e=F(),r.block.c()},m(t,n){S(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e},p(e,o){t=e,r.ctx=t,17&o&&n!==(n=t[6](t[4],t[0]))&&bt(n,r)||$t(r,t,o)},d(t){t&&T(e),r.block.d(t),r.token=null,r=null}}}function li(e){return{c:t,m:t,p:t,d:t}}function ci(t){let e,n=t[12],r=[];for(let e=0;e<n.length;e+=1)r[e]=ai(si(t,n,e));return{c(){e=D("div");for(let t=0;t<r.length;t+=1)r[t].c();M(e,"class","search-results svelte-f6azd4")},m(t,n){S(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(83&o){let s;for(n=t[12],s=0;s<n.length;s+=1){const i=si(t,n,s);r[s]?r[s].p(i,o):(r[s]=ai(i),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(t){t&&T(e),C(r,t)}}}function ai(t){let e,n,r,o,s,i=t[4].title+"";function l(){return t[9](t[4])}return{c(){e=D("a"),n=L(i),M(e,"class","result svelte-f6azd4"),M(e,"href",r=Se(t[4].url))},m(t,r){S(t,e,r),x(e,n),o||(s=N(e,"click",R(l)),o=!0)},p(o,s){t=o,17&s&&i!==(i=t[4].title+"")&&j(n,i),17&s&&r!==(r=Se(t[4].url))&&M(e,"href",r)},d(t){t&&T(e),o=!1,s()}}}function ui(e){return{c:t,m:t,p:t,d:t}}function di(t){let e;return{c(){e=D("p"),e.textContent="Please enter a search string",M(e,"class","small error svelte-f6azd4")},m(t,n){S(t,e,n)},d(t){t&&T(e)}}}function pi(t){let e,n,r;return{c(){e=D("div"),M(e,"class","overlay svelte-f6azd4")},m(t,n){S(t,e,n),r=!0},i(t){r||(nt((()=>{n||(n=vt(e,_o,{duration:100},!0)),n.run(1)})),r=!0)},o(t){n||(n=vt(e,_o,{duration:100},!1)),n.run(0),r=!1},d(t){t&&T(e),t&&n&&n.end()}}}function fi(t){let e,n,r,s,i,l,c,a,u,d,p,f,h,m,g,v,b,$,y=void 0!==t[0]&&!t[0].trim().length,w=t[2]&&ii(t),k=y&&di(),E=t[2]&&pi();return{c(){e=D("form"),n=D("p"),r=L("Search:\n    "),s=D("input"),i=A(),l=D("input"),a=A(),w&&w.c(),u=A(),k&&k.c(),d=A(),p=D("div"),E&&E.c(),f=A(),h=D("p"),h.textContent="You can:",m=A(),g=D("ul"),g.innerHTML='<li>Search for a series title on the <a href="https://reddit.com/r/HFY/wiki/series" target="_blank">r/HFY wiki</a></li> \n    <li>Enter a series link to the <a href="https://reddit.com/r/HFY" target="_blank">r/HFY</a> wiki</li> \n    <li>Enter a link to any reddit post</li>',M(s,"class","search svelte-f6azd4"),M(s,"placeholder","Search or URL..."),M(l,"type","submit"),l.value="Go",M(l,"class","submit svelte-f6azd4"),l.disabled=c=void 0===t[0]||!t[0].trim().length,M(n,"class","svelte-f6azd4"),M(e,"class","form svelte-f6azd4"),M(h,"class","spaceabove svelte-f6azd4"),M(p,"class","overlay-wrapper svelte-f6azd4")},m(o,c){S(o,e,c),x(e,n),x(n,r),x(n,s),P(s,t[0]),x(n,i),x(n,l),x(e,a),w&&w.m(e,null),t[11](e),S(o,u,c),k&&k.m(o,c),S(o,d,c),S(o,p,c),E&&E.m(p,null),x(p,f),x(p,h),x(p,m),x(p,g),v=!0,b||($=[N(s,"input",t[8]),N(s,"keyup",t[7]),N(s,"blur",t[5]),N(s,"click",t[7]),N(e,"submit",R(t[10]))],b=!0)},p(t,[n]){1&n&&s.value!==t[0]&&P(s,t[0]),(!v||1&n&&c!==(c=void 0===t[0]||!t[0].trim().length))&&(l.disabled=c),t[2]?w?w.p(t,n):(w=ii(t),w.c(),w.m(e,null)):w&&(w.d(1),w=null),1&n&&(y=void 0!==t[0]&&!t[0].trim().length),y?k||(k=di(),k.c(),k.m(d.parentNode,d)):k&&(k.d(1),k=null),t[2]?E?4&n&&ht(E,1):(E=pi(),E.c(),ht(E,1),E.m(p,f)):E&&(pt(),mt(E,1,1,(()=>{E=null})),ft())},i(t){v||(ht(E),v=!0)},o(t){mt(E),v=!1},d(n){n&&T(e),w&&w.d(),t[11](null),n&&T(u),k&&k.d(n),n&&T(d),n&&T(p),E&&E.d(),b=!1,o($)}}}function hi(t,e,n){let r,o,{stage:s}=e,{search:i}=e,l=!1;const c=()=>{n(4,r=r||Ve().finally(c)),n(2,l=!!r&&!!i)};return t.$$set=t=>{"stage"in t&&n(1,s=t.stage),"search"in t&&n(0,i=t.search)},[i,s,l,o,r,t=>n(2,l=!!o&&o.contains(t.relatedTarget)),async(t,e)=>{if(!t)return[];const r=await t,o=e.toLowerCase(),s=r.filter((t=>-1!==t.title.toLowerCase().indexOf(o)));return s.length||n(2,l=!1),s},c,function(){i=this.value,n(0,i)},t=>s.next(t.url),()=>s.next(i||""),function(t){Z[t?"unshift":"push"]((()=>{o=t,n(3,o)}))}]}const mi=class extends Ot{constructor(t){super(),Dt(this,t,hi,fi,i,{stage:1,search:0})}};var gi;!function(t){t[t.INPUT=0]="INPUT",t[t.SEARCH=1]="SEARCH",t[t.BOOK_DATA=2]="BOOK_DATA",t[t.EDIT_DATA=3]="EDIT_DATA",t[t.FIND_CHAPTERS=4]="FIND_CHAPTERS",t[t.DOWNLOAD_CHAPTERS=5]="DOWNLOAD_CHAPTERS",t[t.RESULT=6]="RESULT",t[t.SETTINGS=7]="SETTINGS",t[t._404=8]="_404"}(gi||(gi={}));const vi=t=>t===gi.INPUT?l.p:`${l.p}${gi[t].toLowerCase().replace(/_/g,"-")}`;class bi{dump(){return[]}}class $i extends bi{constructor(){super(...arguments),this.stage=gi.INPUT}next(t){const e=(t=>{try{if(new URL(t),(t=>!!t.match(Ke))(t))return Qe.HFY_SERIES;if((t=>!!t.match(Ze))(t))return Qe.POST}catch(t){}return Qe.SEARCH})(t);return Fi.update((n=>Object.assign(Object.assign({},n),{search:t,series:e!==Qe.SEARCH?{url:Ee(t),type:e}:n.series}))),e===Qe.SEARCH?Di(yi):Di(wi)}}class yi extends bi{constructor(){super(...arguments),this.stage=gi.SEARCH}next(t){return Fi.update((e=>Object.assign(Object.assign({},e),{series:t}))),Di(wi)}}class wi extends bi{constructor(t,e){super(),this.bookData=t,this.newChapters=e,this.stage=gi.BOOK_DATA}next(t){return Di(Si,t)}edit(t){return Di(xi,t)}findMore(t){return Di(ki,t)}downloadAll(t){return Di(Ei,t)}dump(){return[this.bookData,this.newChapters]}}class xi extends bi{constructor(t){if(super(),this.bookData=t,this.stage=gi.EDIT_DATA,this.needsSaving=!0,!t)throw new Error("bookData must be defined")}next(t){return Di(wi,t)}dump(){return[this.bookData]}}class ki extends bi{constructor(t){if(super(),this.bookData=t,this.stage=gi.FIND_CHAPTERS,this.needsSaving=!0,!t)throw new Error("bookData must be defined")}next(t,e){return Di(wi,t,e)}dump(){return[this.bookData]}}class Ei extends bi{constructor(t){if(super(),this.bookData=t,this.stage=gi.DOWNLOAD_CHAPTERS,this.needsSaving=!0,!t)throw new Error("bookData must be defined")}next(t){return Di(wi,t)}dump(){return[this.bookData]}}class Si extends bi{constructor(t){if(super(),this.bookData=t,this.stage=gi.RESULT,!t)throw new Error("bookData must be defined")}next(){return Di(wi,this.bookData)}dump(){return[this.bookData]}}class Ti extends bi{constructor(){super(...arguments),this.stage=gi.SETTINGS}next(){return Li()}}const Ci={[gi.INPUT]:$i,[gi.SEARCH]:yi,[gi.BOOK_DATA]:wi,[gi.EDIT_DATA]:xi,[gi.FIND_CHAPTERS]:ki,[gi.DOWNLOAD_CHAPTERS]:Ei,[gi.RESULT]:Si,[gi.SETTINGS]:Ti,[gi._404]:class extends bi{constructor(){super(...arguments),this.stage=gi._404}next(){return Li()}}};function Di(t,...e){Fi.update((n=>{const r=new t(...e);r.from=n.stage;try{history.pushState({data:r.dump(),search:n.search,series:n.series},"",vi(r.stage))}catch(t){history.pushState({data:[],search:n.search,series:n.series},"",vi(r.stage)),console.error("Data too large! Caution, forwards/backwards won't work as expected!")}return Object.assign(Object.assign({},n),{stage:r})}))}function Oi(t,{data:e,search:n,series:r}={}){e=e||[],Fi.update((o=>{try{const s=new Ci[t](...e);return s.stage===o.stage.stage?o:(s.from=o.stage,Object.assign(Object.assign({},o),{search:n,series:r,stage:s}))}catch(r){return console.group("Failed to update page"),console.error(r),console.log("Parameters:",t,e,n),console.groupEnd(),history.pushState({data:[],search:o.search,series:o.series},"","/"),o}}))}function Li(){history.back()}function Ai(t,e){return!!t&&t.stage===e}const Fi=Ut({stage:new $i}),Ni=new RegExp("^"+l.p.replace("/","/")),Ri=()=>{const t=location.pathname.replace(Ni,"").split("/")[0]||"";if(t.length>60)return;if(""===t)return Oi(gi.INPUT);const e=t.toUpperCase().replace(/-/g,"_"),n=history.state||(()=>{try{return JSON.parse(localStorage.getItem("state"))}catch(t){return}})()||{};return e in gi?Oi(gi[e],n):Oi(gi._404)};function _i(e){let n,r,o,s;return{c(){n=O("svg"),r=O("g"),o=O("path"),s=O("path"),M(o,"d","M173.145,73.91c-0.413-2.722-2.29-4.993-4.881-5.912l-13.727-4.881c-0.812-2.3-1.733-4.536-2.754-6.699l6.247-13.146\n\t\tc1.179-2.479,0.899-5.411-0.729-7.628c-5.265-7.161-11.556-13.452-18.698-18.693c-2.219-1.629-5.141-1.906-7.625-0.724\n\t\tl-13.138,6.242c-2.163-1.021-4.402-1.94-6.704-2.752l-4.883-13.729c-0.919-2.586-3.184-4.458-5.9-4.876\n\t\tc-9.65-1.483-16.792-1.483-26.457,0c-2.713,0.418-4.981,2.29-5.9,4.876l-4.883,13.729c-2.302,0.812-4.541,1.731-6.702,2.752\n\t\tl-13.143-6.242c-2.479-1.181-5.406-0.904-7.623,0.724c-7.142,5.241-13.433,11.532-18.698,18.693\n\t\tc-1.629,2.217-1.908,5.148-0.729,7.628l6.247,13.146c-1.021,2.159-1.94,4.4-2.754,6.699L5.982,68.003\n\t\tc-2.589,0.919-4.463,3.189-4.879,5.907c-0.749,4.92-1.099,9.115-1.099,13.219c0,4.098,0.35,8.299,1.099,13.219\n\t\tc0.413,2.722,2.29,4.993,4.881,5.912l13.727,4.881c0.814,2.304,1.736,4.541,2.754,6.704l-6.247,13.141\n\t\tc-1.179,2.479-0.899,5.411,0.727,7.623c5.258,7.156,11.549,13.447,18.7,18.698c2.217,1.629,5.144,1.911,7.625,0.724l13.138-6.242\n\t\tc2.163,1.021,4.402,1.94,6.704,2.752l4.883,13.729c0.919,2.586,3.184,4.458,5.9,4.876c4.828,0.744,9.154,1.104,13.228,1.104\n\t\tc4.074,0,8.401-0.36,13.228-1.104c2.715-0.418,4.981-2.29,5.9-4.876l4.883-13.729c2.302-0.812,4.541-1.731,6.704-2.752\n\t\tl13.138,6.242c2.484,1.186,5.411,0.904,7.628-0.724c7.159-5.26,13.45-11.551,18.698-18.698c1.626-2.212,1.906-5.144,0.727-7.623\n\t\tl-6.247-13.141c1.021-2.163,1.942-4.405,2.754-6.704l13.727-4.881c2.591-0.919,4.468-3.189,4.881-5.912\n\t\tc0.749-4.92,1.099-9.12,1.099-13.219S173.894,78.829,173.145,73.91z M158.949,93.72l-12.878,4.58\n\t\tc-2.251,0.797-3.982,2.625-4.66,4.92c-1.15,3.889-2.664,7.569-4.504,10.943c-1.142,2.1-1.213,4.619-0.187,6.777l5.841,12.285\n\t\tc-2.822,3.389-5.943,6.515-9.337,9.334l-12.283-5.834c-2.161-1.036-4.672-0.953-6.775,0.185c-3.379,1.838-7.061,3.35-10.953,4.502\n\t\tc-2.29,0.676-4.118,2.406-4.917,4.657l-4.582,12.883c-4.677,0.476-8.503,0.476-13.18,0l-4.582-12.883\n\t\tc-0.8-2.246-2.628-3.982-4.917-4.657c-3.894-1.152-7.579-2.664-10.953-4.502c-2.103-1.147-4.619-1.22-6.775-0.185l-12.283,5.839\n\t\tc-3.391-2.825-6.512-5.946-9.337-9.339l5.841-12.285c1.026-2.159,0.955-4.677-0.187-6.777c-1.835-3.364-3.35-7.049-4.504-10.948\n\t\tc-0.678-2.29-2.411-4.118-4.66-4.915l-12.878-4.58c-0.243-2.343-0.36-4.502-0.36-6.592s0.117-4.244,0.36-6.587l12.881-4.584\n\t\tc2.248-0.797,3.979-2.625,4.657-4.915c1.152-3.889,2.667-7.574,4.504-10.953c1.142-2.095,1.213-4.619,0.187-6.772l-5.841-12.285\n\t\tc2.827-3.393,5.948-6.519,9.337-9.339l12.288,5.839c2.151,1.036,4.677,0.953,6.775-0.185c3.372-1.838,7.054-3.35,10.948-4.502\n\t\tc2.29-0.676,4.118-2.411,4.917-4.657l4.582-12.883c4.633-0.481,8.466-0.481,13.18,0l4.582,12.883\n\t\tc0.8,2.246,2.628,3.982,4.917,4.657c3.894,1.152,7.579,2.664,10.953,4.502c2.103,1.147,4.614,1.22,6.775,0.185l12.283-5.839\n\t\tc3.389,2.82,6.51,5.946,9.337,9.339l-5.841,12.285c-1.026,2.154-0.955,4.677,0.187,6.772c1.843,3.389,3.357,7.069,4.504,10.948\n\t\tc0.678,2.295,2.409,4.123,4.66,4.92l12.878,4.58c0.243,2.343,0.36,4.502,0.36,6.592S159.192,91.377,158.949,93.72z"),M(s,"d","M87.124,50.802c-19.062,0-34.571,15.508-34.571,34.571s15.508,34.571,34.571,34.571s34.571-15.508,34.571-34.571\n\t\tS106.186,50.802,87.124,50.802z M87.124,105.009c-10.827,0-19.636-8.809-19.636-19.636s8.809-19.636,19.636-19.636\n\t\ts19.636,8.809,19.636,19.636S97.951,105.009,87.124,105.009z"),M(n,"version","1.1"),M(n,"xmlns","http://www.w3.org/2000/svg"),M(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),M(n,"x","0px"),M(n,"y","0px"),M(n,"viewBox","0 0 174.248 174.248"),M(n,"xml:space","preserve")},m(t,e){S(t,n,e),x(n,r),x(r,o),x(r,s)},p:t,i:t,o:t,d(t){t&&T(n)}}}const Mi=class extends Ot{constructor(t){super(),Dt(this,t,null,_i,i,{})}};function ji(t){let e,n;const r=t[1].default,o=u(r,t,t[0],null);return{c(){e=D("p"),o&&o.c(),M(e,"class","info alert svelte-1mwdlru")},m(t,r){S(t,e,r),o&&o.m(e,null),n=!0},p(t,[e]){o&&o.p&&(!n||1&e)&&f(o,r,t,t[0],n?p(r,t[0],e,null):h(t[0]),null)},i(t){n||(ht(o,t),n=!0)},o(t){mt(o,t),n=!1},d(t){t&&T(e),o&&o.d(t)}}}function Pi(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}const Ui=class extends Ot{constructor(t){super(),Dt(this,t,Pi,ji,i,{})}};function Ii(e){let n,r,o;return{c(){n=L("Due to "),r=D("a"),r.textContent="recent API changes on reddit",o=L(', creating ebooks has become limited. If you run into a "Too many requests" error, please wait 10 minutes before trying again.'),M(r,"href","https://www.redditinc.com/blog/apifacts"),M(r,"target","_blank"),M(r,"class","svelte-ntsh7z")},m(t,e){S(t,n,e),S(t,r,e),S(t,o,e)},p:t,d(t){t&&T(n),t&&T(r),t&&T(o)}}}function Hi(t){let e,n,r,o,s;return o=new Ui({props:{$$slots:{default:[Ii]},$$scope:{ctx:t}}}),{c(){e=D("header"),n=D("h1"),n.innerHTML='r/HFY epub generator <a class="small svelte-ntsh7z" href="https://github.com/cpiber/hfy-epub/tree/master/docs/index.md" target="_blank">Help</a>',r=A(),St(o.$$.fragment),M(n,"class","svelte-ntsh7z"),M(e,"class","svelte-ntsh7z")},m(t,i){S(t,e,i),x(e,n),x(e,r),Tt(o,e,null),s=!0},p(t,[e]){const n={};1&e&&(n.$$scope={dirty:e,ctx:t}),o.$set(n)},i(t){s||(ht(o.$$.fragment,t),s=!0)},o(t){mt(o.$$.fragment,t),s=!1},d(t){t&&T(e),Ct(o)}}}const zi=class extends Ot{constructor(t){super(),Dt(this,t,null,Hi,i,{})}};function Bi(e){let n,r,o,s,i,l,c,a;return{c(){n=D("p"),r=L("This website ("),o=D("a"),o.textContent="https://cpiber.github.io/hfy-epub",s=L(") does not, and will not, collect any data from its users.\n      Any actions taken on this page are purely in the user's browser; there is no server-side component.\n      No data is ever sent away.\n      For collecting the chapter data, this site contacts "),i=D("code"),i.textContent="www.reddit.com",l=L(" only. The book is generated in the browser."),M(o,"href","https://cpiber.github.io/hfy-epub"),M(o,"target","_blank"),M(n,"class","small svelte-1f8pws6")},m(t,e){S(t,n,e),x(n,r),x(n,o),x(n,s),x(n,i),x(n,l),a=!0},p:t,i(t){a||(nt((()=>{c||(c=vt(n,Oe,{},!0)),c.run(1)})),a=!0)},o(t){c||(c=vt(n,Oe,{},!1)),c.run(0),a=!1},d(t){t&&T(n),t&&c&&c.end()}}}function qi(t){let e,n,r,o,s;return{c(){e=D("label"),n=D("input"),r=L(" Use TinyMCE chapter editor"),M(n,"type","checkbox"),M(n,"aria-label","use TinyMCE editor"),M(n,"class","svelte-1f8pws6"),M(e,"class","small svelte-1f8pws6")},m(i,l){S(i,e,l),x(e,n),n.checked=t[2].useTiny,x(e,r),o||(s=N(n,"change",t[4]),o=!0)},p(t,e){4&e&&(n.checked=t[2].useTiny)},d(t){t&&T(e),o=!1,s()}}}function Wi(t){let e,n,r,o,s,i,l,c,a,u,d,p,f,h,m,g,v=!Ai(t[1].stage,gi.SETTINGS),b=t[0]&&Bi(),$=v&&qi(t);return{c(){e=D("footer"),n=D("p"),r=L("Made by "),o=D("a"),o.textContent="@cpiber",s=L(".\n    Source Code & bug tracker: "),i=D("a"),i.textContent="cpiber/hfy-epub",l=L(".\n    \n    Version "),c=L("0.2.8"),a=L(".\n    "),u=D("a"),u.textContent="Privacy",d=L("."),p=A(),b&&b.c(),f=A(),$&&$.c(),M(o,"href","https://github.com/cpiber"),M(o,"target","_blank"),M(i,"href","https://github.com/cpiber/hfy-epub"),M(i,"target","_blank"),M(u,"href","#privacy"),M(n,"class","small svelte-1f8pws6"),M(e,"class","svelte-1f8pws6")},m(v,y){S(v,e,y),x(e,n),x(n,r),x(n,o),x(n,s),x(n,i),x(n,l),x(n,c),x(n,a),x(n,u),x(n,d),x(e,p),b&&b.m(e,null),x(e,f),$&&$.m(e,null),h=!0,m||(g=N(u,"click",R(t[3])),m=!0)},p(t,[n]){t[0]?b?(b.p(t,n),1&n&&ht(b,1)):(b=Bi(),b.c(),ht(b,1),b.m(e,f)):b&&(pt(),mt(b,1,1,(()=>{b=null})),ft()),2&n&&(v=!Ai(t[1].stage,gi.SETTINGS)),v?$?$.p(t,n):($=qi(t),$.c(),$.m(e,null)):$&&($.d(1),$=null)},i(t){h||(ht(b),h=!0)},o(t){mt(b),h=!1},d(t){t&&T(e),b&&b.d(),$&&$.d(),m=!1,g()}}}function Gi(t,e,n){let r,o;a(t,Fi,(t=>n(1,r=t))),a(t,Bt,(t=>n(2,o=t)));let s=!1;return[s,r,o,()=>n(0,s=!s),function(){o.useTiny=this.checked,Bt.set(o)}]}const Xi=class extends Ot{constructor(t){super(),Dt(this,t,Gi,Wi,i,{})}};function Yi(e){let n,r,o,s,i,l;return r=new Go({}),{c(){n=D("a"),St(r.$$.fragment),o=L(" home"),M(n,"href","#home"),M(n,"class","homelink svelte-ibaoy7")},m(t,c){S(t,n,c),Tt(r,n,null),x(n,o),s=!0,i||(l=N(n,"click",R(e[5])),i=!0)},p:t,i(t){s||(ht(r.$$.fragment,t),s=!0)},o(t){mt(r.$$.fragment,t),s=!1},d(t){t&&T(n),Ct(r),i=!1,l()}}}function Ki(e){let n,r,o,s,i;return r=new Mi({}),{c(){n=D("a"),St(r.$$.fragment),M(n,"href","#settings"),M(n,"class","settingslink svelte-ibaoy7")},m(t,l){S(t,n,l),Tt(r,n,null),o=!0,s||(i=N(n,"click",R(e[3])),s=!0)},p:t,i(t){o||(ht(r.$$.fragment,t),o=!0)},o(t){mt(r.$$.fragment,t),o=!1},d(t){t&&T(n),Ct(r),s=!1,i()}}}function Vi(e){let n,r,o,s,i,l;return r=new Go({}),{c(){n=D("a"),St(r.$$.fragment),o=L(" back"),M(n,"href","#home"),M(n,"class","homelink svelte-ibaoy7")},m(t,c){S(t,n,c),Tt(r,n,null),x(n,o),s=!0,i||(l=N(n,"click",R(e[6])),i=!0)},p:t,i(t){s||(ht(r.$$.fragment,t),s=!0)},o(t){mt(r.$$.fragment,t),s=!1},d(t){t&&T(n),Ct(r),i=!1,l()}}}function Zi(e){let n,r,o;return{c(){n=D("h2"),n.textContent="Page not found",r=A(),o=D("p"),o.textContent="Sorry, the requested page could not be found"},m(t,e){S(t,n,e),S(t,r,e),S(t,o,e)},p:t,i:t,o:t,d(t){t&&T(n),t&&T(r),t&&T(o)}}}function Ji(e){let n,r;return n=new le({}),{c(){St(n.$$.fragment)},m(t,e){Tt(n,t,e),r=!0},p:t,i(t){r||(ht(n.$$.fragment,t),r=!0)},o(t){mt(n.$$.fragment,t),r=!1},d(t){Ct(n,t)}}}function Qi(t){let e,n;return e=new Be({props:{stage:t[0],backToSearch:t[2]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),4&n&&(r.backToSearch=t[2]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function tl(t){let e,n;return e=new xn({props:{stage:t[0]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function el(t){let e,n;return e=new An({props:{stage:t[0]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function nl(t){let e,n;return e=new As({props:{stage:t[0]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function rl(t){let e,n;return e=new Ys({props:{stage:t[0],series:t[1].series,backToSearch:t[2]}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),2&n&&(r.series=t[1].series),4&n&&(r.backToSearch=t[2]),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function ol(t){let e,n;return e=new oi({props:{stage:t[0],search:t[1].search}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),2&n&&(r.search=t[1].search),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function sl(t){let e,n;return e=new mi({props:{stage:t[0],search:t[1].search}}),{c(){St(e.$$.fragment)},m(t,r){Tt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.stage=t[0]),2&n&&(r.search=t[1].search),e.$set(r)},i(t){n||(ht(e.$$.fragment,t),n=!0)},o(t){mt(e.$$.fragment,t),n=!1},d(t){Ct(e,t)}}}function il(t){let e,n,r,o,s,i,l,c,a,u,d,p,f,h,m,g,v,b,$,y,w,k,E,C,O=!Ai(t[0],gi.INPUT)&&!Ai(t[0],gi.SETTINGS),L=O&&Yi(t);const F=[Vi,Ki],N=[];function R(t,e){return 1&e&&(o=null),null==o&&(o=!!Ai(t[0],gi.SETTINGS)),o?0:1}s=R(t,-1),i=N[s]=F[s](t),c=new zi({});const _=[sl,ol,rl,nl,el,tl,Qi,Ji,Zi],j=[];function P(t,e){return 1&e&&(d=null),1&e&&(p=null),1&e&&(f=null),1&e&&(h=null),1&e&&(m=null),1&e&&(g=null),1&e&&(v=null),1&e&&(b=null),1&e&&($=null),null==d&&(d=!!Ai(t[0],gi.INPUT)),d?0:(null==p&&(p=!!Ai(t[0],gi.SEARCH)),p?1:(null==f&&(f=!!Ai(t[0],gi.BOOK_DATA)),f?2:(null==h&&(h=!!Ai(t[0],gi.EDIT_DATA)),h?3:(null==m&&(m=!!Ai(t[0],gi.FIND_CHAPTERS)),m?4:(null==g&&(g=!!Ai(t[0],gi.DOWNLOAD_CHAPTERS)),g?5:(null==v&&(v=!!Ai(t[0],gi.RESULT)),v?6:(null==b&&(b=!!Ai(t[0],gi.SETTINGS)),b?7:(null==$&&($=!!Ai(t[0],gi._404)),$?8:-1))))))))}return~(y=P(t,-1))&&(w=j[y]=_[y](t)),E=new Xi({}),{c(){e=D("div"),n=D("nav"),L&&L.c(),r=A(),i.c(),l=A(),St(c.$$.fragment),a=A(),u=D("main"),w&&w.c(),k=A(),St(E.$$.fragment),M(n,"class","mainnav svelte-ibaoy7"),M(u,"class","App-main"),M(e,"class","App svelte-ibaoy7")},m(t,o){S(t,e,o),x(e,n),L&&L.m(n,null),x(n,r),N[s].m(n,null),x(e,l),Tt(c,e,null),x(e,a),x(e,u),~y&&j[y].m(u,null),x(e,k),Tt(E,e,null),C=!0},p(t,[e]){1&e&&(O=!Ai(t[0],gi.INPUT)&&!Ai(t[0],gi.SETTINGS)),O?L?(L.p(t,e),1&e&&ht(L,1)):(L=Yi(t),L.c(),ht(L,1),L.m(n,r)):L&&(pt(),mt(L,1,1,(()=>{L=null})),ft());let o=s;s=R(t,e),s===o?N[s].p(t,e):(pt(),mt(N[o],1,1,(()=>{N[o]=null})),ft(),i=N[s],i?i.p(t,e):(i=N[s]=F[s](t),i.c()),ht(i,1),i.m(n,null));let l=y;y=P(t,e),y===l?~y&&j[y].p(t,e):(w&&(pt(),mt(j[l],1,1,(()=>{j[l]=null})),ft()),~y?(w=j[y],w?w.p(t,e):(w=j[y]=_[y](t),w.c()),ht(w,1),w.m(u,null)):w=null)},i(t){C||(ht(L),ht(i),ht(c.$$.fragment,t),ht(w),ht(E.$$.fragment,t),C=!0)},o(t){mt(L),mt(i),mt(c.$$.fragment,t),mt(w),mt(E.$$.fragment,t),C=!1},d(t){t&&T(e),L&&L.d(),N[s].d(),Ct(c),~y&&j[y].d(),Ct(E)}}}function ll(t,e,n){let r,o,s,i;return a(t,Fi,(t=>n(1,s=t))),a(t,Bt,(t=>n(4,i=t))),t.$$.update=()=>{if(2&t.$$.dirty&&n(0,r=s.stage),1&t.$$.dirty&&n(2,o=Ai(r.from,gi.SEARCH)?()=>Di(yi):void 0),t.$$.dirty,t.$$.dirty,t.$$.dirty,16&t.$$.dirty&&localStorage.setItem("config",JSON.stringify(i)),2&t.$$.dirty)try{localStorage.setItem("state",JSON.stringify({data:s.stage.dump(),search:s.search,series:s.series}))}catch(t){localStorage.setItem("state",JSON.stringify({data:[],search:s.search,series:s.series})),console.error("Data too large! Caution, reloading won't work as expected!")}},[r,s,o,()=>{r.needsSaving&&!confirm("Unsaved changes. Continue?")||Di(Ti)},i,()=>Di($i),()=>r.next()]}(()=>{try{const t=JSON.parse(localStorage.getItem("config"));Bt.set((t=>{if(!t||""+t!="[object Object]")return zt;const e=Object.keys(t),n=Object.keys(zt);for(const r of n)e.includes(r)||(t[r]=zt[r]),typeof zt[r]!=typeof t[r]&&(t[r]=zt[r]);return t})(t))}catch(t){}})(),window.removeEventListener("popstate",Ri),window.addEventListener("popstate",Ri),Ri();const cl=class extends Ot{constructor(t){super(),Dt(this,t,ll,il,i,{})}};let al;try{al=new cl({target:document.body})}catch(t){const e=document.createElement("div");e.className="fatal-error",e.ariaLabel="error",e.appendChild(document.createElement("h1")).textContent="Something went wrong:",e.appendChild(document.createElement("code")).textContent=t,document.body.appendChild(e)}})(),c=l.O(c)})();