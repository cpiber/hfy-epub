(()=>{var t,e,n,r,o,i={4785:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){return function t(e,n,r){var o,i,s=window,l="application/octet-stream",c=r||l,a=e,u=!n&&!r&&a,d=document.createElement("a"),f=function(t){return String(t)},p=s.Blob||s.MozBlob||s.WebKitBlob||f,h=n||"download";if(p=p.call?p.bind(s):Blob,"true"===String(this)&&(c=(a=[a,c])[0],a=a[1]),u&&u.length<2048&&(h=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var g=new XMLHttpRequest;return g.open("GET",u,!0),g.responseType="blob",g.onload=function(e){t(e.target.response,h,l)},setTimeout((function(){g.send()}),0),g}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(a)){if(!(a.length>2096103.424&&p!==f))return navigator.msSaveBlob?navigator.msSaveBlob($(a),h):v(a);c=(a=$(a)).type||l}else if(/([\x80-\xff])/.test(a)){for(var m=0,b=new Uint8Array(a.length),y=b.length;m<y;++m)b[m]=a.charCodeAt(m);a=new p([b],{type:c})}function $(t){for(var e=t.split(/[:;,]/),n=e[1],r=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),o=r.length,i=0,s=new Uint8Array(o);i<o;++i)s[i]=r.charCodeAt(i);return new p([s],{type:n})}function v(t,e){if("download"in d)return d.href=t,d.setAttribute("download",h),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){s.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,l)),n.src=t,setTimeout((function(){document.body.removeChild(n)}),333)}if(o=a instanceof p?a:new p([a],{type:c}),navigator.msSaveBlob)return navigator.msSaveBlob(o,h);if(s.URL)v(s.URL.createObjectURL(o),!0);else{if("string"==typeof o||o.constructor===f)try{return v("data:"+c+";base64,"+s.btoa(o))}catch(t){return v("data:"+c+","+encodeURIComponent(o))}(i=new FileReader).onload=function(t){v(this.result)},i.readAsDataURL(o)}return!0}})?n.apply(e,[]):n)||(t.exports=r)}},s={};function l(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={id:t,loaded:!1,exports:{}};return i[t].call(n.exports,n,n.exports,l),n.loaded=!0,n.exports}l.m=i,t=[],l.O=(e,n,r,o)=>{if(!n){var i=1/0;for(u=0;u<t.length;u++){for(var[n,r,o]=t[u],s=!0,c=0;c<n.length;c++)(!1&o||i>=o)&&Object.keys(l.O).every((t=>l.O[t](n[c])))?n.splice(c--,1):(s=!1,o<i&&(i=o));if(s){t.splice(u--,1);var a=r();void 0!==a&&(e=a)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[n,r,o]},l.F={},l.E=t=>{Object.keys(l.F).map((e=>{l.F[e](t)}))},l.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return l.d(e,{a:e}),e},n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,l.t=function(t,r){if(1&r&&(t=this(t)),8&r)return t;if("object"==typeof t&&t){if(4&r&&t.__esModule)return t;if(16&r&&"function"==typeof t.then)return t}var o=Object.create(null);l.r(o);var i={};e=e||[null,n({}),n([]),n(n)];for(var s=2&r&&t;"object"==typeof s&&!~e.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,l.d(o,i),o},l.d=(t,e)=>{for(var n in e)l.o(e,n)&&!l.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},l.f={},l.e=t=>Promise.all(Object.keys(l.f).reduce(((e,n)=>(l.f[n](t,e),e)),[])),l.u=t=>t+"-"+{483:"fefd040803c093fe8d27",845:"74c785c44477a9538d2c"}[t]+".js",l.miniCssF=t=>{},l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),l.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r={},o="hfy-epub:",l.l=(t,e,n,i)=>{if(r[t])r[t].push(e);else{var s,c;if(void 0!==n)for(var a=document.getElementsByTagName("script"),u=0;u<a.length;u++){var d=a[u];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==o+n){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,l.nc&&s.setAttribute("nonce",l.nc),s.setAttribute("data-webpack",o+n),s.src=t),r[t]=[e];var f=(e,n)=>{s.onerror=s.onload=null,clearTimeout(p);var o=r[t];if(delete r[t],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((t=>t(n))),e)return e(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}},l.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;l.g.importScripts&&(t=l.g.location+"");var e=l.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=t})(),(()=>{var t={179:0};l.f.j=(e,n)=>{var r=l.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=t[e]=[n,o]));n.push(r[2]=o);var i=l.p+l.u(e),s=new Error;l.l(i,(n=>{if(l.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",s.name="ChunkLoadError",s.type=o,s.request=i,r[1](s)}}),"chunk-"+e,e)}},l.F.j=e=>{if(!l.o(t,e)||void 0===t[e]){t[e]=null;var n=document.createElement("link");l.nc&&n.setAttribute("nonce",l.nc),n.rel="prefetch",n.as="script",n.href=l.p+l.u(e),document.head.appendChild(n)}},l.O.j=e=>0===t[e];var e=(e,n)=>{var r,o,[i,s,c]=n,a=0;if(i.some((e=>0!==t[e]))){for(r in s)l.o(s,r)&&(l.m[r]=s[r]);if(c)var u=c(l)}for(e&&e(n);a<i.length;a++)o=i[a],l.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return l.O(u)},n=self.webpackChunkhfy_epub=self.webpackChunkhfy_epub||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),l.O(0,[179],(()=>{l.E(845),l.E(483)}),5);var c={};(()=>{"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function o(){return Object.create(null)}function i(t){t.forEach(r)}function s(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t){return 0===Object.keys(t).length}function u(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function d(t,e,n,r){if(t){const o=f(t,e,n,r);return t[0](o)}}function f(t,e,r,o){return t[1]&&o?n(r.ctx.slice(),t[1](o(e))):r.ctx}function p(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function h(t,e,n,r,o,i){if(o){const s=f(e,n,r,i);t.p(s,o)}}function g(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}const m="undefined"!=typeof window;let b=m?()=>window.performance.now():()=>Date.now(),y=m?t=>requestAnimationFrame(t):t;const $=new Set;function v(t){$.forEach((e=>{e.c(t)||($.delete(e),e.f())})),0!==$.size&&y(v)}let w=!1;function x(t,e){t.appendChild(e)}function k(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function E(t){const e=C("style");return function(t,e){x(t.head||t,e)}(k(t),e),e.sheet}function T(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode.removeChild(t)}function D(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function C(t){return document.createElement(t)}function A(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function O(t){return document.createTextNode(t)}function N(){return O(" ")}function L(){return O("")}function _(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function M(t){return function(e){return e.preventDefault(),t.call(this,e)}}function P(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function R(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function j(t,e){t.value=null==e?"":e}function F(t,e,n){t.classList[n?"add":"remove"](e)}const I=new Map;let H,B=0;function U(t){H=t}function z(){if(!H)throw new Error("Function called outside component initialization");return H}const W=[],q=[],Y=[],V=[],X=Promise.resolve();let G=!1;function Z(t){Y.push(t)}function K(t){V.push(t)}const J=new Set;let Q=0;function tt(){const t=H;do{for(;Q<W.length;){const t=W[Q];Q++,U(t),et(t.$$)}for(U(null),W.length=0,Q=0;q.length;)q.pop()();for(let t=0;t<Y.length;t+=1){const e=Y[t];J.has(e)||(J.add(e),e())}Y.length=0}while(W.length);for(;V.length;)V.pop()();G=!1,J.clear(),U(t)}function et(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Z)}}const nt=new Set;let rt,ot;function it(){rt={r:0,c:[],p:rt}}function st(){rt.r||i(rt.c),rt=rt.p}function lt(t,e){t&&t.i&&(nt.delete(t),t.i(e))}function ct(t,e,n,r){if(t&&t.o){if(nt.has(t))return;nt.add(t),rt.c.push((()=>{nt.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}function at(t,e){const n=e.token={};function r(t,r,o,i){if(e.token!==n)return;e.resolved=i;let s=e.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const l=t&&(e.current=t)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(it(),ct(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),st())})):e.block.d(1),l.c(),lt(l,1),l.m(e.mount(),e.anchor),c=!0),e.block=l,e.blocks&&(e.blocks[r]=l),c&&tt()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=z();if(t.then((t=>{U(n),r(e.then,1,e.value,t),U(null)}),(t=>{if(U(n),r(e.catch,2,e.error,t),U(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function ut(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}function dt(t,e){t.d(1),e.delete(t.key)}function ft(t,e){t.f(),function(t,e){ct(t,1,1,(()=>{e.delete(t.key)}))}(t,e)}function pt(t,e,n,r,o,i,s,l,c,a,u,d){let f=t.length,p=i.length,h=f;const g={};for(;h--;)g[t[h].key]=h;const m=[],b=new Map,y=new Map;for(h=p;h--;){const t=d(o,i,h),l=n(t);let c=s.get(l);c?r&&c.p(t,e):(c=a(l,t),c.c()),b.set(l,m[h]=c),l in g&&y.set(l,Math.abs(h-g[l]))}const $=new Set,v=new Set;function w(t){lt(t,1),t.m(l,u),s.set(t.key,t),u=t.first,p--}for(;f&&p;){const e=m[p-1],n=t[f-1],r=e.key,o=n.key;e===n?(u=e.first,f--,p--):b.has(o)?!s.has(r)||$.has(r)?w(e):v.has(o)?f--:y.get(r)>y.get(o)?(v.add(r),w(e)):($.add(o),f--):(c(n,s),f--)}for(;f--;){const e=t[f];b.has(e.key)||c(e,s)}for(;p;)w(m[p-1]);return m}function ht(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function gt(t){t&&t.c()}function mt(t,e,n,o){const{fragment:l,on_mount:c,on_destroy:a,after_update:u}=t.$$;l&&l.m(e,n),o||Z((()=>{const e=c.map(r).filter(s);a?a.push(...e):i(e),t.$$.on_mount=[]})),u.forEach(Z)}function bt(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function yt(e,n,r,s,l,c,a,u=[-1]){const d=H;U(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:l,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(f.root);let p=!1;if(f.ctx=r?r(e,n.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&l(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),p&&function(t,e){-1===t.$$.dirty[0]&&(W.push(t),G||(G=!0,X.then(tt)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!s&&s(f.ctx),n.target){if(n.hydrate){w=!0;const t=(h=n.target,Array.from(h.childNodes));f.fragment&&f.fragment.l(t),t.forEach(S)}else f.fragment&&f.fragment.c();n.intro&&lt(e.$$.fragment),mt(e,n.target,n.anchor,n.customElement),w=!1,tt()}var h;U(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(ot=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(r).filter(s);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){i(this.$$.on_disconnect)}$destroy(){bt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class $t{$destroy(){bt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const vt=t=>(t instanceof URL||(t=new URL(t)),t.hostname="www.reddit.com",t.pathname.endsWith("/")?t.pathname=`${t.pathname.slice(0,t.pathname.length-1)}.json`:t.pathname.endsWith(".json")||(t.pathname+=".json"),t.protocol="https",t.search="",t.hash="",t.toString()),wt=t=>t.slice(0,-5).replace("https://api","https://www"),xt=(()=>{const t=new DOMParser;return e=>t.parseFromString(e,"text/html").documentElement.textContent})(),kt=t=>Object.assign(Object.assign({},t),{chapters:t.chapters.map((t=>Object.assign({},t)))});var Et=l(4785),Tt=l.n(Et);function St(t){let e,n,r;return{c(){e=C("a"),e.textContent="Back to Search",P(e,"href","#search"),P(e,"class","small")},m(o,i){T(o,e,i),n||(r=_(e,"click",M((function(){s(t[0])&&t[0].apply(this,arguments)}))),n=!0)},p(e,n){t=e},d(t){t&&S(e),n=!1,r()}}}function Dt(e){let n,r=e[0]&&St(e);return{c(){r&&r.c(),n=L()},m(t,e){r&&r.m(t,e),T(t,n,e)},p(t,[e]){t[0]?r?r.p(t,e):(r=St(t),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:t,o:t,d(t){r&&r.d(t),t&&S(n)}}}function Ct(t,e,n){let{backToSearch:r}=e;return t.$$set=t=>{"backToSearch"in t&&n(0,r=t.backToSearch)},[r]}const At=class extends $t{constructor(t){super(),yt(this,t,Ct,Dt,c,{backToSearch:0})}};function Ot(e){let n,r,o,i,l,c,a,u,d=e[0]?": ":"",f=(e[0].message||e[0])+"";return{c(){n=C("p"),r=O("Sorry, can't process that"),o=O(d),i=O(f),l=N(),c=C("button"),c.textContent="Retry",P(n,"class","error svelte-alvqhf")},m(t,d){T(t,n,d),x(n,r),x(n,o),x(n,i),T(t,l,d),T(t,c,d),a||(u=_(c,"click",(function(){s(e[1])&&e[1].apply(this,arguments)})),a=!0)},p(t,[n]){e=t,1&n&&d!==(d=e[0]?": ":"")&&R(o,d),1&n&&f!==(f=(e[0].message||e[0])+"")&&R(i,f)},i:t,o:t,d(t){t&&S(n),t&&S(l),t&&S(c),a=!1,u()}}}function Nt(t,e,n){let{error:r}=e,{retry:o}=e;return t.$$set=t=>{"error"in t&&n(0,r=t.error),"retry"in t&&n(1,o=t.retry)},[r,o]}const Lt=class extends $t{constructor(t){super(),yt(this,t,Nt,Ot,c,{error:0,retry:1})}};function _t(t){let e,n,r,o,i;const s=t[1].default,l=d(s,t,t[0],null),c=l||function(t){let e;return{c(){e=O("Loading...")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}();return{c(){e=C("div"),n=C("div"),n.innerHTML='<span class="loading-slider svelte-1pmb758">â€¢</span>',r=N(),o=C("p"),c&&c.c(),P(n,"class","loading-slider-container svelte-1pmb758"),P(o,"class","loading svelte-1pmb758"),P(e,"class","loading-container svelte-1pmb758")},m(t,s){T(t,e,s),x(e,n),x(e,r),x(e,o),c&&c.m(o,null),i=!0},p(t,[e]){l&&l.p&&(!i||1&e)&&h(l,s,t,t[0],i?p(s,t[0],e,null):g(t[0]),null)},i(t){i||(lt(c,t),i=!0)},o(t){ct(c,t),i=!1},d(t){t&&S(e),c&&c.d(t)}}}function Mt(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}const Pt=class extends $t{constructor(t){super(),yt(this,t,Mt,_t,c,{})}};function Rt(t,e,n){const r=t.slice();return r[9]=e[n][0],r[10]=e[n][1],r}function jt(t,e,n){const r=t.slice();return r[9]=e[n][0],r[10]=e[n][1],r}function Ft(t){let e,n,r,o,i,l,c,a;return e=new Lt({props:{error:t[16],retry:t[7]}}),i=new At({props:{backToSearch:t[1]}}),{c(){gt(e.$$.fragment),n=N(),r=C("button"),r.textContent="Back to book",o=N(),gt(i.$$.fragment)},m(u,d){mt(e,u,d),T(u,n,d),T(u,r,d),T(u,o,d),mt(i,u,d),l=!0,c||(a=_(r,"click",(function(){s(t[2])&&t[2].apply(this,arguments)})),c=!0)},p(n,r){t=n;const o={};16&r&&(o.error=t[16]),16&r&&(o.retry=t[7]),e.$set(o);const s={};2&r&&(s.backToSearch=t[1]),i.$set(s)},i(t){l||(lt(e.$$.fragment,t),lt(i.$$.fragment,t),l=!0)},o(t){ct(e.$$.fragment,t),ct(i.$$.fragment,t),l=!1},d(t){bt(e,t),t&&S(n),t&&S(r),t&&S(o),bt(i,t),c=!1,a()}}}function It(t){let e,n,r,o,l,c,a,u,d,f,p,h,g=t[3].find(Vt);function m(){return t[6](t[13])}a=new At({props:{backToSearch:t[1]}});let b=g&&Ht(t);return{c(){e=C("h3"),e.textContent="Your e-book is ready!",n=N(),r=C("button"),r.textContent="Download",o=N(),l=C("button"),l.textContent="Back to book",c=N(),gt(a.$$.fragment),u=N(),b&&b.c(),d=L(),P(e,"class","valid svelte-1o8hxnt")},m(i,g){T(i,e,g),T(i,n,g),T(i,r,g),T(i,o,g),T(i,l,g),T(i,c,g),mt(a,i,g),T(i,u,g),b&&b.m(i,g),T(i,d,g),f=!0,p||(h=[_(r,"click",m),_(l,"click",(function(){s(t[2])&&t[2].apply(this,arguments)}))],p=!0)},p(e,n){t=e;const r={};2&n&&(r.backToSearch=t[1]),a.$set(r),8&n&&(g=t[3].find(Vt)),g?b?b.p(t,n):(b=Ht(t),b.c(),b.m(d.parentNode,d)):b&&(b.d(1),b=null)},i(t){f||(lt(a.$$.fragment,t),f=!0)},o(t){ct(a.$$.fragment,t),f=!1},d(t){t&&S(e),t&&S(n),t&&S(r),t&&S(o),t&&S(l),t&&S(c),bt(a,t),t&&S(u),b&&b.d(t),t&&S(d),p=!1,i(h)}}}function Ht(t){let e,n=t[3],r=[];for(let e=0;e<n.length;e+=1)r[e]=Ut(Rt(t,n,e));return{c(){e=C("div");for(let t=0;t<r.length;t+=1)r[t].c();P(e,"class","logs svelte-1o8hxnt")},m(t,n){T(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(8&o){let i;for(n=t[3],i=0;i<n.length;i+=1){const s=Rt(t,n,i);r[i]?r[i].p(s,o):(r[i]=Ut(s),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(t){t&&S(e),D(r,t)}}}function Bt(t){let e,n,r=t[10]+"";return{c(){e=C("p"),n=O(r),P(e,"class","small warning svelte-1o8hxnt")},m(t,r){T(t,e,r),x(e,n)},p(t,e){8&e&&r!==(r=t[10]+"")&&R(n,r)},d(t){t&&S(e)}}}function Ut(t){let e,n="warn"===t[9]&&Bt(t);return{c(){n&&n.c(),e=L()},m(t,r){n&&n.m(t,r),T(t,e,r)},p(t,r){"warn"===t[9]?n?n.p(t,r):(n=Bt(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&S(e)}}}function zt(t){let e,n,r,o;e=new Pt({props:{$$slots:{default:[Wt]},$$scope:{ctx:t}}});let i=t[3],s=[];for(let e=0;e<i.length;e+=1)s[e]=qt(jt(t,i,e));return{c(){gt(e.$$.fragment),n=N(),r=C("div");for(let t=0;t<s.length;t+=1)s[t].c();P(r,"class","logs svelte-1o8hxnt")},m(t,i){mt(e,t,i),T(t,n,i),T(t,r,i);for(let t=0;t<s.length;t+=1)s[t].m(r,null);o=!0},p(t,n){const o={};if(131072&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),8&n){let e;for(i=t[3],e=0;e<i.length;e+=1){const o=jt(t,i,e);s[e]?s[e].p(o,n):(s[e]=qt(o),s[e].c(),s[e].m(r,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){o||(lt(e.$$.fragment,t),o=!0)},o(t){ct(e.$$.fragment,t),o=!1},d(t){bt(e,t),t&&S(n),t&&S(r),D(s,t)}}}function Wt(t){let e;return{c(){e=O("Please wait, generating e-book...")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function qt(t){let e,n,r=t[10]+"";return{c(){e=C("p"),n=O(r),P(e,"class","small svelte-1o8hxnt"),F(e,"warning","warn"===t[9])},m(t,r){T(t,e,r),x(e,n)},p(t,o){8&o&&r!==(r=t[10]+"")&&R(n,r),8&o&&F(e,"warning","warn"===t[9])},d(t){t&&S(e)}}}function Yt(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:zt,then:It,catch:Ft,value:13,error:16,blocks:[,,,]};return at(n=t[4],o),{c(){e=L(),o.block.c()},m(t,n){T(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,16&r&&n!==(n=t[4])&&at(n,o)||ut(o,t,r)},i(t){r||(lt(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)ct(o.blocks[t]);r=!1},d(t){t&&S(e),o.block.d(t),o.token=null,o=null}}}const Vt=([t])=>"warn"===t;function Xt(t,e,n){let{data:r}=e,{backToSearch:o}=e,{backToBook:i}=e;const s=Promise.all([l.e(845),l.e(483)]).then(l.t.bind(l,9845,23));let c=[];const a=async()=>{n(3,c=[]);const{default:t}=await s;return await t({title:xt(r.title),author:xt(r.author),ignoreFailedDownloads:!0,verbose:(t,e,...r)=>{c.push([t,e]),n(3,c)}},r.chapters.map((t=>({title:xt(t.title),content:t.content,url:t.displayUrl}))))};let u=a();return t.$$set=t=>{"data"in t&&n(0,r=t.data),"backToSearch"in t&&n(1,o=t.backToSearch),"backToBook"in t&&n(2,i=t.backToBook)},[r,o,i,c,u,a,t=>Tt()(t,`${xt(r.author)} - ${xt(r.title)}.epub`,"application/epub+zip"),()=>n(4,u=a())]}const Gt=class extends $t{constructor(t){super(),yt(this,t,Xt,Yt,c,{data:0,backToSearch:1,backToBook:2})}},Zt=async(t,e)=>{const n="undefined"!=typeof AbortController?new AbortController:{},r=setTimeout((()=>n.abort&&n.abort()),e);try{return await fetch(t,{signal:n.signal})}finally{clearTimeout(r)}},Kt=async(t,e=1e4,n=3)=>{for(let r=0;r<n-1;r++)try{return await Zt(t,e)}catch(e){console.log(`Failed to fetch \`${t}\` ${r+1} ${0===r?"time":"times"}. Retrying...`)}return Zt(t,e)};let Jt=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_")),"");const Qt=/(?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/.+/i,te=/href="((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/([^\/]+)\/comments\/[^"]+)"[^>]*>\s*([^<]+)/gim,ee=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/hfy\/wiki\/series\//i,ne=async t=>{const e=await Kt("https://www.reddit.com/r/hfy/wiki/series.json"),n=[...(await e.json()).data.content_md.matchAll(/\[([^\]]+)\]\s*\(((?:https?:\/\/(?:[^.]+\.)?reddit\.com)?\/r\/hfy\/wiki\/series\/[^)]+)\)\s*(?:\[\*([^\]]+)\*\])?/gim)].map((t=>({title:t[1],author:t[3],url:vt(t[2].startsWith("http")?t[2]:`https://www.reddit.com${t[2]}`)})));if(!t)return n;const r=t.toLowerCase();return n.filter((t=>-1!==t.title.toLowerCase().indexOf(r)))},re=/^https?:\/\/(?:[^.]+\.)?reddit\.com\/r\/([^/]+)\/comments\//i,oe=t=>({id:t[0].data.children[0].data.id,title:t[0].data.children[0].data.title,content:xt(t[0].data.children[0].data.selftext_html),apiUrl:vt(t[0].data.children[0].data.url),displayUrl:t[0].data.children[0].data.url,needsFetching:!1});var ie;!function(t){t[t.HFY_SERIES=0]="HFY_SERIES",t[t.POST=1]="POST",t[t.SEARCH=2]="SEARCH"}(ie||(ie={}));const se=t=>{const e=t.match(/href="([^"]+)"[^>]*>\s*Next/i);if(e)return e[1];const n=[...t.matchAll(te)].reverse().find((t=>{const e=t[3].toLowerCase();return!e.startsWith("first")&&!e.startsWith("prev")&&!e.startsWith("index")}));return n?n[1]:void 0};function le(t,e,n){const r=t.slice();return r[6]=e[n],r}function ce(t){let e,n;return e=new Lt({props:{error:t[10],retry:t[5]}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[10]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ae(e){let n,r=e[0](e[9])+"";return{c(){n=O(r)},m(t,e){T(t,n,e)},p(t,e){5&e&&r!==(r=t[0](t[9])+"")&&R(n,r)},i:t,o:t,d(t){t&&S(n)}}}function ue(t){let e,n,r,o;e=new Pt({props:{$$slots:{default:[de]},$$scope:{ctx:t}}});let i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=pe(le(t,i,e));return{c(){gt(e.$$.fragment),n=N(),r=C("div");for(let t=0;t<s.length;t+=1)s[t].c();P(r,"class","chapters svelte-1ytkh6y")},m(t,i){mt(e,t,i),T(t,n,i),T(t,r,i);for(let t=0;t<s.length;t+=1)s[t].m(r,null);o=!0},p(t,n){const o={};if(2048&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),2&n){let e;for(i=t[1],e=0;e<i.length;e+=1){const o=le(t,i,e);s[e]?s[e].p(o,n):(s[e]=pe(o),s[e].c(),s[e].m(r,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){o||(lt(e.$$.fragment,t),o=!0)},o(t){ct(e.$$.fragment,t),o=!1},d(t){bt(e,t),t&&S(n),t&&S(r),D(s,t)}}}function de(t){let e;return{c(){e=O("Please wait, fetching chapters...")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function fe(t){let e,n,r=t[6].title+"";return{c(){e=C("p"),n=O(r),P(e,"class","valid small svelte-1ytkh6y")},m(t,r){T(t,e,r),x(e,n)},p(t,e){2&e&&r!==(r=t[6].title+"")&&R(n,r)},d(t){t&&S(e)}}}function pe(t){let e,n=t[6]&&fe(t);return{c(){n&&n.c(),e=L()},m(t,r){n&&n.m(t,r),T(t,e,r)},p(t,r){t[6]?n?n.p(t,r):(n=fe(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&S(e)}}}function he(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:ue,then:ae,catch:ce,value:9,error:10,blocks:[,,,]};return at(n=t[2],o),{c(){e=L(),o.block.c()},m(t,n){T(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&at(n,o)||ut(o,t,r)},i(t){r||(lt(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)ct(o.blocks[t]);r=!1},d(t){t&&S(e),o.block.d(t),o.token=null,o=null}}}function ge(t,e,n){let r,{data:o}=e,{goNext:i}=e;const s=async()=>{n(1,r=new Array(o.chapters.length));for(let t=0;t<o.chapters.length;t+=100)await Promise.all(o.chapters.slice(t,t+100).map(((e,o)=>!1!==e.needsFetching?Kt(e.apiUrl).then((t=>t.json())).then((e=>{n(1,r[o+t]=oe(e),r),n(1,r)})):void n(1,r[o+t]=Object.assign({},e),r))));return Object.assign(Object.assign({},o),{chapters:r})};let l=s();return t.$$set=t=>{"data"in t&&n(4,o=t.data),"goNext"in t&&n(0,i=t.goNext)},[i,r,l,s,o,()=>n(2,l=s())]}const me=class extends $t{constructor(t){super(),yt(this,t,ge,he,c,{data:4,goNext:0})}};function be(t,e,n){const r=t.slice();return r[7]=e[n],r}function ye(t){let e,n;return e=new Lt({props:{error:t[11],retry:t[5]}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[11]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function $e(e){let n,r=e[0](e[10],e[1].length)+"";return{c(){n=O(r)},m(t,e){T(t,n,e)},p(t,e){7&e&&r!==(r=t[0](t[10],t[1].length)+"")&&R(n,r)},i:t,o:t,d(t){t&&S(n)}}}function ve(t){let e,n,r,o;e=new Pt({props:{$$slots:{default:[we]},$$scope:{ctx:t}}});let i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=xe(be(t,i,e));return{c(){gt(e.$$.fragment),n=N(),r=C("div");for(let t=0;t<s.length;t+=1)s[t].c();P(r,"class","chapters")},m(t,i){mt(e,t,i),T(t,n,i),T(t,r,i);for(let t=0;t<s.length;t+=1)s[t].m(r,null);o=!0},p(t,n){const o={};if(4096&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),2&n){let e;for(i=t[1],e=0;e<i.length;e+=1){const o=be(t,i,e);s[e]?s[e].p(o,n):(s[e]=xe(o),s[e].c(),s[e].m(r,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}},i(t){o||(lt(e.$$.fragment,t),o=!0)},o(t){ct(e.$$.fragment,t),o=!1},d(t){bt(e,t),t&&S(n),t&&S(r),D(s,t)}}}function we(t){let e;return{c(){e=O("Please wait, fetching chapters...")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function xe(t){let e,n,r,o,i,s,l=t[7].from+"",c=t[7].url+"";return{c(){e=C("p"),n=O(l),r=O(": Extracted "),o=C("a"),i=O(c),P(o,"href",s=t[7].url),P(e,"class","valid small svelte-188oh31")},m(t,s){T(t,e,s),x(e,n),x(e,r),x(e,o),x(o,i)},p(t,e){2&e&&l!==(l=t[7].from+"")&&R(n,l),2&e&&c!==(c=t[7].url+"")&&R(i,c),2&e&&s!==(s=t[7].url)&&P(o,"href",s)},d(t){t&&S(e)}}}function ke(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:ve,then:$e,catch:ye,value:10,error:11,blocks:[,,,]};return at(n=t[2],o),{c(){e=L(),o.block.c()},m(t,n){T(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&at(n,o)||ut(o,t,r)},i(t){r||(lt(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)ct(o.blocks[t]);r=!1},d(t){t&&S(e),o.block.d(t),o.token=null,o=null}}}function Ee(t,e,n){let r,{bookData:o}=e,{goNext:i}=e,s=[];const l=async()=>{for(r=o.chapters.map((t=>Object.assign({},t)));;){let t=r[r.length-1];if(!1!==t.needsFetching){const e=await Kt(t.apiUrl),n=await e.json();if(!e.ok)throw n.message;r.splice(-1,1,t=oe(n))}const e=se(t.content);if(!e)break;const o=vt(e);if(r.find((t=>t.apiUrl===o)))break;s.push({from:t.title,url:e}),n(1,s);const i=await Kt(o),l=await i.json();if(!i.ok)throw l.message;r.push(oe(l))}return Object.assign(Object.assign({},o),{chapters:r})};let c=l();return t.$$set=t=>{"bookData"in t&&n(4,o=t.bookData),"goNext"in t&&n(0,i=t.goNext)},[i,s,c,l,o,()=>n(2,c=l())]}const Te=class extends $t{constructor(t){super(),yt(this,t,Ee,ke,c,{bookData:4,goNext:0})}};function Se(t,e,n){t.dispatchEvent(new CustomEvent("finalize",{detail:{items:e,info:n}}))}function De(t,e,n){t.dispatchEvent(new CustomEvent("consider",{detail:{items:e,info:n}}))}const Ce="draggedEntered",Ae="draggedLeft",Oe="draggedOverIndex",Ne="draggedLeftDocument",Le="leftForAnother",_e="outsideOfAny";function Me(t,e,n){t.dispatchEvent(new CustomEvent(Ce,{detail:{indexObj:e,draggedEl:n}}))}function Pe(t,e,n){t.dispatchEvent(new CustomEvent(Ae,{detail:{draggedEl:e,type:Le,theOtherDz:n}}))}function Re(t,e,n){t.dispatchEvent(new CustomEvent(Oe,{detail:{indexObj:e,draggedEl:n}}))}const je="dragStarted",Fe="droppedIntoZone",Ie="droppedIntoAnother",He="pointer",Be="keyboard",Ue="data-is-dnd-shadow-item",ze="id:dnd-shadow-placeholder-0000";let We="id",qe=0;function Ye(){qe++}function Ve(){if(0===qe)throw new Error("Bug! trying to decrement when there are no dropzones");qe--}const Xe="undefined"==typeof window;let Ge;function Ze(t){let e;const n=t.getBoundingClientRect(),r=getComputedStyle(t),o=r.transform;if(o){let i,s,l,c;if(o.startsWith("matrix3d("))e=o.slice(9,-1).split(/, /),i=+e[0],s=+e[5],l=+e[12],c=+e[13];else{if(!o.startsWith("matrix("))return n;e=o.slice(7,-1).split(/, /),i=+e[0],s=+e[3],l=+e[4],c=+e[5]}const a=r.transformOrigin,u=n.x-l-(1-i)*parseFloat(a),d=n.y-c-(1-s)*parseFloat(a.slice(a.indexOf(" ")+1)),f=i?n.width/i:t.offsetWidth,p=s?n.height/s:t.offsetHeight;return{x:u,y:d,width:f,height:p,top:d,right:u+f,bottom:d+p,left:u}}return n}function Ke(t){const e=Ze(t);return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function Je(t){const e=t.getBoundingClientRect();return{top:e.top+window.scrollY,bottom:e.bottom+window.scrollY,left:e.left+window.scrollX,right:e.right+window.scrollX}}function Qe(t){return{x:(t.left+t.right)/2,y:(t.top+t.bottom)/2}}function tn(t,e){return t.y<=e.bottom&&t.y>=e.top&&t.x>=e.left&&t.x<=e.right}function en(t){return Qe(Je(t))}function nn(t,e){return tn(en(t),Ke(e))}function rn(){Ge=new Map}function on(t){Ge.delete(t)}function sn(t,e){if(!nn(t,e))return null;const n=e.children;if(0===n.length)return{index:0,isProximityBased:!0};const r=function(t){const e=Array.from(t.children).findIndex((t=>t.getAttribute(Ue)));if(e>=0)return Ge.has(t)||Ge.set(t,new Map),Ge.get(t).set(e,Ke(t.children[e])),e}(e);for(let o=0;o<n.length;o++)if(nn(t,n[o])){const n=Ge.has(e)&&Ge.get(e).get(o);return n&&!tn(en(t),n)?{index:r,isProximityBased:!1}:{index:o,isProximityBased:!1}}let o,i=Number.MAX_VALUE;for(let e=0;e<n.length;e++){const r=(s=t,l=n[e],c=void 0,a=void 0,c=en(s),a=en(l),Math.sqrt(Math.pow(c.x-a.x,2)+Math.pow(c.y-a.y,2)));r<i&&(i=r,o=e)}var s,l,c,a;return{index:o,isProximityBased:!0}}function ln(){let t;function e(){t={directionObj:void 0,stepPx:0}}function n(e){const{directionObj:r,stepPx:o}=t;r&&(e.scrollBy(r.x*o,r.y*o),window.requestAnimationFrame((()=>n(e))))}function r(t){return 25-t}return e(),{scrollIfNeeded:function(o,i){if(!i)return!1;const s=function(t,e){const n=Je(e);return tn(t,n)?{top:t.y-n.top,bottom:n.bottom-t.y,left:t.x-n.left,right:Math.min(n.right,document.documentElement.clientWidth)-t.x}:null}(o,i);if(null===s)return e(),!1;const l=!!t.directionObj;let[c,a]=[!1,!1];return i.scrollHeight>i.clientHeight&&(s.bottom<25?(c=!0,t.directionObj={x:0,y:1},t.stepPx=r(s.bottom)):s.top<25&&(c=!0,t.directionObj={x:0,y:-1},t.stepPx=r(s.top)),!l&&c)||i.scrollWidth>i.clientWidth&&(s.right<25?(a=!0,t.directionObj={x:1,y:0},t.stepPx=r(s.right)):s.left<25&&(a=!0,t.directionObj={x:-1,y:0},t.stepPx=r(s.left)),!l&&a)?(n(i),!0):(e(),!1)},resetScrolling:e}}function cn(t){return JSON.stringify(t,null,2)}function an(t){if(!t)throw new Error("cannot get depth of a falsy node");return un(t,0)}function un(t,e=0){return t.parentElement?un(t.parentElement,e+1):e-1}rn();const{scrollIfNeeded:dn,resetScrolling:fn}=ln();let pn,hn;function gn(t){const e=t.touches?t.touches[0]:t;hn={x:e.clientX,y:e.clientY}}const{scrollIfNeeded:mn,resetScrolling:bn}=ln();let yn;function $n(){hn&&mn(hn,document.documentElement)&&rn(),yn=window.setTimeout($n,300)}function vn(t){return`${t} 0.2s ease`}function wn(t,e,n,r,o){const i=e.getBoundingClientRect(),s=t.getBoundingClientRect(),l=i.width-s.width,c=i.height-s.height;if(l||c){const e={left:(n-s.left)/s.width,top:(r-s.top)/s.height};t.style.height=`${i.height}px`,t.style.width=`${i.width}px`,t.style.left=parseFloat(t.style.left)-e.left*l+"px",t.style.top=parseFloat(t.style.top)-e.top*c+"px"}xn(e,t),o()}function xn(t,e){const n=window.getComputedStyle(t);Array.from(n).filter((t=>t.startsWith("background")||t.startsWith("padding")||t.startsWith("font")||t.startsWith("text")||t.startsWith("align")||t.startsWith("justify")||t.startsWith("display")||t.startsWith("flex")||t.startsWith("border")||"opacity"===t||"color"===t||"list-style-type"===t)).forEach((t=>e.style.setProperty(t,n.getPropertyValue(t),n.getPropertyPriority(t))))}function kn(t,e){t.draggable=!1,t.ondragstart=()=>!1,e?(t.style.userSelect="",t.style.WebkitUserSelect="",t.style.cursor=""):(t.style.userSelect="none",t.style.WebkitUserSelect="none",t.style.cursor="grab")}function En(t){t.style.display="none",t.style.position="fixed",t.style.zIndex="-5"}function Tn(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const r=e(t);Object.keys(r).forEach((e=>{t.style[e]=r[e]})),n(t).forEach((e=>t.classList.add(e)))}))}function Sn(t,e=(()=>{}),n=(()=>[])){t.forEach((t=>{const r=e(t);Object.keys(r).forEach((e=>{t.style[e]=""})),n(t).forEach((e=>t.classList.contains(e)&&t.classList.remove(e)))}))}const Dn={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let Cn,An,On,Nn,Ln,_n,Mn,Pn,Rn,jn,Fn,In=!1,Hn=!1,Bn=!1,Un=[];const zn=new Map,Wn=new Map,qn=new WeakMap;function Yn(t,e){zn.get(e).delete(t),Ve(),0===zn.get(e).size&&zn.delete(e)}function Vn(){window.addEventListener("mousemove",gn),window.addEventListener("touchmove",gn),$n();const t=zn.get(Nn);for(const e of t)e.addEventListener(Ce,Gn),e.addEventListener(Ae,Zn),e.addEventListener(Oe,Kn);window.addEventListener(Ne,Qn);const e=Math.max(100,...Array.from(t.keys()).map((t=>Wn.get(t).dropAnimationDurationMs)));!function(t,e,n=200){let r,o,i,s=!1;const l=Array.from(e).sort(((t,e)=>an(e)-an(t)));!function e(){const c=en(t),a=dn(c,r);if(!a&&i&&Math.abs(i.x-c.x)<10&&Math.abs(i.y-c.y)<10)return void(pn=window.setTimeout(e,n));if(function(t){const e=Je(t);return e.right<0||e.left>document.documentElement.scrollWidth||e.bottom<0||e.top>document.documentElement.scrollHeight}(t))return void function(t){window.dispatchEvent(new CustomEvent(Ne,{detail:{draggedEl:t}}))}(t);i=c;let u=!1;for(const e of l){a&&on(r);const n=sn(t,e);if(null===n)continue;const{index:i}=n;u=!0,e!==r?(r&&Pe(r,t,e),Me(e,n,t),r=e):i!==o&&(Re(e,n,t),o=i);break}!u&&s&&r?(function(t,e){t.dispatchEvent(new CustomEvent(Ae,{detail:{draggedEl:e,type:_e}}))}(r,t),r=void 0,o=void 0,s=!1):s=!0,pn=window.setTimeout(e,n)}()}(An,t,1.07*e)}function Xn(t){return t.findIndex((t=>!!t.isDndShadowItem&&t.id!==ze))}function Gn(t){let{items:e,dropFromOthersDisabled:n}=Wn.get(t.currentTarget);if(n&&t.currentTarget!==Ln)return;if(Bn=!1,e=e.filter((t=>t.id!==Mn.id)),Ln!==t.currentTarget){const t=Wn.get(Ln).items.filter((t=>!t.isDndShadowItem));De(Ln,t,{trigger:"dragEnteredAnother",id:On.id,source:He})}else{const t=function(t){return t.findIndex((t=>t.id===ze))}(e);-1!==t&&e.splice(t,1)}const{index:r,isProximityBased:o}=t.detail.indexObj,i=o&&r===t.currentTarget.children.length-1?r+1:r;Pn=t.currentTarget,e.splice(i,0,Mn),De(t.currentTarget,e,{trigger:"draggedEntered",id:On.id,source:He})}function Zn(t){if(!In)return;const{items:e,dropFromOthersDisabled:n}=Wn.get(t.currentTarget);if(n&&t.currentTarget!==Ln&&t.currentTarget!==Pn)return;const r=Xn(e),o=e.splice(r,1)[0];Pn=void 0;const{type:i,theOtherDz:s}=t.detail;if(i===_e||i===Le&&s!==Ln&&Wn.get(s).dropFromOthersDisabled){Bn=!0,Pn=Ln;const t=Wn.get(Ln).items;t.splice(_n,0,o),De(Ln,t,{trigger:"draggedLeftAll",id:On.id,source:He})}De(t.currentTarget,e,{trigger:"draggedLeft",id:On.id,source:He})}function Kn(t){const{items:e,dropFromOthersDisabled:n}=Wn.get(t.currentTarget);if(n&&t.currentTarget!==Ln)return;Bn=!1;const{index:r}=t.detail.indexObj,o=Xn(e);e.splice(o,1),e.splice(r,0,Mn),De(t.currentTarget,e,{trigger:"draggedOverIndex",id:On.id,source:He})}function Jn(t){t.preventDefault();const e=t.touches?t.touches[0]:t;jn={x:e.clientX,y:e.clientY},An.style.transform=`translate3d(${jn.x-Rn.x}px, ${jn.y-Rn.y}px, 0)`}function Qn(){Hn=!0,window.removeEventListener("mousemove",Jn),window.removeEventListener("touchmove",Jn),window.removeEventListener("mouseup",Qn),window.removeEventListener("touchend",Qn),function(){window.removeEventListener("mousemove",gn),window.removeEventListener("touchmove",gn),hn=void 0,window.clearTimeout(yn),bn();const t=zn.get(Nn);for(const e of t)e.removeEventListener(Ce,Gn),e.removeEventListener(Ae,Zn),e.removeEventListener(Oe,Kn);window.removeEventListener(Ne,Qn),clearTimeout(pn),fn(),rn()}(),function(t){t.style.cursor="grab"}(An),Pn||(Pn=Ln);let{items:t,type:e}=Wn.get(Pn);Sn(zn.get(e),(t=>Wn.get(t).dropTargetStyle),(t=>Wn.get(t).dropTargetClasses));let n=Xn(t);-1===n&&(n=_n),t=t.map((t=>t.isDndShadowItem?On:t)),function(t,e){const n=Ze(Pn.children[t]),r=n.left-parseFloat(An.style.left),o=n.top-parseFloat(An.style.top),{dropAnimationDurationMs:i}=Wn.get(Pn),s=`transform ${i}ms ease`;An.style.transition=An.style.transition?An.style.transition+","+s:s,An.style.transform=`translate3d(${r}px, ${o}px, 0)`,window.setTimeout(e,i)}(n,(function(){var e;Fn(),Se(Pn,t,{trigger:Bn?"droppedOutsideOfAny":Fe,id:On.id,source:He}),Pn!==Ln&&Se(Ln,Wn.get(Ln).items,{trigger:Ie,id:On.id,source:He}),(e=Pn.children[n]).style.visibility="",e.removeAttribute(Ue),An.remove(),Cn.remove(),Un.length&&(Un.forEach((({dz:t,destroy:e})=>{e(),t.remove()})),Un=[]),An=void 0,Cn=void 0,On=void 0,Nn=void 0,Ln=void 0,_n=void 0,Mn=void 0,Pn=void 0,Rn=void 0,jn=void 0,In=!1,Hn=!1,Fn=void 0,Bn=!1}))}const tr={DND_ZONE_ACTIVE:"dnd-zone-active",DND_ZONE_DRAG_DISABLED:"dnd-zone-drag-disabled"},er={[tr.DND_ZONE_ACTIVE]:"Tab to one the items and press space-bar or enter to start dragging it",[tr.DND_ZONE_DRAG_DISABLED]:"This is a disabled drag and drop list"};let nr;function rr(){nr||(nr=document.createElement("div"),nr.id="dnd-action-aria-alert",nr.style.position="fixed",nr.style.bottom="0",nr.style.left="0",nr.style.zIndex="-5",nr.style.opacity="0",nr.style.height="0",nr.style.width="0",nr.setAttribute("role","alert"),document.body.prepend(nr),Object.entries(er).forEach((([t,e])=>document.body.prepend(function(t,e){const n=document.createElement("div");return n.id=t,n.innerHTML=`<p>${e}</p>`,n.style.display="none",n.style.position="fixed",n.style.zIndex="-5",n}(t,e)))))}function or(t){if(Xe)return;nr||rr(),nr.innerHTML="";const e=document.createTextNode(t);nr.appendChild(e),nr.style.display="none",nr.style.display="inline"}const ir={outline:"rgba(255, 255, 102, 0.7) solid 2px"};let sr,lr,cr,ar,ur=!1,dr="",fr="";const pr=new WeakSet,hr=new WeakMap,gr=new WeakMap,mr=new Map,br=new Map,yr=new Map;let $r;function vr(t,e){lr===t&&Tr(),yr.get(e).delete(t),Ve(),0===yr.get(e).size&&yr.delete(e),0===yr.size&&(window.removeEventListener("keydown",wr),window.removeEventListener("click",xr),$r=void 0,!Xe&&nr&&(Object.keys(er).forEach((t=>document.getElementById(t)?.remove())),nr.remove(),nr=void 0))}function wr(t){ur&&"Escape"===t.key&&Tr()}function xr(){ur&&(pr.has(document.activeElement)||Tr())}function kr(t){if(!ur)return;const e=t.currentTarget;if(e===lr)return;dr=e.getAttribute("aria-label")||"";const{items:n}=br.get(lr),r=n.find((t=>t.id===ar)),o=n.indexOf(r),i=n.splice(o,1)[0],{items:s,autoAriaDisabled:l}=br.get(e);e.getBoundingClientRect().top<lr.getBoundingClientRect().top||e.getBoundingClientRect().left<lr.getBoundingClientRect().left?(s.push(i),l||or(`Moved item ${fr} to the end of the list ${dr}`)):(s.unshift(i),l||or(`Moved item ${fr} to the beginning of the list ${dr}`)),Se(lr,n,{trigger:Ie,id:ar,source:Be}),Se(e,s,{trigger:Fe,id:ar,source:Be}),lr=e}function Er(){mr.forEach((({update:t},e)=>t(br.get(e))))}function Tr(t=!0){br.get(lr).autoAriaDisabled||or(`Stopped dragging item ${fr}`),pr.has(document.activeElement)&&document.activeElement.blur(),t&&De(lr,br.get(lr).items,{trigger:"dragStopped",id:ar,source:Be}),Sn(yr.get(sr),(t=>br.get(t).dropTargetStyle),(t=>br.get(t).dropTargetClasses)),cr=null,ar=null,fr="",sr=null,lr=null,dr="",ur=!1,Er()}function Sr(t,e){const n={items:void 0,type:void 0,dragDisabled:!1,zoneTabIndex:0,dropFromOthersDisabled:!1,dropTargetStyle:ir,dropTargetClasses:[],autoAriaDisabled:!1};function r(t,e,n){t.length<=1||t.splice(n,1,t.splice(e,1,t[n])[0])}function o(e){switch(e.key){case"Enter":case" ":if((void 0!==e.target.disabled||e.target.href||e.target.isContentEditable)&&!pr.has(e.target))return;e.preventDefault(),e.stopPropagation(),ur?Tr():i(e);break;case"ArrowDown":case"ArrowRight":{if(!ur)return;e.preventDefault(),e.stopPropagation();const{items:o}=br.get(t),i=Array.from(t.children),s=i.indexOf(e.currentTarget);s<i.length-1&&(n.autoAriaDisabled||or(`Moved item ${fr} to position ${s+2} in the list ${dr}`),r(o,s,s+1),Se(t,o,{trigger:Fe,id:ar,source:Be}));break}case"ArrowUp":case"ArrowLeft":{if(!ur)return;e.preventDefault(),e.stopPropagation();const{items:o}=br.get(t),i=Array.from(t.children).indexOf(e.currentTarget);i>0&&(n.autoAriaDisabled||or(`Moved item ${fr} to position ${i} in the list ${dr}`),r(o,i,i-1),Se(t,o,{trigger:Fe,id:ar,source:Be}));break}}}function i(e){(function(e){const{items:n}=br.get(t),r=Array.from(t.children),o=r.indexOf(e);cr=e,cr.tabIndex=0,ar=n[o].id,fr=r[o].getAttribute("aria-label")||""})(e.currentTarget),lr=t,sr=n.type,ur=!0;const r=Array.from(yr.get(n.type)).filter((t=>t===lr||!br.get(t).dropFromOthersDisabled));if(Tn(r,(t=>br.get(t).dropTargetStyle),(t=>br.get(t).dropTargetClasses)),!n.autoAriaDisabled){let t=`Started dragging item ${fr}. Use the arrow keys to move it within its list ${dr}`;r.length>1&&(t+=", or tab to another list in order to move the item into it"),or(t)}De(t,br.get(t).items,{trigger:je,id:ar,source:Be}),Er()}function s(t){ur&&t.currentTarget!==cr&&(t.stopPropagation(),Tr(!1),i(t))}function l({items:e=[],type:r="--any--",dragDisabled:i=!1,zoneTabIndex:l=0,dropFromOthersDisabled:c=!1,dropTargetStyle:a=ir,dropTargetClasses:u=[],autoAriaDisabled:d=!1}){var f,p;n.items=[...e],n.dragDisabled=i,n.dropFromOthersDisabled=c,n.zoneTabIndex=l,n.dropTargetStyle=a,n.dropTargetClasses=u,n.autoAriaDisabled=d,n.type&&r!==n.type&&vr(t,n.type),n.type=r,f=t,p=r,0===yr.size&&($r=Xe?null:("complete"===document.readyState?rr():window.addEventListener("DOMContentLoaded",rr),{...tr}),window.addEventListener("keydown",wr),window.addEventListener("click",xr)),yr.has(p)||yr.set(p,new Set),yr.get(p).has(f)||(yr.get(p).add(f),Ye()),d||(t.setAttribute("aria-disabled",i),t.setAttribute("role","list"),t.setAttribute("aria-describedby",i?$r.DND_ZONE_DRAG_DISABLED:$r.DND_ZONE_ACTIVE)),br.set(t,n),t.tabIndex=ur?t===lr||cr.contains(t)||n.dropFromOthersDisabled||lr&&n.type!==br.get(lr).type?-1:0:n.zoneTabIndex,t.addEventListener("focus",kr);for(let e=0;e<t.children.length;e++){const r=t.children[e];pr.add(r),r.tabIndex=ur?-1:0,d||r.setAttribute("role","listitem"),r.removeEventListener("keydown",hr.get(r)),r.removeEventListener("click",gr.get(r)),i||(r.addEventListener("keydown",o),hr.set(r,o),r.addEventListener("click",s),gr.set(r,s)),ur&&n.items[e].id===ar&&(cr=r,cr.tabIndex=0,r.focus())}}l(e);const c={update:t=>{l(t)},destroy:()=>{vr(t,n.type),br.delete(t),mr.delete(t)}};return mr.set(t,c),c}function Dr(t,e){Cr(e);const n=function(t,e){let n=!1;const r={items:void 0,type:void 0,flipDurationMs:0,dragDisabled:!1,morphDisabled:!1,dropFromOthersDisabled:!1,dropTargetStyle:Dn,dropTargetClasses:[],transformDraggedElement:()=>{},centreDraggedOnCursor:!1};let o=new Map;function i(){window.removeEventListener("mousemove",l),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",s),window.removeEventListener("touchend",s)}function s(){i(),Cn=void 0,Rn=void 0,jn=void 0}function l(t){t.preventDefault();const e=t.touches?t.touches[0]:t;jn={x:e.clientX,y:e.clientY},(Math.abs(jn.x-Rn.x)>=3||Math.abs(jn.y-Rn.y)>=3)&&(i(),function(){In=!0;const t=o.get(Cn);_n=t,Ln=Cn.parentElement;const e=Ln.getRootNode(),n=e.body||e,{items:i,type:s,centreDraggedOnCursor:l}=r;On={...i[t]},Nn=s,Mn={...On,isDndShadowItem:!0};const c={...Mn,[We]:ze};An=function(t,e){const n=t.getBoundingClientRect(),r=function(t){const e=t.cloneNode(!0),n=[],r="SELECT"===t.tagName,o=r?[t]:[...t.querySelectorAll("select")];for(const t of o)n.push(t.value);if(o.length<=0)return e;const i=r?[e]:[...e.querySelectorAll("select")];for(let t=0;t<i.length;t++){const e=i[t],r=n[t],o=e.querySelector(`option[value="${r}"`);o&&o.setAttribute("selected",!0)}return e}(t);xn(t,r),r.id="dnd-action-dragged-el",r.style.position="fixed";let o=n.top,i=n.left;if(r.style.top=`${o}px`,r.style.left=`${i}px`,e){const t=Qe(n);o-=t.y-e.y,i-=t.x-e.x,window.setTimeout((()=>{r.style.top=`${o}px`,r.style.left=`${i}px`}),0)}return r.style.margin="0",r.style.boxSizing="border-box",r.style.height=`${n.height}px`,r.style.width=`${n.width}px`,r.style.transition=`${vn("top")}, ${vn("left")}, ${vn("background-color")}, ${vn("opacity")}, ${vn("color")} `,window.setTimeout((()=>r.style.transition+=`, ${vn("width")}, ${vn("height")}`),0),r.style.zIndex="9999",r.style.cursor="grabbing",r}(Cn,l&&jn),window.requestAnimationFrame((function t(){An.parentElement?window.requestAnimationFrame(t):(n.appendChild(An),An.focus(),Vn(),En(Cn),n.appendChild(Cn))})),Tn(Array.from(zn.get(r.type)).filter((t=>t===Ln||!Wn.get(t).dropFromOthersDisabled)),(t=>Wn.get(t).dropTargetStyle),(t=>Wn.get(t).dropTargetClasses)),i.splice(t,1,c),Fn=function(t){const e=t.style.minHeight;t.style.minHeight=window.getComputedStyle(t).getPropertyValue("height");const n=t.style.minWidth;return t.style.minWidth=window.getComputedStyle(t).getPropertyValue("width"),function(){t.style.minHeight=e,t.style.minWidth=n}}(Ln),De(Ln,i,{trigger:je,id:On.id,source:He}),window.addEventListener("mousemove",Jn,{passive:!1}),window.addEventListener("touchmove",Jn,{passive:!1,capture:!1}),window.addEventListener("mouseup",Qn,{passive:!1}),window.addEventListener("touchend",Qn,{passive:!1})}())}function c(t){if(t.target!==t.currentTarget&&(void 0!==t.target.value||t.target.isContentEditable))return;if(t.button)return;if(In)return;t.stopPropagation();const e=t.touches?t.touches[0]:t;Rn={x:e.clientX,y:e.clientY},jn={...Rn},Cn=t.currentTarget,window.addEventListener("mousemove",l,{passive:!1}),window.addEventListener("touchmove",l,{passive:!1,capture:!1}),window.addEventListener("mouseup",s,{passive:!1}),window.addEventListener("touchend",s,{passive:!1})}function a({items:e,flipDurationMs:i=0,type:s="--any--",dragDisabled:l=!1,morphDisabled:a=!1,dropFromOthersDisabled:u=!1,dropTargetStyle:d=Dn,dropTargetClasses:f=[],transformDraggedElement:p=(()=>{}),centreDraggedOnCursor:h=!1}){var g,m;function b(t,e){return Wn.get(t)?Wn.get(t)[e]:r[e]}r.dropAnimationDurationMs=i,r.type&&s!==r.type&&Yn(t,r.type),r.type=s,g=t,m=s,zn.has(m)||zn.set(m,new Set),zn.get(m).has(g)||(zn.get(m).add(g),Ye()),r.items=[...e],r.dragDisabled=l,r.morphDisabled=a,r.transformDraggedElement=p,r.centreDraggedOnCursor=h,!n||!In||Hn||function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!{}.hasOwnProperty.call(e,n)||e[n]!==t[n])return!1;return!0}(d,r.dropTargetStyle)&&function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(f,r.dropTargetClasses)||(Sn([t],(()=>r.dropTargetStyle),(()=>f)),Tn([t],(()=>d),(()=>f))),r.dropTargetStyle=d,r.dropTargetClasses=[...f],n&&In&&r.dropFromOthersDisabled!==u&&(u?Sn([t],(t=>b(t,"dropTargetStyle")),(t=>b(t,"dropTargetClasses"))):Tn([t],(t=>b(t,"dropTargetStyle")),(t=>b(t,"dropTargetClasses")))),r.dropFromOthersDisabled=u,Wn.set(t,r);const y=Xn(r.items);for(let e=0;e<t.children.length;e++){const i=t.children[e];kn(i,l),e!==y?(i.removeEventListener("mousedown",qn.get(i)),i.removeEventListener("touchstart",qn.get(i)),l||(i.addEventListener("mousedown",c),i.addEventListener("touchstart",c),qn.set(i,c)),o.set(i,e),n||(n=!0)):(a||wn(An,i,jn.x,jn.y,(()=>r.transformDraggedElement(An,On,e))),($=i).style.visibility="hidden",$.setAttribute(Ue,"true"))}var $}return a(e),{update:t=>{a(t)},destroy:()=>{function e(){Yn(t,Wn.get(t).type),Wn.delete(t)}var n,r;In?(n=t,r=e,Un.push({dz:n,destroy:r}),window.requestAnimationFrame((()=>{En(n),document.body.appendChild(n)}))):e()}}}(t,e),r=Sr(t,e);return{update:t=>{Cr(t),n.update(t),r.update(t)},destroy:()=>{n.destroy(),r.destroy()}}}function Cr(t){const{items:e,flipDurationMs:n,type:r,dragDisabled:o,morphDisabled:i,dropFromOthersDisabled:s,zoneTabIndex:l,dropTargetStyle:c,dropTargetClasses:a,transformDraggedElement:u,autoAriaDisabled:d,centreDraggedOnCursor:f,...p}=t;if(Object.keys(p).length>0&&console.warn("dndzone will ignore unknown options",p),!e)throw new Error("no 'items' key provided to dndzone");const h=e.find((t=>!{}.hasOwnProperty.call(t,We)));if(h)throw new Error(`missing 'id' property for item ${cn(h)}`);if(a&&!Array.isArray(a))throw new Error(`dropTargetClasses should be an array but instead it is a ${typeof a}, ${cn(a)}`);if(l&&(g=l,isNaN(g)||(0|(m=parseFloat(g)))!==m))throw new Error(`zoneTabIndex should be a number but instead it is a ${typeof l}, ${cn(l)}`);var g,m}function Ar(t){const e=t-1;return e*e*e+1}function Or(t,{from:e,to:n},r={}){const o=getComputedStyle(t),i="none"===o.transform?"":o.transform,[l,c]=o.transformOrigin.split(" ").map(parseFloat),a=e.left+e.width*l/n.width-(n.left+l),u=e.top+e.height*c/n.height-(n.top+c),{delay:d=0,duration:f=(t=>120*Math.sqrt(t)),easing:p=Ar}=r;return{delay:d,duration:s(f)?f(Math.sqrt(a*a+u*u)):f,easing:p,css:(t,r)=>{const o=r*a,s=r*u,l=t+r*e.width/n.width,c=t+r*e.height/n.height;return`transform: ${i} translate(${o}px, ${s}px) scale(${l}, ${c});`}}}function Nr(e){let n,r,o,i,s,l,c,a=xt(e[0]||"")+"";return{c(){n=C("div"),r=C("div"),o=C("span"),i=O(e[1]),s=N(),l=C("span"),c=O(a),P(o,"class","title svelte-8fzq48"),P(o,"aria-label","Title"),P(l,"class","content svelte-8fzq48"),P(r,"class","preview svelte-8fzq48"),P(n,"class","chapter svelte-8fzq48"),P(n,"tabindex","0"),P(n,"title",e[1])},m(t,e){T(t,n,e),x(n,r),x(r,o),x(o,i),x(r,s),x(r,l),x(l,c)},p(t,[e]){2&e&&R(i,t[1]),1&e&&a!==(a=xt(t[0]||"")+"")&&R(c,a),2&e&&P(n,"title",t[1])},i:t,o:t,d(t){t&&S(n)}}}function Lr(t,e,n){let{title:r}=e,{content:o}=e;return o=null!=o?o:"",t.$$set=t=>{"title"in t&&n(1,r=t.title),"content"in t&&n(0,o=t.content)},[o,r]}const _r=class extends $t{constructor(t){super(),yt(this,t,Lr,Nr,c,{title:1,content:0})}};function Mr(t){let e,n,r;return{c(){e=C("span"),P(e,"class","edit svelte-i66bba"),P(e,"contenteditable",""),void 0===t[0]&&Z((()=>t[8].call(e)))},m(o,i){T(o,e,i),void 0!==t[0]&&(e.innerHTML=t[0]),n||(r=_(e,"input",t[8]),n=!0)},p(t,n){1&n&&t[0]!==e.innerHTML&&(e.innerHTML=t[0])},d(t){t&&S(e),n=!1,r()}}}function Pr(t){let e,n,r,o=xt(t[0])+"";return{c(){e=C("a"),n=O(o),P(e,"href",r=wt(t[3])),P(e,"target","_blank")},m(t,r){T(t,e,r),x(e,n)},p(t,i){1&i&&o!==(o=xt(t[0])+"")&&R(n,o),8&i&&r!==(r=wt(t[3]))&&P(e,"href",r)},d(t){t&&S(e)}}}function Rr(t){let e,n,r;return{c(){e=C("span"),P(e,"class","edit svelte-i66bba"),P(e,"contenteditable",""),void 0===t[1]&&Z((()=>t[9].call(e)))},m(o,i){T(o,e,i),void 0!==t[1]&&(e.innerHTML=t[1]),n||(r=_(e,"input",t[9]),n=!0)},p(t,n){2&n&&t[1]!==e.innerHTML&&(e.innerHTML=t[1])},d(t){t&&S(e),n=!1,r()}}}function jr(t){let e,n=xt(t[1])+"";return{c(){e=O(n)},m(t,n){T(t,e,n)},p(t,r){2&r&&n!==(n=xt(t[1])+"")&&R(e,n)},d(t){t&&S(e)}}}function Fr(t){let e,n,r,o;const i=t[7].default,s=d(i,t,t[6],null);return{c(){e=C("h3"),e.textContent="Chapters",n=N(),r=C("div"),s&&s.c(),P(e,"class","svelte-i66bba"),P(r,"class","svelte-i66bba")},m(t,i){T(t,e,i),T(t,n,i),T(t,r,i),s&&s.m(r,null),o=!0},p(t,e){s&&s.p&&(!o||64&e)&&h(s,i,t,t[6],o?p(i,t[6],e,null):g(t[6]),null)},i(t){o||(lt(s,t),o=!0)},o(t){ct(s,t),o=!1},d(t){t&&S(e),t&&S(n),t&&S(r),s&&s.d(t)}}}function Ir(t){let e,n,r,o,i,l,c,a,u,d,f,p;function h(t,e){return t[2]?Mr:Pr}let g=h(t),m=g(t);function b(t,e){return t[2]?Rr:jr}let y=b(t),$=y(t),v=t[5].default&&Fr(t);return{c(){e=C("form"),n=C("h3"),n.textContent="Title",r=N(),o=C("p"),m.c(),i=N(),l=C("h3"),l.textContent="Author",c=N(),a=C("p"),$.c(),u=N(),v&&v.c(),P(n,"class","svelte-i66bba"),P(o,"class","svelte-i66bba"),P(l,"class","svelte-i66bba"),P(a,"class","svelte-i66bba"),P(e,"class","series-card svelte-i66bba")},m(h,g){T(h,e,g),x(e,n),x(e,r),x(e,o),m.m(o,null),x(e,i),x(e,l),x(e,c),x(e,a),$.m(a,null),x(e,u),v&&v.m(e,null),d=!0,f||(p=_(e,"submit",M((function(){s(t[4])&&t[4].apply(this,arguments)}))),f=!0)},p(n,[r]){g===(g=h(t=n))&&m?m.p(t,r):(m.d(1),m=g(t),m&&(m.c(),m.m(o,null))),y===(y=b(t))&&$?$.p(t,r):($.d(1),$=y(t),$&&($.c(),$.m(a,null))),t[5].default?v?(v.p(t,r),32&r&&lt(v,1)):(v=Fr(t),v.c(),lt(v,1),v.m(e,null)):v&&(it(),ct(v,1,1,(()=>{v=null})),st())},i(t){d||(lt(v),d=!0)},o(t){ct(v),d=!1},d(t){t&&S(e),m.d(),$.d(),v&&v.d(),f=!1,p()}}}function Hr(t,e,n){let{$$slots:r={},$$scope:o}=e;const i=function(t){const e={};for(const n in t)e[n]=!0;return e}(r);let{edit:s=!1}=e,{title:l}=e,{author:c}=e,{url:a=""}=e,{onSubmit:u}=e;return t.$$set=t=>{"edit"in t&&n(2,s=t.edit),"title"in t&&n(0,l=t.title),"author"in t&&n(1,c=t.author),"url"in t&&n(3,a=t.url),"onSubmit"in t&&n(4,u=t.onSubmit),"$$scope"in t&&n(6,o=t.$$scope)},[l,c,s,a,u,i,o,r,function(){l=this.innerHTML,n(0,l)},function(){c=this.innerHTML,n(1,c)}]}const Br=class extends $t{constructor(t){super(),yt(this,t,Hr,Ir,c,{edit:2,title:0,author:1,url:3,onSubmit:4})}};function Ur(t,e,n){const r=t.slice();return r[22]=e[n],r}function zr(t,e,n){const r=t.slice();return r[25]=e[n],r[27]=n,r}function Wr(n,r){let o,i,s,l,c,a=t;return i=new _r({props:{title:r[25].title,content:r[25].content}}),{key:n,first:null,c(){o=C("div"),gt(i.$$.fragment),s=N(),this.first=o},m(t,e){T(t,o,e),mt(i,o,null),x(o,s),c=!0},p(t,e){r=t;const n={};32&e&&(n.title=r[25].title),32&e&&(n.content=r[25].content),i.$set(n)},r(){l=o.getBoundingClientRect()},f(){(function(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,o=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,function(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),o="none"===r.transform?"":r.transform;t.style.transform=`${o} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}(t,o)}})(o),a()},a(){a(),a=function(n,r,o,i){if(!r)return t;const s=n.getBoundingClientRect();if(r.left===s.left&&r.right===s.right&&r.top===s.top&&r.bottom===s.bottom)return t;const{delay:l=0,duration:c=300,easing:a=e,start:u=b()+l,end:d=u+c,tick:f=t,css:p}=o(n,{from:r,to:s},i);let h,g=!0,m=!1;function w(){p&&function(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),o=n.length-r.length;o&&(t.style.animation=r.join(", "),B-=o,B||y((()=>{B||(I.forEach((t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}})),I.clear())})))}(n,h),g=!1}return function(t){let e;0===$.size&&y(v),new Promise((n=>{$.add(e={c:t,f:n})}))}((t=>{if(!m&&t>=u&&(m=!0),m&&t>=d&&(f(1,0),w()),!g)return!1;if(m){const e=0+1*a((t-u)/c);f(e,1-e)}return!0})),p&&(h=function(t,e,n,r,o,i,s,l=0){const c=16.666/r;let a="{\n";for(let t=0;t<=1;t+=c){const r=e+(n-e)*i(t);a+=100*t+`%{${s(r,1-r)}}\n`}const u=a+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${l}`,f=k(t),{stylesheet:p,rules:h}=I.get(f)||function(t,e){const n={stylesheet:E(e),rules:{}};return I.set(t,n),n}(f,t);h[d]||(h[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${d} ${r}ms linear ${o}ms 1 both`,B+=1,d}(n,0,1,c,l,a,p)),l||(m=!0),f(0,1),w}(o,l,Or,{duration:Zr})},i(t){c||(lt(i.$$.fragment,t),c=!0)},o(t){ct(i.$$.fragment,t),c=!1},d(t){t&&S(o),bt(i)}}}function qr(t){let e,n,r,o,i,l,c=t[4].pre+"";return{c(){e=C("a"),n=O(c),o=O("\n        ."),P(e,"class","small svelte-5zdmby"),P(e,"href",r=`#page ${t[4].pre}`),P(e,"role","navigation")},m(r,c){T(r,e,c),x(e,n),T(r,o,c),i||(l=_(e,"click",M((function(){s(t[7].bind(null,t[4].pre-1))&&t[7].bind(null,t[4].pre-1).apply(this,arguments)}))),i=!0)},p(o,i){t=o,16&i&&c!==(c=t[4].pre+"")&&R(n,c),16&i&&r!==(r=`#page ${t[4].pre}`)&&P(e,"href",r)},d(t){t&&S(e),t&&S(o),i=!1,l()}}}function Yr(t){let e,n,r,o,i,l=t[22]+1+"";return{c(){e=C("a"),n=O(l),P(e,"class","small svelte-5zdmby"),P(e,"href",r=`#page ${t[22]+1}`),P(e,"role","navigation"),F(e,"current",t[22]==t[2])},m(r,l){T(r,e,l),x(e,n),o||(i=_(e,"click",M((function(){s(t[7].bind(null,t[22]))&&t[7].bind(null,t[22]).apply(this,arguments)}))),o=!0)},p(o,i){t=o,16&i&&l!==(l=t[22]+1+"")&&R(n,l),16&i&&r!==(r=`#page ${t[22]+1}`)&&P(e,"href",r),20&i&&F(e,"current",t[22]==t[2])},d(t){t&&S(e),o=!1,i()}}}function Vr(t){let e,n,r,o,i,l,c=t[4].post+"";return{c(){e=O(".\n        "),n=C("a"),r=O(c),P(n,"class","small svelte-5zdmby"),P(n,"href",o=`#page ${t[4].post}`),P(n,"role","navigation")},m(o,c){T(o,e,c),T(o,n,c),x(n,r),i||(l=_(n,"click",M((function(){s(t[7].bind(null,t[4].post-1))&&t[7].bind(null,t[4].post-1).apply(this,arguments)}))),i=!0)},p(e,i){t=e,16&i&&c!==(c=t[4].post+"")&&R(r,c),16&i&&o!==(o=`#page ${t[4].post}`)&&P(n,"href",o)},d(t){t&&S(e),t&&S(n),i=!1,l()}}}function Xr(e){let n,r,o,l,c,a,u,d,f,p,h,g,m,b,y,$,v,w=[],k=new Map,E=e[5];const A=t=>t[25].id;for(let t=0;t<E.length;t+=1){let n=zr(e,E,t),r=A(n);k.set(r,w[t]=Wr(r,n))}let L=null!==e[4].pre&&qr(e),R=e[4].pages,j=[];for(let t=0;t<R.length;t+=1)j[t]=Yr(Ur(e,R,t));let F=null!==e[4].post&&Vr(e);return{c(){n=C("div");for(let t=0;t<w.length;t+=1)w[t].c();o=N(),l=C("nav"),c=C("a"),a=O("Previous"),d=O("\n      ::\n      "),L&&L.c(),f=N();for(let t=0;t<j.length;t+=1)j[t].c();p=N(),F&&F.c(),h=O("\n      ::\n      "),g=C("a"),m=O("Next"),P(n,"class","chapters svelte-5zdmby"),P(c,"class","small svelte-5zdmby"),P(c,"href","#prevous"),P(c,"role","navigation"),P(c,"disabled",u=e[2]<=0),P(g,"class","small svelte-5zdmby"),P(g,"href","#next"),P(g,"role","navigation"),P(g,"disabled",b=e[2]>=e[3]),P(l,"class","svelte-5zdmby")},m(i,u){T(i,n,u);for(let t=0;t<w.length;t+=1)w[t].m(n,null);T(i,o,u),T(i,l,u),x(l,c),x(c,a),x(l,d),L&&L.m(l,null),x(l,f);for(let t=0;t<j.length;t+=1)j[t].m(l,null);var b;x(l,p),F&&F.m(l,null),x(l,h),x(l,g),x(g,m),y=!0,$||(v=[(b=r=Dr.call(null,n,{items:e[5],flipDurationMs:Zr}),b&&s(b.destroy)?b.destroy:t),_(n,"consider",e[8]),_(n,"finalize",e[8]),_(c,"click",M(e[10])),_(g,"click",M(e[11]))],$=!0)},p(t,e){if(32&e){E=t[5],it();for(let t=0;t<w.length;t+=1)w[t].r();w=pt(w,e,A,1,t,E,k,n,ft,Wr,null,zr);for(let t=0;t<w.length;t+=1)w[t].a();st()}if(r&&s(r.update)&&32&e&&r.update.call(null,{items:t[5],flipDurationMs:Zr}),(!y||4&e&&u!==(u=t[2]<=0))&&P(c,"disabled",u),null!==t[4].pre?L?L.p(t,e):(L=qr(t),L.c(),L.m(l,f)):L&&(L.d(1),L=null),148&e){let n;for(R=t[4].pages,n=0;n<R.length;n+=1){const r=Ur(t,R,n);j[n]?j[n].p(r,e):(j[n]=Yr(r),j[n].c(),j[n].m(l,p))}for(;n<j.length;n+=1)j[n].d(1);j.length=R.length}null!==t[4].post?F?F.p(t,e):(F=Vr(t),F.c(),F.m(l,h)):F&&(F.d(1),F=null),(!y||12&e&&b!==(b=t[2]>=t[3]))&&P(g,"disabled",b)},i(t){if(!y){for(let t=0;t<E.length;t+=1)lt(w[t]);y=!0}},o(t){for(let t=0;t<w.length;t+=1)ct(w[t]);y=!1},d(t){t&&S(n);for(let t=0;t<w.length;t+=1)w[t].d();t&&S(o),t&&S(l),L&&L.d(),D(j,t),F&&F.d(),$=!1,i(v)}}}function Gr(t){let e,n,r,o,s,l,c,a,u,d,f,p;function h(e){t[13](e)}function g(e){t[14](e)}let m={edit:!0,onSubmit:t[12],$$slots:{default:[Xr]},$$scope:{ctx:t}};return void 0!==t[1].title&&(m.title=t[1].title),void 0!==t[1].author&&(m.author=t[1].author),r=new Br({props:m}),q.push((()=>ht(r,"title",h))),q.push((()=>ht(r,"author",g))),{c(){e=O("You are editing:\n\n"),n=C("div"),gt(r.$$.fragment),l=N(),c=C("button"),c.textContent="Save",a=N(),u=C("a"),u.textContent="Cancel",P(n,"class","list svelte-5zdmby"),P(c,"type","submit"),P(u,"href","#cancel"),P(u,"class","small")},m(o,i){T(o,e,i),T(o,n,i),mt(r,n,null),T(o,l,i),T(o,c,i),T(o,a,i),T(o,u,i),d=!0,f||(p=[_(c,"click",t[15]),_(u,"click",M(t[16]))],f=!0)},p(t,[e]){const n={};3&e&&(n.onSubmit=t[12]),268435516&e&&(n.$$scope={dirty:e,ctx:t}),!o&&2&e&&(o=!0,n.title=t[1].title,K((()=>o=!1))),!s&&2&e&&(s=!0,n.author=t[1].author,K((()=>s=!1))),r.$set(n)},i(t){d||(lt(r.$$.fragment,t),d=!0)},o(t){ct(r.$$.fragment,t),d=!1},d(t){t&&S(e),t&&S(n),bt(r),t&&S(l),t&&S(c),t&&S(a),t&&S(u),f=!1,i(p)}}}const Zr=200;function Kr(t,e,n){let{bookData:r}=e,{goNext:o}=e;const i=kt(r),s=kt(r);let l,c,a=0,u={pre:null,pages:[],post:null};return t.$$set=t=>{"bookData"in t&&n(9,r=t.bookData),"goNext"in t&&n(0,o=t.goNext)},t.$$.update=()=>{2&t.$$.dirty&&n(3,l=Math.ceil(s.chapters.length/50-1)),6&t.$$.dirty&&n(5,c=s.chapters.slice(50*a,50*(a+1))),28&t.$$.dirty&&(n(4,u.pages=((t,e)=>{const n=new Array(e-t+1);for(let r=t;r<=e;r++)n[r-t]=r;return n})(Math.max(0,a-3),Math.min(l,a+3)),u),n(4,u.pre=0!==u.pages[0]?1:null,u),n(4,u.post=u.pages[u.pages.length-1]!==l?l+1:null,u))},[o,s,a,l,u,c,i,t=>{if(a==t){const t=prompt("New page:",""+(a+1)),e=+t;null!==t&&!isNaN(e)&&e>0&&e<=l+1&&n(2,a=e-1)}else n(2,a=t)},t=>{const{info:{source:e,trigger:r}}=t.detail;(t=>{s.chapters.splice(50*a,50,...t.detail.items),n(1,s)})(t)},r,()=>n(2,a--,a),()=>n(2,a++,a),()=>o(s),function(e){t.$$.not_equal(s.title,e)&&(s.title=e,n(1,s))},function(e){t.$$.not_equal(s.author,e)&&(s.author=e,n(1,s))},()=>o(s),()=>o(i)]}const Jr=class extends $t{constructor(t){super(),yt(this,t,Kr,Gr,c,{bookData:9,goNext:0})}};function Qr(t,e,n){const r=t.slice();return r[19]=e[n],r}function to(t){let e,n,r,o;return e=new Lt({props:{error:t[22],retry:t[17]}}),r=new At({props:{backToSearch:t[3]}}),{c(){gt(e.$$.fragment),n=N(),gt(r.$$.fragment)},m(t,i){mt(e,t,i),T(t,n,i),mt(r,t,i),o=!0},p(t,n){const o={};256&n&&(o.error=t[22]),256&n&&(o.retry=t[17]),e.$set(o);const i={};8&n&&(i.backToSearch=t[3]),r.$set(i)},i(t){o||(lt(e.$$.fragment,t),lt(r.$$.fragment,t),o=!0)},o(t){ct(e.$$.fragment,t),ct(r.$$.fragment,t),o=!1},d(t){bt(e,t),t&&S(n),bt(r,t)}}}function eo(t){let e,n,r,o,i,s,l,c,a,u,d,f;function p(t,e){return 256&e&&(i=null),null==i&&(i=!!t[18].chapters.find(ho)),i?ao:co}r=new Br({props:{title:t[18].title,author:t[18].author,url:t[1].url,$$slots:{default:[lo]},$$scope:{ctx:t}}});let h=p(t,-1),g=h(t);function m(){return t[16](t[18])}return a=new At({props:{backToSearch:t[3]}}),{c(){e=O("Got the following series:\n\n  "),n=C("div"),gt(r.$$.fragment),o=N(),g.c(),s=N(),l=C("button"),l.textContent="Edit book",c=N(),gt(a.$$.fragment),P(n,"class","list svelte-1hsynpq")},m(t,i){T(t,e,i),T(t,n,i),mt(r,n,null),T(t,o,i),g.m(t,i),T(t,s,i),T(t,l,i),T(t,c,i),mt(a,t,i),u=!0,d||(f=_(l,"click",m),d=!0)},p(e,n){t=e;const o={};256&n&&(o.title=t[18].title),256&n&&(o.author=t[18].author),2&n&&(o.url=t[1].url),8389025&n&&(o.$$scope={dirty:n,ctx:t}),r.$set(o),h===(h=p(t,n))&&g?g.p(t,n):(g.d(1),g=h(t),g&&(g.c(),g.m(s.parentNode,s)));const i={};8&n&&(i.backToSearch=t[3]),a.$set(i)},i(t){u||(lt(r.$$.fragment,t),lt(a.$$.fragment,t),u=!0)},o(t){ct(r.$$.fragment,t),ct(a.$$.fragment,t),u=!1},d(t){t&&S(e),t&&S(n),bt(r),t&&S(o),g.d(t),t&&S(s),t&&S(l),t&&S(c),bt(a,t),d=!1,f()}}}function no(t){let e;return{c(){e=O("hide")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function ro(t){let e;return{c(){e=O("show")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function oo(t){let e,n,r,o,i,s;return{c(){e=C("span"),n=O("Found "),r=O(t[0]),o=O(" new")},m(l,c){T(l,e,c),x(e,n),x(e,r),x(e,o),i||(s=_(e,"click",t[13]),i=!0)},p(t,e){1&e&&R(r,t[0])},d(t){t&&S(e),i=!1,s()}}}function io(t){let e,n=[],r=new Map,o=t[18].chapters;const i=t=>t[19].id;for(let e=0;e<o.length;e+=1){let s=Qr(t,o,e),l=i(s);r.set(l,n[e]=so(l,s))}return{c(){e=C("div");for(let t=0;t<n.length;t+=1)n[t].c();P(e,"class","chapter-list svelte-1hsynpq")},m(t,r){T(t,e,r);for(let t=0;t<n.length;t+=1)n[t].m(e,null)},p(t,s){256&s&&(o=t[18].chapters,n=pt(n,s,i,1,t,o,r,e,dt,so,null,Qr))},d(t){t&&S(e);for(let t=0;t<n.length;t+=1)n[t].d()}}}function so(t,e){let n,r,o,i=xt(e[19].title)+"";return{key:t,first:null,c(){n=C("a"),r=O(i),P(n,"href",o=e[19].displayUrl),P(n,"target","_blank"),P(n,"class","small"),this.first=n},m(t,e){T(t,n,e),x(n,r)},p(t,s){e=t,256&s&&i!==(i=xt(e[19].title)+"")&&R(r,i),256&s&&o!==(o=e[19].displayUrl)&&P(n,"href",o)},d(t){t&&S(n)}}}function lo(t){let e,n,r,o,s,l,c,a,u,d,f,p,h,g,m=t[18].chapters.length+"";function b(t,e){return t[7]?no:ro}let y=b(t),$=y(t);function v(){return t[12](t[18])}let w="number"==typeof t[0]&&oo(t),k=t[7]&&io(t);return{c(){e=C("p"),n=O("Found "),r=O(m),o=N(),s=C("a"),$.c(),l=N(),c=C("span"),a=N(),u=C("button"),u.textContent="Find more",d=N(),w&&w.c(),f=N(),k&&k.c(),p=L(),P(s,"href","#show"),P(s,"class","small"),P(c,"class","spacer svelte-1hsynpq"),P(e,"class","no-margin svelte-1hsynpq")},m(i,m){T(i,e,m),x(e,n),x(e,r),x(e,o),x(e,s),$.m(s,null),x(e,l),x(e,c),x(e,a),x(e,u),x(e,d),w&&w.m(e,null),T(i,f,m),k&&k.m(i,m),T(i,p,m),h||(g=[_(s,"click",M(t[11])),_(u,"click",v)],h=!0)},p(n,o){t=n,256&o&&m!==(m=t[18].chapters.length+"")&&R(r,m),y!==(y=b(t))&&($.d(1),$=y(t),$&&($.c(),$.m(s,null))),"number"==typeof t[0]?w?w.p(t,o):(w=oo(t),w.c(),w.m(e,null)):w&&(w.d(1),w=null),t[7]?k?k.p(t,o):(k=io(t),k.c(),k.m(p.parentNode,p)):k&&(k.d(1),k=null)},d(t){t&&S(e),$.d(),w&&w.d(),t&&S(f),k&&k.d(t),t&&S(p),h=!1,i(g)}}}function co(t){let e,n,r;function o(){return t[15](t[18])}return{c(){e=C("button"),e.textContent="Generate EPUB"},m(t,i){T(t,e,i),n||(r=_(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&S(e),n=!1,r()}}}function ao(t){let e,n,r;function o(){return t[14](t[18])}return{c(){e=C("button"),e.textContent="Fetch chapter contents"},m(t,i){T(t,e,i),n||(r=_(e,"click",o),n=!0)},p(e,n){t=e},d(t){t&&S(e),n=!1,r()}}}function uo(t){let e,n;return e=new Pt({props:{$$slots:{default:[fo]},$$scope:{ctx:t}}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};8388608&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function fo(t){let e;return{c(){e=O("Please wait, fetching data...")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function po(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:uo,then:eo,catch:to,value:18,error:22,blocks:[,,,]};return at(n=t[8],o),{c(){e=L(),o.block.c()},m(t,n){T(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,256&r&&n!==(n=t[8])&&at(n,o)||ut(o,t,r)},i(t){r||(lt(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)ct(o.blocks[t]);r=!1},d(t){t&&S(e),o.block.d(t),o.token=null,o=null}}}const ho=t=>!1!==t.needsFetching;function go(t,e,n){let{series:r}=e,{bookData:o}=e,{newChapters:i}=e,{goNext:s}=e,{backToSearch:l}=e,{edit:c}=e,{findMore:a}=e,{downloadAll:u}=e,d=!1;const f=()=>o?Promise.resolve(kt(o)):(async t=>{const e=await Kt(t.url),n=await e.json();if(!e.ok)throw n.message;const r=((t,e)=>{switch(t){case ie.HFY_SERIES:return(({data:{content_md:t,content_html:e}})=>{var n,r,o;const i=(new DOMParser).parseFromString(xt(e),"text/html").querySelectorAll("a[href]");return{author:null===(n=t.match(/\[\*\*(?:Author\s*[-:]\s*)?([^*\]]+)\*\*\]|A Story By \[(?:\*\*)?([^\]]+?)(?:\*\*)?\]/i).slice(1).find(Boolean))||void 0===n?void 0:n.trim(),title:null===(o=null===(r=t.match(/##?\s*\*\*(.+)\*\*/))||void 0===r?void 0:r[1])||void 0===o?void 0:o.trim(),chapters:Array.from(i).filter((t=>t.getAttribute("href").match(Qt))).map((t=>{const e=t.getAttribute("href").startsWith("http")?t.getAttribute("href"):`https://www.reddit.com${t.getAttribute("href")}`;return{id:Jt(),title:t.textContent.trim(),apiUrl:vt(e),displayUrl:e}}))}})(e);case ie.POST:return(t=>({author:t[0].data.children[0].data.author,title:t[0].data.children[0].data.title,chapters:[oe(t)]}))(e)}throw new Error(`Getting data from source type \`${ie[t]}\` not supported, this should never happen`)})(t.type,n);if(!r||!r.chapters||!r.chapters.length)throw new Error("No chapters found");return r})(r);let p=f();return t.$$set=t=>{"series"in t&&n(1,r=t.series),"bookData"in t&&n(10,o=t.bookData),"newChapters"in t&&n(0,i=t.newChapters),"goNext"in t&&n(2,s=t.goNext),"backToSearch"in t&&n(3,l=t.backToSearch),"edit"in t&&n(4,c=t.edit),"findMore"in t&&n(5,a=t.findMore),"downloadAll"in t&&n(6,u=t.downloadAll)},[i,r,s,l,c,a,u,d,p,f,o,()=>n(7,d=!d),t=>a(t),()=>n(0,i=void 0),t=>u(t),t=>s(t),t=>c(t),()=>n(8,p=f())]}const mo=class extends $t{constructor(t){super(),yt(this,t,go,po,c,{series:1,bookData:10,newChapters:0,goNext:2,backToSearch:3,edit:4,findMore:5,downloadAll:6})}};function bo(t,e,n){const r=t.slice();return r[7]=e[n],r}function yo(t){let e,n;return e=new Lt({props:{error:t[10],retry:t[5]}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};4&n&&(r.error=t[10]),4&n&&(r.retry=t[5]),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function $o(e){let n,r,o,i,s,l,c,a,u=e[6],d=[];for(let t=0;t<u.length;t+=1)d[t]=wo(bo(e,u,t));return{c(){n=C("p"),r=O("The search for '"),o=O(e[0]),i=O("' returned these results:"),s=N(),l=C("ul");for(let t=0;t<d.length;t+=1)d[t].c();c=N(),a=C("p"),a.textContent="Please select one.",P(a,"class","small")},m(t,e){T(t,n,e),x(n,r),x(n,o),x(n,i),T(t,s,e),T(t,l,e);for(let t=0;t<d.length;t+=1)d[t].m(l,null);T(t,c,e),T(t,a,e)},p(t,e){if(1&e&&R(o,t[0]),6&e){let n;for(u=t[6],n=0;n<u.length;n+=1){const r=bo(t,u,n);d[n]?d[n].p(r,e):(d[n]=wo(r),d[n].c(),d[n].m(l,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=u.length}},i:t,o:t,d(t){t&&S(n),t&&S(s),t&&S(l),D(d,t),t&&S(c),t&&S(a)}}}function vo(t){let e,n,r,o,i=t[7].author+"";return{c(){e=O("["),n=C("i"),r=O(i),o=O("]")},m(t,i){T(t,e,i),T(t,n,i),x(n,r),T(t,o,i)},p(t,e){4&e&&i!==(i=t[7].author+"")&&R(r,i)},d(t){t&&S(e),t&&S(n),t&&S(o)}}}function wo(t){let e,n,r,o,i,s,l,c,a=t[7].title+"";function u(){return t[4](t[7])}let d=t[7].author&&vo(t);return{c(){e=C("li"),n=C("a"),r=O(a),i=N(),d&&d.c(),s=N(),P(n,"href",o=wt(t[7].url))},m(t,o){T(t,e,o),x(e,n),x(n,r),x(e,i),d&&d.m(e,null),x(e,s),l||(c=_(n,"click",M(u)),l=!0)},p(i,l){t=i,4&l&&a!==(a=t[7].title+"")&&R(r,a),4&l&&o!==(o=wt(t[7].url))&&P(n,"href",o),t[7].author?d?d.p(t,l):(d=vo(t),d.c(),d.m(e,s)):d&&(d.d(1),d=null)},d(t){t&&S(e),d&&d.d(),l=!1,c()}}}function xo(t){let e,n;return e=new Pt({props:{$$slots:{default:[ko]},$$scope:{ctx:t}}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};2048&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ko(t){let e;return{c(){e=O("Please wait, fetching results...")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function Eo(t){let e,n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:xo,then:$o,catch:yo,value:6,error:10,blocks:[,,,]};return at(n=t[2],o),{c(){e=L(),o.block.c()},m(t,n){T(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e,r=!0},p(e,[r]){t=e,o.ctx=t,4&r&&n!==(n=t[2])&&at(n,o)||ut(o,t,r)},i(t){r||(lt(o.block),r=!0)},o(t){for(let t=0;t<3;t+=1)ct(o.blocks[t]);r=!1},d(t){t&&S(e),o.block.d(t),o.token=null,o=null}}}function To(t,e,n){let{search:r}=e,{goNext:o}=e;const i=()=>ne(r).then((t=>{if(!t.length)throw new Error(`No series matched input \`${r}\``);return t}));let s=i();return t.$$set=t=>{"search"in t&&n(0,r=t.search),"goNext"in t&&n(1,o=t.goNext)},[r,o,s,i,t=>o({url:t.url,type:ie.HFY_SERIES}),()=>n(2,s=i())]}const So=class extends $t{constructor(t){super(),yt(this,t,To,Eo,c,{search:0,goNext:1})}};function Do(t,e,n){const r=t.slice();return r[4]=e[n],r}function Co(t){let e,n,r={ctx:t,current:null,token:null,hasCatch:!1,pending:Lo,then:Oo,catch:Ao,value:12};return at(n=t[6](t[4],t[0]),r),{c(){e=L(),r.block.c()},m(t,n){T(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e},p(e,o){t=e,r.ctx=t,17&o&&n!==(n=t[6](t[4],t[0]))&&at(n,r)||ut(r,t,o)},d(t){t&&S(e),r.block.d(t),r.token=null,r=null}}}function Ao(e){return{c:t,m:t,p:t,d:t}}function Oo(t){let e,n=t[12],r=[];for(let e=0;e<n.length;e+=1)r[e]=No(Do(t,n,e));return{c(){e=C("div");for(let t=0;t<r.length;t+=1)r[t].c();P(e,"class","search-results svelte-1vq12x4")},m(t,n){T(t,e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null)},p(t,o){if(83&o){let i;for(n=t[12],i=0;i<n.length;i+=1){const s=Do(t,n,i);r[i]?r[i].p(s,o):(r[i]=No(s),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(t){t&&S(e),D(r,t)}}}function No(t){let e,n,r,o,i,s=t[4].title+"";function l(){return t[9](t[4])}return{c(){e=C("a"),n=O(s),P(e,"class","result svelte-1vq12x4"),P(e,"href",r=wt(t[4].url))},m(t,r){T(t,e,r),x(e,n),o||(i=_(e,"click",M(l)),o=!0)},p(o,i){t=o,17&i&&s!==(s=t[4].title+"")&&R(n,s),17&i&&r!==(r=wt(t[4].url))&&P(e,"href",r)},d(t){t&&S(e),o=!1,i()}}}function Lo(e){return{c:t,m:t,p:t,d:t}}function _o(t){let e;return{c(){e=C("p"),e.textContent="Please enter a search string",P(e,"class","small error svelte-1vq12x4")},m(t,n){T(t,e,n)},d(t){t&&S(e)}}}function Mo(e){let n,r,o,s,l,c,a,u,d,f,p,h,g,m=void 0!==e[0]&&!e[0].trim().length,b=e[2]&&Co(e),y=m&&_o();return{c(){n=C("form"),r=C("p"),o=O("Search:\n    "),s=C("input"),l=N(),c=C("input"),u=N(),b&&b.c(),d=N(),y&&y.c(),f=N(),p=C("div"),p.innerHTML='<p class="spaceabove svelte-1vq12x4">You can: <a class="small" href="https://github.com/cpiber/hfy-epub/tree/master/docs/index.md" target="_blank">Help</a></p> \n  <ul><li>Search for a series title on the <a href="https://reddit.com/r/HFY/wiki/series" target="_blank">r/HFY wiki</a></li> \n    <li>Enter a series link to the <a href="https://reddit.com/r/HFY" target="_blank">r/HFY</a> wiki</li> \n    <li>Enter a link to any reddit post</li></ul>',P(s,"class","search svelte-1vq12x4"),P(s,"placeholder","Search or URL..."),P(c,"type","submit"),c.value="Go",P(c,"class","submit svelte-1vq12x4"),c.disabled=a=void 0===e[0]||!e[0].trim().length,P(c,"name","search"),P(r,"class","svelte-1vq12x4"),P(n,"class","form svelte-1vq12x4"),P(p,"class","overlay svelte-1vq12x4"),F(p,"open",e[2])},m(t,i){var a;T(t,n,i),x(n,r),x(r,o),x(r,s),j(s,e[0]),x(r,l),x(r,c),x(n,u),b&&b.m(n,null),e[11](n),T(t,d,i),y&&y.m(t,i),T(t,f,i),T(t,p,i),h||(g=[_(s,"input",e[8]),_(s,"keyup",e[7]),_(s,"blur",e[5]),_(s,"click",e[7]),_(n,"submit",(a=e[10],function(t){return t.stopPropagation(),a.call(this,t)}))],h=!0)},p(t,[e]){1&e&&s.value!==t[0]&&j(s,t[0]),1&e&&a!==(a=void 0===t[0]||!t[0].trim().length)&&(c.disabled=a),t[2]?b?b.p(t,e):(b=Co(t),b.c(),b.m(n,null)):b&&(b.d(1),b=null),1&e&&(m=void 0!==t[0]&&!t[0].trim().length),m?y||(y=_o(),y.c(),y.m(f.parentNode,f)):y&&(y.d(1),y=null),4&e&&F(p,"open",t[2])},i:t,o:t,d(t){t&&S(n),b&&b.d(),e[11](null),t&&S(d),y&&y.d(t),t&&S(f),t&&S(p),h=!1,i(g)}}}function Po(t,e,n){let r,o,{search:i}=e,{goNext:s}=e,l=!1;const c=()=>{n(4,r=r||ne().finally(c)),n(2,l=!1),r.then((()=>n(2,l=!!r&&!!i)))};return t.$$set=t=>{"search"in t&&n(0,i=t.search),"goNext"in t&&n(1,s=t.goNext)},[i,s,l,o,r,t=>n(2,l=o.contains(t.relatedTarget)),async(t,e)=>{if(!t)return[];const r=await t,o=e.toLowerCase(),i=r.filter((t=>-1!==t.title.toLowerCase().indexOf(o)));return i.length||n(2,l=!1),i},c,function(){i=this.value,n(0,i)},t=>s(t.url),()=>s(i||""),function(t){q[t?"unshift":"push"]((()=>{o=t,n(3,o)}))}]}const Ro=class extends $t{constructor(t){super(),yt(this,t,Po,Mo,c,{search:0,goNext:1})}};var jo;!function(t){t[t.INPUT=0]="INPUT",t[t.SEARCH=1]="SEARCH",t[t.BOOK_DATA=2]="BOOK_DATA",t[t.EDIT_DATA=3]="EDIT_DATA",t[t.FIND_CHAPTERS=4]="FIND_CHAPTERS",t[t.DOWNLOAD_CHAPTERS=5]="DOWNLOAD_CHAPTERS",t[t.RESULT=6]="RESULT"}(jo||(jo={}));class Fo{}class Io extends Fo{constructor(){super(...arguments),this.stage=jo.INPUT}}class Ho extends Fo{constructor(){super(...arguments),this.stage=jo.SEARCH}}class Bo extends Fo{constructor(t,e){super(),this.bookData=t,this.newChapters=e,this.stage=jo.BOOK_DATA}}class Uo extends Fo{constructor(t){super(),this.bookData=t,this.stage=jo.EDIT_DATA}}class zo extends Fo{constructor(t){super(),this.bookData=t,this.stage=jo.FIND_CHAPTERS}}class Wo extends Fo{constructor(t){super(),this.bookData=t,this.stage=jo.DOWNLOAD_CHAPTERS}}class qo extends Fo{constructor(t){super(),this.bookData=t,this.stage=jo.RESULT}}jo.INPUT,jo.SEARCH,jo.BOOK_DATA,jo.EDIT_DATA,jo.FIND_CHAPTERS,jo.DOWNLOAD_CHAPTERS,jo.RESULT;const Yo=(t,e,...n)=>{const r=new e(...n);return r.from=t,r};function Vo(t,e){return!!t&&t.stage===e}function Xo(e){let n,r,o;return{c(){n=A("svg"),r=A("g"),o=A("path"),P(o,"d","M38,52a2,2,0,0,1-1.41-.59l-24-24a2,2,0,0,1,0-2.82l24-24a2,2,0,0,1,2.82,0,2,2,0,0,1,0,2.82L16.83,26,39.41,48.59A2,2,0,0,1,38,52Z"),P(n,"version","1.1"),P(n,"xmlns","http://www.w3.org/2000/svg"),P(n,"xmlns:xlink","http://www.w3.org/1999/xlink"),P(n,"x","0px"),P(n,"y","0px"),P(n,"viewBox","0 0 52 52"),P(n,"xml:space","preserve")},m(t,e){T(t,n,e),x(n,r),x(r,o)},p:t,i:t,o:t,d(t){t&&S(n)}}}const Go=class extends $t{constructor(t){super(),yt(this,t,null,Xo,c,{})}};function Zo(e){let n;return{c(){n=C("header"),n.innerHTML='<h1 class="svelte-16374ub">r/HFY epub generator</h1>',P(n,"class","svelte-16374ub")},m(t,e){T(t,n,e)},p:t,i:t,o:t,d(t){t&&S(n)}}}const Ko=class extends $t{constructor(t){super(),yt(this,t,null,Zo,c,{})}},Jo=[];const Qo={useTiny:!0},ti=function(e,n=t){let r;const o=new Set;function i(t){if(c(e,t)&&(e=t,r)){const t=!Jo.length;for(const t of o)t[1](),Jo.push(t,e);if(t){for(let t=0;t<Jo.length;t+=2)Jo[t][0](Jo[t+1]);Jo.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(s,l=t){const c=[s,l];return o.add(c),1===o.size&&(r=n(i)||t),s(e),()=>{o.delete(c),0===o.size&&(r(),r=null)}}}}(Qo);function ei(e){let n,r,o,i,s,l;return{c(){n=C("p"),r=O("This website ("),o=C("a"),o.textContent="https://cpiber.github.io/hfy-epub",i=O(") does not, and will not, collect any data from its users.\n      Any actions taken on this page are purely in the user's browser; there is no server-side component.\n      No data is ever sent away.\n      For collecting the chapter data, this site contacts "),s=C("code"),s.textContent="www.reddit.com",l=O(" only. The book is generated in the browser."),P(o,"href","https://cpiber.github.io/hfy-epub"),P(o,"target","_blank"),P(n,"class","small svelte-1f8pws6")},m(t,e){T(t,n,e),x(n,r),x(n,o),x(n,i),x(n,s),x(n,l)},p:t,d(t){t&&S(n)}}}function ni(e){let n,r,o,s,l,c,a,u,d,f,p,h,g,m,b,y,$,v,w=e[0]&&ei();return{c(){n=C("footer"),r=C("p"),o=O("Made by "),s=C("a"),s.textContent="@cpiber",l=O(".\n    Source Code: "),c=C("a"),c.textContent="cpiber/hfy-epub",a=O(".\n    \n    Version "),u=O("0.2.2"),d=O(".\n    "),f=C("a"),f.textContent="Privacy",p=O("."),h=N(),w&&w.c(),g=N(),m=C("label"),b=C("input"),y=O(" Use TinyMCE chapter editor"),P(s,"href","https://github.com/cpiber"),P(s,"target","_blank"),P(c,"href","https://github.com/cpiber/hfy-epub"),P(c,"target","_blank"),P(f,"href","#privacy"),P(r,"class","small svelte-1f8pws6"),P(b,"type","checkbox"),P(b,"aria-label","use TinyMCE editor"),P(b,"class","svelte-1f8pws6"),P(m,"class","small svelte-1f8pws6"),P(n,"class","svelte-1f8pws6")},m(t,i){T(t,n,i),x(n,r),x(r,o),x(r,s),x(r,l),x(r,c),x(r,a),x(r,u),x(r,d),x(r,f),x(r,p),x(n,h),w&&w.m(n,null),x(n,g),x(n,m),x(m,b),b.checked=e[1].useTiny,x(m,y),$||(v=[_(f,"click",M(e[2])),_(b,"change",e[3])],$=!0)},p(t,[e]){t[0]?w?w.p(t,e):(w=ei(),w.c(),w.m(n,g)):w&&(w.d(1),w=null),2&e&&(b.checked=t[1].useTiny)},i:t,o:t,d(t){t&&S(n),w&&w.d(),$=!1,i(v)}}}function ri(t,e,n){let r;u(t,ti,(t=>n(1,r=t)));let o=!1;return[o,r,()=>n(0,o=!o),function(){r.useTiny=this.checked,ti.set(r)}]}const oi=class extends $t{constructor(t){super(),yt(this,t,ri,ni,c,{})}};function ii(e){let n,r,o,i,s,l,c;return o=new Go({}),{c(){n=C("nav"),r=C("a"),gt(o.$$.fragment),i=O(" home"),P(r,"href","#home"),P(r,"class","homelink svelte-sy8itf"),P(n,"class","mainnav svelte-sy8itf")},m(t,a){T(t,n,a),x(n,r),mt(o,r,null),x(r,i),s=!0,l||(c=_(r,"click",M(e[7])),l=!0)},p:t,i(t){s||(lt(o.$$.fragment,t),s=!0)},o(t){ct(o.$$.fragment,t),s=!1},d(t){t&&S(n),bt(o),l=!1,c()}}}function si(t){let e,n;return e=new Gt({props:{data:t[0].bookData,backToSearch:t[3],backToBook:t[15]}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.data=t[0].bookData),8&n&&(r.backToSearch=t[3]),1&n&&(r.backToBook=t[15]),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function li(t){let e,n;return e=new me({props:{goNext:t[14],data:t[0].bookData}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.goNext=t[14]),1&n&&(r.data=t[0].bookData),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ci(t){let e,n;return e=new Te({props:{goNext:t[13],bookData:t[0].bookData}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.goNext=t[13]),1&n&&(r.bookData=t[0].bookData),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ai(t){let e,n;return e=new Jr({props:{goNext:t[12],bookData:t[0].bookData}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.goNext=t[12]),1&n&&(r.bookData=t[0].bookData),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function ui(t){let e,r;const o=[{goNext:t[8]},{series:t[2]},t[0],{backToSearch:t[3]},{edit:t[9]},{findMore:t[10]},{downloadAll:t[11]}];let i={};for(let t=0;t<o.length;t+=1)i=n(i,o[t]);return e=new mo({props:i}),{c(){gt(e.$$.fragment)},m(t,n){mt(e,t,n),r=!0},p(t,n){const r=13&n?function(t,e){const n={},r={},o={$$scope:1};let i=t.length;for(;i--;){const s=t[i],l=e[i];if(l){for(const t in s)t in l||(r[t]=1);for(const t in l)o[t]||(n[t]=l[t],o[t]=1);t[i]=l}else for(const t in s)o[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}(o,[1&n&&{goNext:t[8]},4&n&&{series:t[2]},1&n&&(i=t[0],"object"==typeof i&&null!==i?i:{}),8&n&&{backToSearch:t[3]},1&n&&{edit:t[9]},1&n&&{findMore:t[10]},1&n&&{downloadAll:t[11]}]):{};var i;e.$set(r)},i(t){r||(lt(e.$$.fragment,t),r=!0)},o(t){ct(e.$$.fragment,t),r=!1},d(t){bt(e,t)}}}function di(t){let e,n;return e=new So({props:{goNext:t[5],search:t[1]}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};2&n&&(r.search=t[1]),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function fi(t){let e,n;return e=new Ro({props:{goNext:t[4],search:t[1]}}),{c(){gt(e.$$.fragment)},m(t,r){mt(e,t,r),n=!0},p(t,n){const r={};2&n&&(r.search=t[1]),e.$set(r)},i(t){n||(lt(e.$$.fragment,t),n=!0)},o(t){ct(e.$$.fragment,t),n=!1},d(t){bt(e,t)}}}function pi(t){let e,n,r,o,i,s,l,c,a,u,d,f,p,h,g,m,b,y=!Vo(t[0],jo.INPUT),$=y&&ii(t);r=new Ko({});const v=[fi,di,ui,ai,ci,li,si],w=[];function k(t,e){return 1&e&&(s=null),1&e&&(l=null),1&e&&(c=null),1&e&&(a=null),1&e&&(u=null),1&e&&(d=null),1&e&&(f=null),null==s&&(s=!!Vo(t[0],jo.INPUT)),s?0:(null==l&&(l=!!Vo(t[0],jo.SEARCH)),l?1:(null==c&&(c=!!Vo(t[0],jo.BOOK_DATA)),c?2:(null==a&&(a=!!Vo(t[0],jo.EDIT_DATA)),a?3:(null==u&&(u=!!Vo(t[0],jo.FIND_CHAPTERS)),u?4:(null==d&&(d=!!Vo(t[0],jo.DOWNLOAD_CHAPTERS)),d?5:(null==f&&(f=!!Vo(t[0],jo.RESULT)),f?6:-1))))))}return~(p=k(t,-1))&&(h=w[p]=v[p](t)),m=new oi({}),{c(){e=C("div"),$&&$.c(),n=N(),gt(r.$$.fragment),o=N(),i=C("main"),h&&h.c(),g=N(),gt(m.$$.fragment),P(i,"class","App-main"),P(e,"class","App svelte-sy8itf")},m(t,s){T(t,e,s),$&&$.m(e,null),x(e,n),mt(r,e,null),x(e,o),x(e,i),~p&&w[p].m(i,null),x(e,g),mt(m,e,null),b=!0},p(t,[r]){1&r&&(y=!Vo(t[0],jo.INPUT)),y?$?($.p(t,r),1&r&&lt($,1)):($=ii(t),$.c(),lt($,1),$.m(e,n)):$&&(it(),ct($,1,1,(()=>{$=null})),st());let o=p;p=k(t,r),p===o?~p&&w[p].p(t,r):(h&&(it(),ct(w[o],1,1,(()=>{w[o]=null})),st()),~p?(h=w[p],h?h.p(t,r):(h=w[p]=v[p](t),h.c()),lt(h,1),h.m(i,null)):h=null)},i(t){b||(lt($),lt(r.$$.fragment,t),lt(h),lt(m.$$.fragment,t),b=!0)},o(t){ct($),ct(r.$$.fragment,t),ct(h),ct(m.$$.fragment,t),b=!1},d(t){t&&S(e),$&&$.d(),bt(r),~p&&w[p].d(),bt(m)}}}function hi(t,e,n){let r;u(t,ti,(t=>n(6,r=t)));let o,i,s,l=new Io;return t.$$.update=()=>{1&t.$$.dirty&&n(3,s=Vo(l.from,jo.SEARCH)?()=>n(0,l=Yo(l,Ho)):void 0),t.$$.dirty,t.$$.dirty,64&t.$$.dirty&&localStorage.setItem("config",JSON.stringify(r))},[l,o,i,s,t=>{const e=(t=>{try{if(new URL(t),(t=>!!t.match(ee))(t))return ie.HFY_SERIES;if((t=>!!t.match(re))(t))return ie.POST}catch(t){}return ie.SEARCH})(t);return n(1,o=t),e!==ie.SEARCH&&n(2,i={url:vt(t),type:e}),e===ie.SEARCH?n(0,l=Yo(l,Ho)):n(0,l=Yo(l,Bo))},t=>{n(2,i=t),n(0,l=Yo(l,Bo))},r,()=>n(0,l=Yo(l,Io)),t=>Yo(l,qo,t),t=>n(0,l=Yo(l,Uo,t)),t=>n(0,l=Yo(l,zo,t)),t=>n(0,l=Yo(l,Wo,t)),t=>n(0,l=Yo(l,Bo,t)),(t,e)=>n(0,l=Yo(l,Bo,t,e)),t=>n(0,l=Yo(l,Bo,t)),()=>n(0,l=Yo(l,Bo))]}(()=>{try{const t=JSON.parse(localStorage.getItem("config"));ti.set((t=>{if(!t||""+t!="[object Object]")return Qo;const e=Object.keys(t),n=Object.keys(Qo);for(const r of n)e.includes(r)||(t[r]=Qo[r]),typeof Qo[r]!=typeof t[r]&&(t[r]=Qo[r]);return t})(t))}catch(t){}})();const gi=class extends $t{constructor(t){super(),yt(this,t,hi,pi,c,{})}};let mi;try{mi=new gi({target:document.body})}catch(t){const e=document.createElement("div");e.className="fatal-error",e.ariaLabel="error",e.appendChild(document.createElement("h1")).textContent="Something went wrong:",e.appendChild(document.createElement("code")).textContent=t,document.body.appendChild(e)}})(),c=l.O(c)})();